{"version":3,"sources":["node_modules/browser-pack/_prelude.js","libzoterojs.js","node_modules/browserify/lib/_empty.js","node_modules/d/index.js","node_modules/deferred/_ext.js","node_modules/deferred/assimilate.js","node_modules/deferred/deferred.js","node_modules/deferred/dynamic-queue.js","node_modules/deferred/ext/_process-arguments.js","node_modules/deferred/ext/array/every.js","node_modules/deferred/ext/array/find.js","node_modules/deferred/ext/array/map.js","node_modules/deferred/ext/array/reduce.js","node_modules/deferred/ext/array/some.js","node_modules/deferred/ext/function/call-async.js","node_modules/deferred/ext/function/delay.js","node_modules/deferred/ext/function/gate.js","node_modules/deferred/ext/function/promisify-sync.js","node_modules/deferred/ext/function/promisify.js","node_modules/deferred/ext/promise/_array.js","node_modules/deferred/ext/promise/aside.js","node_modules/deferred/ext/promise/catch.js","node_modules/deferred/ext/promise/cb.js","node_modules/deferred/ext/promise/finally.js","node_modules/deferred/ext/promise/get.js","node_modules/deferred/ext/promise/invoke-async.js","node_modules/deferred/ext/promise/invoke.js","node_modules/deferred/ext/promise/map.js","node_modules/deferred/ext/promise/reduce.js","node_modules/deferred/ext/promise/some.js","node_modules/deferred/ext/promise/spread.js","node_modules/deferred/index.js","node_modules/deferred/invoke-async.js","node_modules/deferred/is-promise.js","node_modules/deferred/lib/some-every.js","node_modules/deferred/monitor.js","node_modules/deferred/profiler.js","node_modules/deferred/valid-promise.js","node_modules/es5-ext/array/from/index.js","node_modules/es5-ext/array/from/is-implemented.js","node_modules/es5-ext/array/from/shim.js","node_modules/es5-ext/array/of/index.js","node_modules/es5-ext/array/of/is-implemented.js","node_modules/es5-ext/array/of/shim.js","node_modules/es5-ext/array/to-array.js","node_modules/es5-ext/error/is-error.js","node_modules/es5-ext/function/#/partial.js","node_modules/es5-ext/function/#/spread.js","node_modules/es5-ext/function/_define-length.js","node_modules/es5-ext/function/is-arguments.js","node_modules/es5-ext/function/is-function.js","node_modules/es5-ext/function/noop.js","node_modules/es5-ext/iterable/is.js","node_modules/es5-ext/iterable/validate-object.js","node_modules/es5-ext/math/sign/index.js","node_modules/es5-ext/math/sign/is-implemented.js","node_modules/es5-ext/math/sign/shim.js","node_modules/es5-ext/number/to-integer.js","node_modules/es5-ext/number/to-pos-integer.js","node_modules/es5-ext/object/_iterate.js","node_modules/es5-ext/object/assign/index.js","node_modules/es5-ext/object/assign/is-implemented.js","node_modules/es5-ext/object/assign/shim.js","node_modules/es5-ext/object/for-each.js","node_modules/es5-ext/object/is-array-like.js","node_modules/es5-ext/object/is-callable.js","node_modules/es5-ext/object/is-object.js","node_modules/es5-ext/object/keys/index.js","node_modules/es5-ext/object/keys/is-implemented.js","node_modules/es5-ext/object/keys/shim.js","node_modules/es5-ext/object/mixin.js","node_modules/es5-ext/object/normalize-options.js","node_modules/es5-ext/object/valid-callable.js","node_modules/es5-ext/object/valid-object.js","node_modules/es5-ext/object/valid-value.js","node_modules/es5-ext/string/#/contains/index.js","node_modules/es5-ext/string/#/contains/is-implemented.js","node_modules/es5-ext/string/#/contains/shim.js","node_modules/es5-ext/string/#/pad.js","node_modules/es5-ext/string/#/repeat/index.js","node_modules/es5-ext/string/#/repeat/is-implemented.js","node_modules/es5-ext/string/#/repeat/shim.js","node_modules/es5-ext/string/is-string.js","node_modules/es6-promise/dist/es6-promise.js","node_modules/es6-symbol/index.js","node_modules/es6-symbol/is-implemented.js","node_modules/es6-symbol/is-symbol.js","node_modules/es6-symbol/polyfill.js","node_modules/es6-symbol/validate-symbol.js","node_modules/event-emitter/index.js","node_modules/event-emitter/unify.js","node_modules/next-tick/index.js","node_modules/process/browser.js","node_modules/spark-md5/spark-md5.js","node_modules/striptags/striptags.js","node_modules/timers-ext/max-timeout.js","node_modules/timers-ext/valid-timeout.js","src/Ajax.js","src/ApiObject.js","src/ApiResponse.js","src/Base.js","src/Cache.js","src/Collection.js","src/Collections.js","src/Container.js","src/Deleted.js","src/File.js","src/Group.js","src/Groups.js","src/Idb.js","src/Item.js","src/ItemMaps.js","src/Items.js","src/Library.js","src/Localizations.js","src/Net.js","src/Preferences.js","src/Search.js","src/Searches.js","src/Tag.js","src/Tags.js","src/Url.js","src/User.js","src/Utils.js"],"names":[],"mappings":"AAAA;;;;;ACCA,IAAG,OAAO,MAAP,KAAkB,WAAlB,EAA+B;AACjC,KAAI,cAAc,MAAd,CAD6B;AAEjC,KAAG,CAAC,YAAY,cAAZ,EAA4B;AAC/B,cAAY,cAAZ,GAA6B,QAAQ,oBAAR,EAA8B,cAA9B,CADE;EAAhC;CAFD,MAKO;AACN,KAAI,cAAc,MAAd,CADE;AAEN,KAAG,OAAO,OAAP,KAAmB,WAAnB,EAAgC;AAClC,UAAQ,aAAR,EAAuB,QAAvB,GADkC;EAAnC;CAPD;;AAYA,IAAI,SAAS,QAAQ,eAAR,CAAT;AACJ,YAAY,MAAZ,GAAqB,YAAY,CAAZ,GAAgB,MAAhB;AACrB,OAAO,KAAP,GAAe,QAAQ,gBAAR,CAAf;AACA,OAAO,IAAP,GAAc,OAAO,IAAP,GAAc,QAAQ,eAAR,CAAd;AACd,OAAO,SAAP,GAAmB,QAAQ,oBAAR,CAAnB;AACA,OAAO,WAAP,GAAqB,QAAQ,sBAAR,CAArB;AACA,OAAO,GAAP,GAAa,OAAO,GAAP,GAAa,QAAQ,cAAR,CAAb;AACb,OAAO,OAAP,GAAiB,QAAQ,kBAAR,CAAjB;AACA,OAAO,SAAP,GAAmB,QAAQ,iBAAR,CAAnB;AACA,OAAO,WAAP,GAAqB,QAAQ,sBAAR,CAArB;AACA,OAAO,KAAP,GAAe,QAAQ,gBAAR,CAAf;AACA,OAAO,IAAP,GAAc,QAAQ,eAAR,CAAd;AACA,OAAO,MAAP,GAAgB,QAAQ,iBAAR,CAAhB;AACA,OAAO,QAAP,GAAkB,QAAQ,mBAAR,CAAlB;AACA,OAAO,OAAP,GAAiB,QAAQ,kBAAR,CAAjB;AACA,OAAO,UAAP,GAAoB,QAAQ,qBAAR,CAApB;AACA,OAAO,aAAP,GAAuB,OAAO,aAAP,GAAuB,QAAQ,wBAAR,CAAvB;AACvB,OAAO,IAAP,GAAc,QAAQ,eAAR,CAAd;AACA,OAAO,GAAP,GAAa,QAAQ,cAAR,CAAb;AACA,OAAO,MAAP,GAAgB,QAAQ,iBAAR,CAAhB;AACA,OAAO,KAAP,GAAe,QAAQ,gBAAR,CAAf;AACA,OAAO,IAAP,GAAc,QAAQ,eAAR,CAAd;AACA,OAAO,KAAP,GAAe,OAAO,KAAP,GAAe,QAAQ,gBAAR,CAAf;AACf,OAAO,GAAP,GAAa,OAAO,GAAP,GAAa,QAAQ,cAAR,CAAb;AACb,OAAO,IAAP,GAAc,OAAO,IAAP,GAAc,QAAQ,eAAR,CAAd;AACd,OAAO,GAAP,GAAa,QAAQ,cAAR,CAAb;AACA,OAAO,WAAP,GAAqB,QAAQ,sBAAR,CAArB;;AAEA,OAAO,OAAP,GAAiB,MAAjB;;;;;ACzCA;;ACAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC/DA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AChHA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AChDA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACxLA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACrDA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC9BA;AACA;AACA;AACA;AACA;AACA;;ACLA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AClGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACvFA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AChJA;AACA;AACA;AACA;AACA;AACA;;ACLA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACxDA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACxCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACpFA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACjDA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AChBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACxCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACtCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC3DA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACnDA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACrBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC7CA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACtHA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC/FA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACTA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACTA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACTA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACrEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACtCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AChBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACPA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACtHA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACxCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC1FA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACVA;AACA;AACA;AACA;AACA;AACA;;ACLA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACTA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC1GA;AACA;AACA;AACA;AACA;AACA;;ACLA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACRA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACnBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACTA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACTA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AChBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACVA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC5CA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACPA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACTA;AACA;AACA;AACA;;ACHA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACVA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACTA;AACA;AACA;AACA;AACA;AACA;;ACLA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACPA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACPA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACZA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACPA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC7BA;AACA;AACA;AACA;AACA;AACA;;ACLA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACTA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACtBA;AACA;AACA;AACA;;ACHA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACdA;AACA;AACA;AACA;AACA;AACA;;ACLA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACPA;AACA;AACA;AACA;AACA;AACA;;ACLA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACRA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACPA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACnBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACjBA;AACA;AACA;AACA;AACA;AACA;AACA;;ACNA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACRA;AACA;AACA;AACA;AACA;AACA;AACA;;ACNA;AACA;AACA;AACA;AACA;AACA;;ACLA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACRA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACPA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AClBA;AACA;AACA;AACA;AACA;AACA;;ACLA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACRA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACtBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;ACVA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;AC17BA;AACA;AACA;AACA;;ACHA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AClBA;AACA;AACA;AACA;AACA;AACA;;ACLA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC3GA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACRA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACpIA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AClDA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;AChEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC3FA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC/rBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA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","file":"libzoterojs.js","sourceRoot":"/source/","sourcesContent":["(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require==\"function\"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error(\"Cannot find module '\"+o+\"'\");throw f.code=\"MODULE_NOT_FOUND\",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require==\"function\"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})","// use strict;\nif(typeof window === 'undefined') {\n\tvar globalScope = global;\n\tif(!globalScope.XMLHttpRequest) {\n\t\tglobalScope.XMLHttpRequest = require('w3c-xmlhttprequest').XMLHttpRequest;\n\t}\n} else {\n\tvar globalScope = window;\n\tif(typeof Promise === 'undefined') {\n\t\trequire('es6-promise').polyfill();\n\t}\n}\n\nvar Zotero = require('./src/Base.js');\nglobalScope.Zotero = globalScope.Z = Zotero;\nZotero.Cache = require('./src/Cache.js');\nZotero.Ajax = Zotero.ajax = require('./src/Ajax.js');\nZotero.ApiObject = require('./src/ApiObject.js');\nZotero.ApiResponse = require('./src/ApiResponse.js');\nZotero.Net = Zotero.net = require('./src/Net.js');\nZotero.Library = require('./src/Library.js');\nZotero.Container = require('./src/Container');\nZotero.Collections = require('./src/Collections.js');\nZotero.Items = require('./src/Items.js');\nZotero.Tags = require('./src/Tags.js');\nZotero.Groups = require('./src/Groups.js');\nZotero.Searches = require('./src/Searches.js');\nZotero.Deleted = require('./src/Deleted.js');\nZotero.Collection = require('./src/Collection.js');\nZotero.Localizations = Zotero.localizations = require('./src/Localizations.js');\nZotero.Item = require('./src/Item.js');\nZotero.Tag = require('./src/Tag.js');\nZotero.Search = require('./src/Search.js');\nZotero.Group = require('./src/Group.js');\nZotero.User = require('./src/User.js');\nZotero.Utils = Zotero.utils = require('./src/Utils.js');\nZotero.Url = Zotero.url = require('./src/Url.js');\nZotero.File = Zotero.file = require('./src/File.js');\nZotero.Idb = require('./src/Idb.js');\nZotero.Preferences = require('./src/Preferences.js');\n\nmodule.exports = Zotero;","","'use strict';\n\nvar assign        = require('es5-ext/object/assign')\n  , normalizeOpts = require('es5-ext/object/normalize-options')\n  , isCallable    = require('es5-ext/object/is-callable')\n  , contains      = require('es5-ext/string/#/contains')\n\n  , d;\n\nd = module.exports = function (dscr, value/*, options*/) {\n\tvar c, e, w, options, desc;\n\tif ((arguments.length < 2) || (typeof dscr !== 'string')) {\n\t\toptions = value;\n\t\tvalue = dscr;\n\t\tdscr = null;\n\t} else {\n\t\toptions = arguments[2];\n\t}\n\tif (dscr == null) {\n\t\tc = w = true;\n\t\te = false;\n\t} else {\n\t\tc = contains.call(dscr, 'c');\n\t\te = contains.call(dscr, 'e');\n\t\tw = contains.call(dscr, 'w');\n\t}\n\n\tdesc = { value: value, configurable: c, enumerable: e, writable: w };\n\treturn !options ? desc : assign(normalizeOpts(options), desc);\n};\n\nd.gs = function (dscr, get, set/*, options*/) {\n\tvar c, e, options, desc;\n\tif (typeof dscr !== 'string') {\n\t\toptions = set;\n\t\tset = get;\n\t\tget = dscr;\n\t\tdscr = null;\n\t} else {\n\t\toptions = arguments[3];\n\t}\n\tif (get == null) {\n\t\tget = undefined;\n\t} else if (!isCallable(get)) {\n\t\toptions = get;\n\t\tget = set = undefined;\n\t} else if (set == null) {\n\t\tset = undefined;\n\t} else if (!isCallable(set)) {\n\t\toptions = set;\n\t\tset = undefined;\n\t}\n\tif (dscr == null) {\n\t\tc = true;\n\t\te = false;\n\t} else {\n\t\tc = contains.call(dscr, 'c');\n\t\te = contains.call(dscr, 'e');\n\t}\n\n\tdesc = { get: get, set: set, configurable: c, enumerable: e };\n\treturn !options ? desc : assign(normalizeOpts(options), desc);\n};\n","'use strict';\n\nvar callable   = require('es5-ext/object/valid-callable')\n  , d          = require('d')\n  , isCallable = require('es5-ext/object/is-callable')\n  , ee         = require('event-emitter')\n  , isPromise  = require('./is-promise')\n\n  , create = Object.create, defineProperty = Object.defineProperty\n  , deferred, resolve, reject;\n\nmodule.exports = exports = function (name, unres, onres, res) {\n\tname = String(name);\n\t(callable(res) && ((onres == null) || callable(onres)) && callable(unres));\n\tdefineProperty(exports._unresolved, name, d(unres));\n\texports._onresolve[name] = onres;\n\tdefineProperty(exports._resolved, name, d(res));\n\texports._names.push(name);\n};\n\nexports._names = ['done', 'then', 'valueOf'];\n\nexports._unresolved = ee(create(Function.prototype, {\n\tthen: d(function (win, fail) {\n\t\tvar def;\n\t\tif (!this.pending) this.pending = [];\n\t\tdef = deferred();\n\t\tthis.pending.push('then', [win, fail, def.resolve, def.reject]);\n\t\treturn def.promise;\n\t}),\n\tdone: d(function (win, fail) {\n\t\t((win == null) || callable(win));\n\t\t((fail == null) || callable(fail));\n\t\tif (!this.pending) this.pending = [];\n\t\tthis.pending.push('done', arguments);\n\t}),\n\tresolved: d(false),\n\treturnsPromise: d(true),\n\tvalueOf: d(function () { return this; })\n}));\n\nexports._onresolve = {\n\tthen: function (win, fail, resolve, reject) {\n\t\tvar value, cb = this.failed ? fail : win;\n\t\tif (cb == null) {\n\t\t\tif (this.failed) reject(this.value);\n\t\t\telse resolve(this.value);\n\t\t\treturn;\n\t\t}\n\t\tif (isCallable(cb)) {\n\t\t\tif (isPromise(cb)) {\n\t\t\t\tif (cb.resolved) {\n\t\t\t\t\tif (cb.failed) reject(cb.value);\n\t\t\t\t\telse resolve(cb.value);\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tcb.done(resolve, reject);\n\t\t\t\treturn;\n\t\t\t}\n\t\t\ttry { value = cb(this.value); } catch (e) {\n\t\t\t\treject(e);\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tresolve(value);\n\t\t\treturn;\n\t\t}\n\t\tresolve(cb);\n\t},\n\tdone: function (win, fail) {\n\t\tif (this.failed) {\n\t\t\tif (fail) {\n\t\t\t\tfail(this.value);\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tthrow this.value;\n\t\t}\n\t\tif (win) win(this.value);\n\t}\n};\n\nexports._resolved = ee(create(Function.prototype, {\n\tthen: d(function (win, fail) {\n\t\tvar value, cb = this.failed ? fail : win;\n\t\tif (cb == null) return this;\n\t\tif (isCallable(cb)) {\n\t\t\tif (isPromise(cb)) return cb;\n\t\t\ttry { value = cb(this.value); } catch (e) { return reject(e); }\n\t\t\treturn resolve(value);\n\t\t}\n\t\treturn resolve(cb);\n\t}),\n\tdone: d(function (win, fail) {\n\t\t((win == null) || callable(win));\n\t\t((fail == null) || callable(fail));\n\t\tif (this.failed) {\n\t\t\tif (fail) {\n\t\t\t\tfail(this.value);\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tthrow this.value;\n\t\t}\n\t\tif (win) win(this.value);\n\t}),\n\tresolved: d(true),\n\treturnsPromise: d(true),\n\tvalueOf: d(function () { return this.value; })\n}));\n\ndeferred = require('./deferred');\nresolve = deferred.resolve;\nreject = deferred.reject;\ndeferred.extend = exports;\n","// Assimilate eventual foreign promise\n\n'use strict';\n\nvar isObject  = require('es5-ext/object/is-object')\n  , isPromise = require('./is-promise')\n  , deferred  = require('./deferred')\n  , nextTick  = require('next-tick')\n\n  , getPrototypeOf = Object.getPrototypeOf;\n\nmodule.exports = function self(value) {\n\tvar then, done, def, resolve, reject;\n\tif (!value) return value;\n\ttry {\n\t\tthen = value.then;\n\t} catch (e) {\n\t\treturn value;\n\t}\n\tif (typeof then !== 'function') return value;\n\tif (isPromise(value)) return value;\n\tif (!isObject(value)) return value;\n\tif (!getPrototypeOf(value)) return value;\n\ttry {\n\t\tdone = value.done;\n\t} catch (ignore) {}\n\tdef = deferred();\n\tresolve = function (value) { def.resolve(self(value)); };\n\treject = function (value) { def.reject(value); };\n\tif (typeof done === 'function') {\n\t\ttry {\n\t\t\tdone.call(value, resolve, reject);\n\t\t} catch (e) {\n\t\t\treturn def.reject(e);\n\t\t}\n\t\treturn def.promise;\n\t}\n\ttry {\n\t\tthen.call(value, function (value) { nextTick(function () {\n\t\t\tresolve(value);\n\t\t}); }, function (value) { nextTick(function () {\n\t\t\treject(value);\n\t\t}); });\n\t} catch (e) {\n\t\treturn def.reject(e);\n\t}\n\treturn def.promise;\n};\n","// Returns function that returns deferred or promise object.\n//\n// 1. If invoked without arguments then deferred object is returned\n//    Deferred object consist of promise (unresolved) function and resolve\n//    function through which we resolve promise\n// 2. If invoked with one argument then promise is returned which resolved value\n//    is given argument. Argument may be any value (even undefined),\n//    if it's promise then same promise is returned\n// 3. If invoked with more than one arguments then promise that resolves with\n//    array of all resolved arguments is returned.\n\n'use strict';\n\nvar isError    = require('es5-ext/error/is-error')\n  , noop       = require('es5-ext/function/noop')\n  , isPromise  = require('./is-promise')\n\n  , every = Array.prototype.every, push = Array.prototype.push\n\n  , Deferred, createDeferred, count = 0, timeout, extendShim, ext\n  , protoSupported = Boolean(isPromise.__proto__)\n  , resolve, assimilate;\n\nextendShim = function (promise) {\n\text._names.forEach(function (name) {\n\t\tpromise[name] = function () {\n\t\t\treturn promise.__proto__[name].apply(promise, arguments);\n\t\t};\n\t});\n\tpromise.returnsPromise = true;\n\tpromise.resolved = promise.__proto__.resolved;\n};\n\nresolve = function (value, failed) {\n\tvar promise = function (win, fail) { return promise.then(win, fail); };\n\tpromise.value = value;\n\tpromise.failed = failed;\n\tpromise.__proto__ = ext._resolved;\n\tif (!protoSupported) { extendShim(promise); }\n\tif (createDeferred._profile) createDeferred._profile(true);\n\treturn promise;\n};\n\nDeferred = function () {\n\tvar promise = function (win, fail) { return promise.then(win, fail); };\n\tif (!count) timeout = setTimeout(noop, 1e9);\n\t++count;\n\tif (createDeferred._monitor) promise.monitor = createDeferred._monitor();\n\tpromise.__proto__ = ext._unresolved;\n\tif (!protoSupported) extendShim(promise);\n\t(createDeferred._profile && createDeferred._profile());\n\tthis.promise = promise;\n\tthis.resolve = this.resolve.bind(this);\n\tthis.reject = this.reject.bind(this);\n};\n\nDeferred.prototype = {\n\tresolved: false,\n\t_settle: function (value) {\n\t\tvar i, name, data, deps, dPromise, nuDeps;\n\t\tthis.promise.value = value;\n\t\tthis.promise.__proto__ = ext._resolved;\n\t\tif (!protoSupported) this.promise.resolved = true;\n\t\tdeps = this.promise.dependencies;\n\t\tdelete this.promise.dependencies;\n\t\twhile (deps) {\n\t\t\tfor (i = 0; (dPromise = deps[i]); ++i) {\n\t\t\t\tdPromise.value = value;\n\t\t\t\tdPromise.failed = this.failed;\n\t\t\t\tdPromise.__proto__ = ext._resolved;\n\t\t\t\tif (!protoSupported) dPromise.resolved = true;\n\t\t\t\tdelete dPromise.pending;\n\t\t\t\tif (dPromise.dependencies) {\n\t\t\t\t\tif (!nuDeps) nuDeps = dPromise.dependencies;\n\t\t\t\t\telse push.apply(nuDeps, dPromise.dependencies);\n\t\t\t\t\tdelete dPromise.dependencies;\n\t\t\t\t}\n\t\t\t}\n\t\t\tdeps = nuDeps;\n\t\t\tnuDeps = null;\n\t\t}\n\t\tif ((data = this.promise.pending)) {\n\t\t\tfor (i = 0; (name = data[i]); ++i) {\n\t\t\t\text._onresolve[name].apply(this.promise, data[++i]);\n\t\t\t}\n\t\t\tdelete this.promise.pending;\n\t\t}\n\t\treturn this.promise;\n\t},\n\tresolve: function (value) {\n\t\tif (this.resolved) return this.promise;\n\t\tthis.resolved = true;\n\t\tif (!--count) clearTimeout(timeout);\n\t\tif (this.promise.monitor) clearTimeout(this.promise.monitor);\n\t\tvalue = assimilate(value);\n\t\tif (isPromise(value)) {\n\t\t\tif (!value.resolved) {\n\t\t\t\tif (!value.dependencies) {\n\t\t\t\t\tvalue.dependencies = [];\n\t\t\t\t}\n\t\t\t\tvalue.dependencies.push(this.promise);\n\t\t\t\tif (this.promise.pending) {\n\t\t\t\t\tif (value.pending) {\n\t\t\t\t\t\tpush.apply(value.pending, this.promise.pending);\n\t\t\t\t\t\tthis.promise.pending = value.pending;\n\t\t\t\t\t\tif (this.promise.dependencies) {\n\t\t\t\t\t\t\tthis.promise.dependencies.forEach(function self(dPromise) {\n\t\t\t\t\t\t\t\tdPromise.pending = value.pending;\n\t\t\t\t\t\t\t\tif (dPromise.dependencies) {\n\t\t\t\t\t\t\t\t\tdPromise.dependencies.forEach(self);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t}\n\t\t\t\t\t} else {\n\t\t\t\t\t\tvalue.pending = this.promise.pending;\n\t\t\t\t\t}\n\t\t\t\t} else if (value.pending) {\n\t\t\t\t\tthis.promise.pending = value.pending;\n\t\t\t\t} else {\n\t\t\t\t\tthis.promise.pending = value.pending = [];\n\t\t\t\t}\n\t\t\t\treturn this.promise;\n\t\t\t}\n\t\t\tthis.promise.failed = value.failed;\n\t\t\tvalue = value.value;\n\t\t}\n\t\treturn this._settle(value);\n\t},\n\treject: function (error) {\n\t\tif (this.resolved) return this.promise;\n\t\tthis.resolved = true;\n\t\tif (!--count) clearTimeout(timeout);\n\t\tif (this.promise.monitor) clearTimeout(this.promise.monitor);\n\t\tthis.promise.failed = true;\n\t\treturn this._settle(error);\n\t}\n};\n\nmodule.exports = createDeferred = function (value) {\n\tvar l = arguments.length, d, waiting, initialized, result;\n\tif (!l) return new Deferred();\n\tif (l > 1) {\n\t\td = new Deferred();\n\t\twaiting = 0;\n\t\tresult = new Array(l);\n\t\tevery.call(arguments, function (value, index) {\n\t\t\tvalue = assimilate(value);\n\t\t\tif (!isPromise(value)) {\n\t\t\t\tresult[index] = value;\n\t\t\t\treturn true;\n\t\t\t}\n\t\t\tif (value.resolved) {\n\t\t\t\tif (value.failed) {\n\t\t\t\t\td.reject(value.value);\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t\tresult[index] = value.value;\n\t\t\t\treturn true;\n\t\t\t}\n\t\t\t++waiting;\n\t\t\tvalue.done(function (value) {\n\t\t\t\tresult[index] = value;\n\t\t\t\tif (!--waiting && initialized) d.resolve(result);\n\t\t\t}, d.reject);\n\t\t\treturn true;\n\t\t});\n\t\tinitialized = true;\n\t\tif (!waiting) d.resolve(result);\n\t\treturn d.promise;\n\t}\n\tvalue = assimilate(value);\n\tif (isPromise(value)) return value;\n\treturn resolve(value, isError(value));\n};\n\ncreateDeferred.Deferred = Deferred;\ncreateDeferred.reject = function (value) { return resolve(value, true); };\ncreateDeferred.resolve = function (value) {\n\tvalue = assimilate(value);\n\tif (isPromise(value)) return value;\n\treturn resolve(value, false);\n};\next = require('./_ext');\nassimilate = require('./assimilate');\n","// Dynamic queue handler\n// Allows to create a promise queue, where new promises can be added to queue until last promise in\n// a queue resolves. Queue promise resolves with `undefined` value, when last promises resolves.\n\n'use strict';\n\nvar aFrom          = require('es5-ext/array/from')\n  , ensureIterable = require('es5-ext/iterable/validate-object')\n  , assign         = require('es5-ext/object/assign')\n  , deferred       = require('./deferred')\n  , isPromise      = require('./is-promise')\n  , assimilate     = require('./assimilate')\n\n  , DynamicQueue;\n\nmodule.exports = DynamicQueue = function (list) {\n\tif (!(this instanceof DynamicQueue)) return new DynamicQueue(list);\n\tlist = aFrom(ensureIterable(list));\n\n\tassign(this, deferred());\n\tlist.every(this.add, this);\n\tif (!this.waiting) {\n\t\tthis.resolve();\n\t\treturn;\n\t}\n\tthis.initialized = true;\n};\n\nDynamicQueue.prototype = {\n\twaiting: 0,\n\tinitialized: false,\n\tadd: function (value) {\n\t\tif (this.promise.resolved) throw new Error(\"Queue was already resolved\");\n\t\t++this.waiting;\n\t\tvalue = assimilate(value);\n\t\tif (isPromise(value)) {\n\t\t\tif (!value.resolved) {\n\t\t\t\tvalue.done(this._processValue.bind(this), this.reject);\n\t\t\t\treturn true;\n\t\t\t}\n\t\t\tif (value.failed) {\n\t\t\t\tthis.reject(value.value);\n\t\t\t\treturn false;\n\t\t\t}\n\t\t}\n\t\treturn this._processValue();\n\t},\n\t_processValue: function () {\n\t\tif (this.promise.resolved) return;\n\t\tif (!--this.waiting && this.initialized) this.resolve();\n\t\treturn true;\n\t}\n};\n","'use strict';\n\nvar arrayOf    = require('es5-ext/array/of')\n  , deferred   = require('../deferred')\n  , isPromise  = require('../is-promise')\n  , assimilate = require('../assimilate')\n\n  , push = Array.prototype.push, slice = Array.prototype.slice;\n\nmodule.exports = function (args, length) {\n\tvar i, l, arg;\n\tif ((length != null) && (args.length !== length)) {\n\t\targs = slice.call(args, 0, length);\n\t\tif (args.length < length) {\n\t\t\tpush.apply(args, new Array(length - args.length));\n\t\t}\n\t}\n\tfor (i = 0, l = args.length; i < l; ++i) {\n\t\targ = assimilate(args[i]);\n\t\tif (isPromise(arg)) {\n\t\t\tif (!arg.resolved) {\n\t\t\t\tif (l > 1) return deferred.apply(null, args);\n\t\t\t\treturn arg(arrayOf);\n\t\t\t}\n\t\t\tif (arg.failed) return arg;\n\t\t\targs[i] = arg.value;\n\t\t}\n\t}\n\treturn args;\n};\n","// Promise aware Array's every\n\n'use strict';\n\nmodule.exports = require('../../lib/some-every')(false);\n","// Promise aware Array's find\n// Additionally differs from some that it returns *first in order* item that matches constraint\n\n'use strict';\n\nvar assign     = require('es5-ext/object/assign')\n  , value      = require('es5-ext/object/valid-value')\n  , callable   = require('es5-ext/object/valid-callable')\n  , deferred   = require('../../deferred')\n  , isPromise  = require('../../is-promise')\n  , assimilate = require('../../assimilate')\n\n  , call = Function.prototype.call\n  , resolve = deferred.resolve\n  , Find;\n\nFind = function (list, cb, context) {\n\tthis.list = list;\n\tthis.cb = cb;\n\tthis.context = context;\n\tthis.length = list.length >>> 0;\n\n\twhile (this.current < this.length) {\n\t\tif (this.current in list) {\n\t\t\tassign(this, deferred());\n\t\t\tthis.processCb = this.processCb.bind(this);\n\t\t\tthis.process();\n\t\t\treturn this.promise;\n\t\t}\n\t\t++this.current;\n\t}\n\treturn resolve(undefined);\n};\n\nFind.prototype = {\n\tcurrent: 0,\n\tprocess: function () {\n\t\tvar value = assimilate(this.list[this.current]);\n\t\tif (isPromise(value)) {\n\t\t\tif (!value.resolved) {\n\t\t\t\tvalue.done(this.processCb, this.reject);\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tif (value.failed) {\n\t\t\t\tthis.reject(value.value);\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tvalue = value.value;\n\t\t}\n\t\tthis.processCb(value);\n\t},\n\tprocessCb: function (listValue) {\n\t\tvar value;\n\t\tif (this.cb) {\n\t\t\ttry {\n\t\t\t\tvalue = call.call(this.cb, this.context, listValue, this.current, this.list);\n\t\t\t} catch (e) {\n\t\t\t\tthis.reject(e);\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tvalue = assimilate(value);\n\t\t\tif (isPromise(value)) {\n\t\t\t\tif (!value.resolved) {\n\t\t\t\t\tvalue.done(this.processValue.bind(this, listValue), this.reject);\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tif (value.failed) {\n\t\t\t\t\tthis.reject(value.value);\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tvalue = value.value;\n\t\t\t}\n\t\t} else {\n\t\t\tvalue = listValue;\n\t\t}\n\t\tthis.processValue(listValue, value);\n\t},\n\tprocessValue: function (listValue, value) {\n\t\tif (value) {\n\t\t\tthis.resolve(listValue);\n\t\t\treturn;\n\t\t}\n\t\twhile (++this.current < this.length) {\n\t\t\tif (this.current in this.list) {\n\t\t\t\tthis.process();\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\t\tthis.resolve(undefined);\n\t}\n};\n\nmodule.exports = function (cb/*, thisArg*/) {\n\tvalue(this);\n\t((cb == null) || callable(cb));\n\n\treturn new Find(this, cb, arguments[1]);\n};\n","// Promise aware Array's map\n\n'use strict';\n\nvar assign     = require('es5-ext/object/assign')\n  , value      = require('es5-ext/object/valid-value')\n  , callable   = require('es5-ext/object/valid-callable')\n  , deferred   = require('../../deferred')\n  , isPromise  = require('../../is-promise')\n  , assimilate = require('../../assimilate')\n\n  , every = Array.prototype.every\n  , call = Function.prototype.call\n\n  , DMap;\n\nDMap = function (list, cb, context) {\n\tthis.list = list;\n\tthis.cb = cb;\n\tthis.context = context;\n\tthis.result = new Array(list.length >>> 0);\n\n\tassign(this, deferred());\n\tevery.call(list, this.process, this);\n\tif (!this.waiting) return this.resolve(this.result);\n\tthis.initialized = true;\n\n\treturn this.promise;\n};\n\nDMap.prototype = {\n\twaiting: 0,\n\tinitialized: false,\n\tprocess: function (value, index) {\n\t\t++this.waiting;\n\t\tvalue = assimilate(value);\n\t\tif (isPromise(value)) {\n\t\t\tif (!value.resolved) {\n\t\t\t\tvalue.done(this.processCb.bind(this, index), this.reject);\n\t\t\t\treturn true;\n\t\t\t}\n\t\t\tif (value.failed) {\n\t\t\t\tthis.reject(value.value);\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\tvalue = value.value;\n\t\t}\n\t\treturn this.processCb(index, value);\n\t},\n\tprocessCb: function (index, value) {\n\t\tif (this.promise.resolved) return false;\n\t\tif (this.cb) {\n\t\t\ttry {\n\t\t\t\tvalue = call.call(this.cb, this.context, value, index, this.list);\n\t\t\t} catch (e) {\n\t\t\t\tthis.reject(e);\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\tvalue = assimilate(value);\n\t\t\tif (isPromise(value)) {\n\t\t\t\tif (!value.resolved) {\n\t\t\t\t\tvalue.done(this.processValue.bind(this, index), this.reject);\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\t\t\t\tif (value.failed) {\n\t\t\t\t\tthis.reject(value.value);\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t\tvalue = value.value;\n\t\t\t}\n\t\t}\n\t\tthis.processValue(index, value);\n\t\treturn true;\n\t},\n\tprocessValue: function (index, value) {\n\t\tif (this.promise.resolved) return;\n\t\tthis.result[index] = value;\n\t\tif (!--this.waiting && this.initialized) this.resolve(this.result);\n\t}\n};\n\nmodule.exports = function (cb/*, thisArg*/) {\n\tvalue(this);\n\t((cb == null) || callable(cb));\n\n\treturn new DMap(this, cb, arguments[1]);\n};\n","// Promise aware Array's reduce\n\n'use strict';\n\nvar assign     = require('es5-ext/object/assign')\n  , value      = require('es5-ext/object/valid-value')\n  , callable   = require('es5-ext/object/valid-callable')\n  , deferred   = require('../../deferred')\n  , isPromise  = require('../../is-promise')\n  , assimilate = require('../../assimilate')\n\n  , call = Function.prototype.call\n  , hasOwnProperty = Object.prototype.hasOwnProperty\n  , resolve = deferred.resolve\n  , Reduce;\n\nReduce = function (list, cb, initial, initialized) {\n\tthis.list = list;\n\tthis.cb = cb;\n\tthis.initialized = initialized;\n\tthis.length = list.length >>> 0;\n\n\tinitial = assimilate(initial);\n\tif (isPromise(initial)) {\n\t\tif (!initial.resolved) {\n\t\t\tassign(this, deferred());\n\t\t\tinitial.done(function (initial) {\n\t\t\t\tthis.value = initial;\n\t\t\t\tthis.init();\n\t\t\t}.bind(this), this.reject);\n\t\t\treturn this.promise;\n\t\t}\n\t\tthis.value = initial.value;\n\t\tif (initial.failed) return initial;\n\t} else {\n\t\tthis.value = initial;\n\t}\n\n\treturn this.init();\n};\n\nReduce.prototype = {\n\tcurrent: 0,\n\tstate: false,\n\tinit: function () {\n\t\twhile (this.current < this.length) {\n\t\t\tif (hasOwnProperty.call(this.list, this.current)) break;\n\t\t\t++this.current;\n\t\t}\n\t\tif (this.current === this.length) {\n\t\t\tif (!this.initialized) {\n\t\t\t\tthrow new Error(\"Reduce of empty array with no initial value\");\n\t\t\t}\n\t\t\treturn this.resolve ? this.resolve(this.value) : resolve(this.value);\n\t\t}\n\t\tif (!this.promise) assign(this, deferred());\n\t\tthis.processCb = this.processCb.bind(this);\n\t\tthis.processValue = this.processValue.bind(this);\n\t\tthis.continue();\n\t\treturn this.promise;\n\t},\n\tcontinue: function () {\n\t\tvar result;\n\t\twhile (!this.state) {\n\t\t\tresult = this.process();\n\t\t\tif (this.state !== 'cb') break;\n\t\t\tresult = this.processCb(result);\n\t\t\tif (this.state !== 'value') break;\n\t\t\tthis.processValue(result);\n\t\t}\n\t},\n\tprocess: function () {\n\t\tvar value = assimilate(this.list[this.current]);\n\t\tif (isPromise(value)) {\n\t\t\tif (!value.resolved) {\n\t\t\t\tvalue.done(function (result) {\n\t\t\t\t\tresult = this.processCb(result);\n\t\t\t\t\tif (this.state !== 'value') return;\n\t\t\t\t\tthis.processValue(result);\n\t\t\t\t\tif (!this.state) this.continue();\n\t\t\t\t}.bind(this), this.reject);\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tif (value.failed) {\n\t\t\t\tthis.reject(value.value);\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tvalue = value.value;\n\t\t}\n\t\tthis.state = 'cb';\n\t\treturn value;\n\t},\n\tprocessCb: function (value) {\n\t\tif (!this.initialized) {\n\t\t\tthis.initialized = true;\n\t\t\tthis.state = 'value';\n\t\t\treturn value;\n\t\t}\n\t\tif (this.cb) {\n\t\t\ttry {\n\t\t\t\tvalue = call.call(this.cb, undefined, this.value, value, this.current,\n\t\t\t\t\tthis.list);\n\t\t\t} catch (e) {\n\t\t\t\tthis.reject(e);\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tvalue = assimilate(value);\n\t\t\tif (isPromise(value)) {\n\t\t\t\tif (!value.resolved) {\n\t\t\t\t\tvalue.done(function (result) {\n\t\t\t\t\t\tthis.state = 'value';\n\t\t\t\t\t\tthis.processValue(result);\n\t\t\t\t\t\tif (!this.state) this.continue();\n\t\t\t\t\t}.bind(this), this.reject);\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tif (value.failed) {\n\t\t\t\t\tthis.reject(value.value);\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tvalue = value.value;\n\t\t\t}\n\t\t}\n\t\tthis.state = 'value';\n\t\treturn value;\n\t},\n\tprocessValue: function (value) {\n\t\tthis.value = value;\n\t\twhile (++this.current < this.length) {\n\t\t\tif (hasOwnProperty.call(this.list, this.current)) {\n\t\t\t\tthis.state = false;\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\t\tthis.resolve(this.value);\n\t}\n};\n\nmodule.exports = function (cb/*, initial*/) {\n\tvalue(this);\n\t((cb == null) || callable(cb));\n\n\treturn new Reduce(this, cb, arguments[1], arguments.length > 1);\n};\n","// Promise aware Array's some\n\n'use strict';\n\nmodule.exports = require('../../lib/some-every')(true);\n","// Call asynchronous function\n\n'use strict';\n\nvar toArray          = require('es5-ext/array/to-array')\n  , callable         = require('es5-ext/object/valid-callable')\n  , deferred         = require('../../deferred')\n  , isPromise        = require('../../is-promise')\n  , processArguments = require('../_process-arguments')\n\n  , slice = Array.prototype.slice, apply = Function.prototype.apply\n\n  , applyFn, callAsync;\n\napplyFn = function (fn, args, def) {\n\targs = toArray(args);\n\tapply.call(fn,  this, args.concat(function (error, result) {\n\t\tif (error == null) {\n\t\t\tdef.resolve((arguments.length > 2) ? slice.call(arguments, 1) : result);\n\t\t} else {\n\t\t\tdef.reject(error);\n\t\t}\n\t}));\n};\n\ncallAsync = function (fn, length, context, args) {\n\tvar def;\n\targs = processArguments(args, length);\n\tif (isPromise(args)) {\n\t\tif (args.failed) return args;\n\t\tdef = deferred();\n\t\targs.done(function (args) {\n\t\t\tif (fn.returnsPromise) return apply.call(fn, context, args);\n\t\t\ttry {\n\t\t\t\tapplyFn.call(context, fn, args, def);\n\t\t\t} catch (e) { def.reject(e); }\n\t\t}, def.reject);\n\t\treturn def.promise;\n\t}\n\tif (fn.returnsPromise) return apply.call(fn, context, args);\n\tdef = deferred();\n\ttry {\n\t\tapplyFn.call(context, fn, args, def);\n\t} catch (e) {\n\t\tdef.reject(e);\n\t\tthrow e;\n\t}\n\treturn def.promise;\n};\n\nmodule.exports = exports = function (context/*, …args*/) {\n\treturn callAsync(callable(this), null, context, slice.call(arguments, 1));\n};\n\nObject.defineProperty(exports, '_base', { configurable: true,\n\tenumerable: false, writable: true, value: callAsync });\n","// Delay function execution, return promise for delayed function result\n\n'use strict';\n\nvar callable      = require('es5-ext/object/valid-callable')\n  , nextTick      = require('next-tick')\n  , ensureTimeout = require('timers-ext/valid-timeout')\n  , deferred      = require('../../deferred')\n\n  , apply    = Function.prototype.apply\n  , delayed;\n\ndelayed = function (fn, args, resolve, reject) {\n\tvar value;\n\ttry {\n\t\tvalue = apply.call(fn, this, args);\n\t} catch (e) {\n\t\treject(e);\n\t\treturn;\n\t}\n\tresolve(value);\n};\n\nmodule.exports = function (timeout) {\n\tvar fn, result, delay;\n\tfn = callable(this);\n\tif (timeout == null) {\n\t\tdelay = nextTick;\n\t} else {\n\t\ttimeout = ensureTimeout(timeout);\n\t\tdelay = setTimeout;\n\t}\n\tresult = function () {\n\t\tvar def = deferred();\n\t\tdelay(delayed.bind(this, fn, arguments, def.resolve, def.reject), timeout);\n\t\treturn def.promise;\n\t};\n\tresult.returnsPromise = true;\n\treturn result;\n};\n","// Limit number of concurrent function executions (to cLimit number).\n// Limited calls are queued. Optionaly maximum queue length can also be\n// controlled with qLimit value, any calls that would reach over that limit\n// would be discarded (its promise would resolve with \"Too many calls\" error)\n\n'use strict';\n\nvar toPosInt   = require('es5-ext/number/to-pos-integer')\n  , callable   = require('es5-ext/object/valid-callable')\n  , eeUnify    = require('event-emitter/unify')\n  , deferred   = require('../../deferred')\n  , isPromise  = require('../../is-promise')\n  , assimilate = require('../../assimilate')\n\n  , resolve = deferred.resolve, reject = deferred.reject\n  , apply = Function.prototype.apply, max = Math.max\n  , gateReject;\n\nrequire('../promise/finally');\n\ngateReject = function () {\n\tvar e = new Error(\"Too many calls\");\n\te.type = 'deferred-gate-rejected';\n\treturn reject(e);\n};\n\nmodule.exports = function (cLimit, qLimit) {\n\tvar fn, count, decrement, unload, queue, run, result;\n\tfn = callable(this);\n\tcLimit = max(toPosInt(cLimit), 1);\n\tqLimit = ((qLimit == null) || isNaN(qLimit)) ? Infinity : toPosInt(qLimit);\n\tcount = 0;\n\tqueue = [];\n\n\trun = function (thisArg, args, def) {\n\t\tvar r;\n\t\ttry {\n\t\t\tr = apply.call(fn, thisArg, args);\n\t\t} catch (e) {\n\t\t\tif (!def) return reject(e);\n\t\t\tdef.reject(e);\n\t\t\tunload();\n\t\t\treturn;\n\t\t}\n\t\tr = assimilate(r);\n\t\tif (isPromise(r)) {\n\t\t\tif (def) eeUnify(def.promise, r);\n\t\t\tif (!r.resolved) {\n\t\t\t\t++count;\n\t\t\t\tif (def) def.resolve(r);\n\t\t\t\treturn r.finally(decrement);\n\t\t\t}\n\t\t\tr = r.value;\n\t\t}\n\t\tif (!def) return resolve(r);\n\t\tdef.resolve(r);\n\t\tunload();\n\t};\n\n\tdecrement = function () {\n\t\t--count;\n\t\tunload();\n\t};\n\n\tunload = function () {\n\t\tvar data;\n\t\tif ((data = queue.shift())) run.apply(null, data);\n\t};\n\n\tresult = function () {\n\t\tvar def;\n\t\tif (count >= cLimit) {\n\t\t\tif (queue.length < qLimit) {\n\t\t\t\tdef = deferred();\n\t\t\t\tqueue.push([this, arguments, def]);\n\t\t\t\treturn def.promise;\n\t\t\t}\n\t\t\treturn gateReject();\n\t\t}\n\t\treturn run(this, arguments);\n\t};\n\tresult.returnsPromise = true;\n\treturn result;\n};\n","// Promisify synchronous function\n\n'use strict';\n\nvar callable         = require('es5-ext/object/valid-callable')\n  , deferred         = require('../../deferred')\n  , isPromise        = require('../../is-promise')\n  , processArguments = require('../_process-arguments')\n\n  , apply = Function.prototype.apply\n\n  , applyFn;\n\napplyFn = function (fn, args, resolve, reject) {\n\tvar value;\n\ttry {\n\t\tvalue = apply.call(fn, this, args);\n\t} catch (e) {\n\t\treject(e);\n\t\treturn;\n\t}\n\tresolve(value);\n};\n\nmodule.exports = function (length) {\n\tvar fn, result;\n\tfn = callable(this);\n\tif (fn.returnsPromise) return fn;\n\tif (length != null) length = length >>> 0;\n\tresult = function () {\n\t\tvar args, def;\n\t\targs = processArguments(arguments, length);\n\n\t\tif (isPromise(args)) {\n\t\t\tif (args.failed) return args;\n\t\t\tdef = deferred();\n\t\t\targs.done(function (args) {\n\t\t\t\tapplyFn.call(this, fn, args, def.resolve, def.reject);\n\t\t\t}.bind(this), def.reject);\n\t\t} else {\n\t\t\tdef = deferred();\n\t\t\tapplyFn.call(this, fn, args, def.resolve, def.reject);\n\t\t}\n\n\t\treturn def.promise;\n\t};\n\tresult.returnsPromise = true;\n\treturn result;\n};\n","// Promisify asynchronous function\n\n'use strict';\n\nvar callable  = require('es5-ext/object/valid-callable')\n  , callAsync = require('./call-async')._base;\n\nmodule.exports = function (length) {\n\tvar fn, result;\n\tfn = callable(this);\n\tif (fn.returnsPromise) return fn;\n\tif (length != null) length = length >>> 0;\n\tresult = function () { return callAsync(fn, length, this, arguments); };\n\tresult.returnsPromise = true;\n\treturn result;\n};\n","// Used by promise extensions that are based on array extensions.\n\n'use strict';\n\nvar callable = require('es5-ext/object/valid-callable')\n  , deferred = require('../../deferred')\n\n  , reject = deferred.reject;\n\nmodule.exports = function (name, ext) {\n\tdeferred.extend(name, function (cb) {\n\t\tvar def;\n\t\t((cb == null) || callable(cb));\n\t\tif (!this.pending) this.pending = [];\n\t\tdef = deferred();\n\t\tthis.pending.push(name, [arguments, def.resolve, def.reject]);\n\t\treturn def.promise;\n\t}, function (args, resolve, reject) {\n\t\tvar result;\n\t\tif (this.failed) {\n\t\t\treject(this.value);\n\t\t\treturn;\n\t\t}\n\t\ttry {\n\t\t\tresult = ext.apply(this.value, args);\n\t\t} catch (e) {\n\t\t\treject(e);\n\t\t\treturn;\n\t\t}\n\t\tresolve(result);\n\t}, function (cb) {\n\t\t((cb == null) || callable(cb));\n\t\tif (this.failed) return this;\n\t\ttry {\n\t\t\treturn ext.apply(this.value, arguments);\n\t\t} catch (e) {\n\t\t\treturn reject(e);\n\t\t}\n\t});\n};\n","// 'aside' - Promise extension\n//\n// promise.aside(win, fail)\n//\n// Works in analogous way as promise function itself (or `then`)\n// but instead of adding promise to promise chain it returns context promise and\n// lets callback carry on with other processing logic\n\n'use strict';\n\nvar callable = require('es5-ext/object/valid-callable')\n  , deferred = require('../../deferred');\n\ndeferred.extend('aside', function (win, fail) {\n\t((win == null) || callable(win));\n\t((fail == null) || callable(fail));\n\tif (win || fail) {\n\t\tif (!this.pending) {\n\t\t\tthis.pending = [];\n\t\t}\n\t\tthis.pending.push('aside', arguments);\n\t}\n\treturn this;\n}, function (win, fail) {\n\tvar cb = this.failed ? fail : win;\n\tif (cb) {\n\t\tcb(this.value);\n\t}\n}, function (win, fail) {\n\tvar cb;\n\t((win == null) || callable(win));\n\t((fail == null) || callable(fail));\n\tcb = this.failed ? fail : win;\n\tif (cb) {\n\t\tcb(this.value);\n\t}\n\treturn this;\n});\n","// 'catch' - Promise extension\n//\n// promise.catch(cb)\n//\n// Same as `then` but accepts only onFail callback\n\n'use strict';\n\nvar isCallable = require('es5-ext/object/is-callable')\n  , validValue = require('es5-ext/object/valid-value')\n  , deferred   = require('../../deferred')\n  , isPromise  = require('../../is-promise')\n\n  , resolve = deferred.resolve, reject = deferred.reject;\n\ndeferred.extend('catch', function (cb) {\n\tvar def;\n\tvalidValue(cb);\n\tif (!this.pending) this.pending = [];\n\tdef = deferred();\n\tthis.pending.push('catch', [cb, def.resolve, def.reject]);\n\treturn def.promise;\n}, function (cb, resolve, reject) {\n\tvar value;\n\tif (!this.failed) {\n\t\tresolve(this.value);\n\t\treturn;\n\t}\n\tif (isCallable(cb)) {\n\t\tif (isPromise(cb)) {\n\t\t\tif (cb.resolved) {\n\t\t\t\tif (cb.failed) reject(cb.value);\n\t\t\t\telse resolve(cb.value);\n\t\t\t} else {\n\t\t\t\tcb.done(resolve, reject);\n\t\t\t}\n\t\t\treturn;\n\t\t}\n\t\ttry { value = cb(this.value); } catch (e) {\n\t\t\treject(e);\n\t\t\treturn;\n\t\t}\n\t\tresolve(value);\n\t\treturn;\n\t}\n\tresolve(cb);\n}, function (cb) {\n\tvar value;\n\tvalidValue(cb);\n\tif (!this.failed) return this;\n\tif (isCallable(cb)) {\n\t\tif (isPromise(cb)) return cb;\n\t\ttry { value = cb(this.value); } catch (e) {\n\t\t\treturn reject(e);\n\t\t}\n\t\treturn resolve(value);\n\t}\n\treturn resolve(cb);\n});\n","// 'cb' - Promise extension\n//\n// promise.cb(cb)\n//\n// Handles asynchronous function style callback (which is run in next event loop\n// the earliest). Returns self promise. Callback is optional.\n//\n// Useful when we want to configure typical asynchronous function which logic is\n// internally configured with promises.\n//\n// Extension can be used as follows:\n//\n// var foo = function (arg1, arg2, cb) {\n//     var d = deferred();\n//     // ... implementation\n//     return d.promise.cb(cb);\n// };\n//\n// `cb` extension returns promise and handles eventual callback (optional)\n\n'use strict';\n\nvar callable   = require('es5-ext/object/valid-callable')\n  , nextTick   = require('next-tick')\n  , deferred   = require('../../deferred');\n\ndeferred.extend('cb', function (cb) {\n\tif (cb == null) return this;\n\tcallable(cb);\n\tnextTick(function () {\n\t\tif (this.resolved) {\n\t\t\tif (this.failed) cb(this.value);\n\t\t\telse cb(null, this.value);\n\t\t} else {\n\t\t\tif (!this.pending) this.pending = [];\n\t\t\tthis.pending.push('cb', [cb]);\n\t\t}\n\t}.bind(this));\n\treturn this;\n}, function (cb) {\n\tif (this.failed) cb(this.value);\n\telse cb(null, this.value);\n}, function (cb) {\n\tif (cb == null) return this;\n\tcallable(cb);\n\tnextTick(function () {\n\t\tif (this.failed) cb(this.value);\n\t\telse cb(null, this.value);\n\t}.bind(this));\n\treturn this;\n});\n","// 'finally' - Promise extension\n//\n// promise.finally(cb)\n//\n// Called on promise resolution returns same promise, doesn't pass any values to\n// provided callback\n\n'use strict';\n\nvar callable = require('es5-ext/object/valid-callable')\n  , deferred = require('../../deferred');\n\ndeferred.extend('finally', function (cb) {\n\tcallable(cb);\n\tif (!this.pending) this.pending = [];\n\tthis.pending.push('finally', arguments);\n\treturn this;\n}, function (cb) { cb(); }, function (cb) {\n\tcallable(cb)();\n\treturn this;\n});\n","// 'get' - Promise extension\n//\n// promise.get(name)\n//\n// Resolves with property of resolved object\n\n'use strict';\n\nvar value    = require('es5-ext/object/valid-value')\n  , deferred = require('../../deferred')\n\n  , reduce = Array.prototype.reduce\n  , resolve = deferred.resolve, reject = deferred.reject;\n\ndeferred.extend('get', function (/*…name*/) {\n\tvar def;\n\tif (!this.pending) this.pending = [];\n\tdef = deferred();\n\tthis.pending.push('get', [arguments, def.resolve, def.reject]);\n\treturn def.promise;\n\n}, function (args, resolve, reject) {\n\tvar result;\n\tif (this.failed) reject(this.value);\n\ttry {\n\t\tresult = reduce.call(args, function (obj, key) {\n\t\t\treturn value(obj)[String(key)];\n\t\t}, this.value);\n\t} catch (e) {\n\t\treject(e);\n\t\treturn;\n\t}\n\tresolve(result);\n}, function (/*…name*/) {\n\tvar result;\n\tif (this.failed) return this;\n\ttry {\n\t\tresult = reduce.call(arguments, function (obj, key) {\n\t\t\treturn value(obj)[String(key)];\n\t\t}, this.value);\n\t} catch (e) {\n\t\treturn reject(e);\n\t}\n\treturn resolve(result);\n});\n","// 'invokeAsync' - Promise extension\n//\n// promise.invokeAsync(name[, arg0[, arg1[, ...]]])\n//\n// On resolved object calls asynchronous method that takes callback\n// (Node.js style).\n// Do not pass callback, it's handled by internal implementation.\n// 'name' can be method name or method itself.\n\n'use strict';\n\nvar toArray          = require('es5-ext/array/to-array')\n  , isCallable       = require('es5-ext/object/is-callable')\n  , deferred         = require('../../deferred')\n  , isPromise        = require('../../is-promise')\n  , processArguments = require('../_process-arguments')\n\n  , slice = Array.prototype.slice, apply = Function.prototype.apply\n  , reject = deferred.reject\n\n  , applyFn;\n\napplyFn = function (fn, args, resolve, reject) {\n\tvar result;\n\tif (fn.returnsPromise) {\n\t\ttry {\n\t\t\tresult = apply.call(fn, this, args);\n\t\t} catch (e) {\n\t\t\treject(e);\n\t\t\treturn;\n\t\t}\n\t\treturn resolve(result);\n\t}\n\targs = toArray(args).concat(function (error, result) {\n\t\tif (error == null) {\n\t\t\tresolve((arguments.length > 2) ? slice.call(arguments, 1) : result);\n\t\t} else {\n\t\t\treject(error);\n\t\t}\n\t});\n\ttry {\n\t\tapply.call(fn, this, args);\n\t} catch (e2) {\n\t\treject(e2);\n\t}\n};\n\ndeferred.extend('invokeAsync', function (method/*, …args*/) {\n\tvar def;\n\tif (!this.pending) this.pending = [];\n\tdef = deferred();\n\tthis.pending.push('invokeAsync', [arguments, def.resolve, def.reject]);\n\treturn def.promise;\n}, function (args, resolve, reject) {\n\tvar fn;\n\tif (this.failed) {\n\t\treject(this.value);\n\t\treturn;\n\t}\n\n\tif (this.value == null) {\n\t\treject(new TypeError(\"Cannot use null or undefined\"));\n\t\treturn;\n\t}\n\n\tfn = args[0];\n\tif (!isCallable(fn)) {\n\t\tfn = String(fn);\n\t\tif (!isCallable(this.value[fn])) {\n\t\t\treject(new TypeError(fn + \" is not a function\"));\n\t\t\treturn;\n\t\t}\n\t\tfn = this.value[fn];\n\t}\n\n\targs = processArguments(slice.call(args, 1));\n\tif (isPromise(args)) {\n\t\tif (args.failed) {\n\t\t\treject(args.value);\n\t\t\treturn;\n\t\t}\n\t\targs.done(function (args) {\n\t\t\tapplyFn.call(this, fn, args, resolve, reject);\n\t\t}.bind(this.value), reject);\n\t} else {\n\t\tapplyFn.call(this.value, fn, args, resolve, reject);\n\t}\n}, function (method/*, …args*/) {\n\tvar args, def;\n\tif (this.failed) return this;\n\n\tif (this.value == null) {\n\t\treturn reject(new TypeError(\"Cannot use null or undefined\"));\n\t}\n\n\tif (!isCallable(method)) {\n\t\tmethod = String(method);\n\t\tif (!isCallable(this.value[method])) {\n\t\t\treturn reject(new TypeError(method + \" is not a function\"));\n\t\t}\n\t\tmethod = this.value[method];\n\t}\n\n\targs = processArguments(slice.call(arguments, 1));\n\tif (isPromise(args)) {\n\t\tif (args.failed) return args;\n\t\tdef = deferred();\n\t\targs.done(function (args) {\n\t\t\tapplyFn.call(this, method, args, def.resolve, def.reject);\n\t\t}.bind(this.value), def.reject);\n\t} else if (!method.returnsPromise) {\n\t\tdef = deferred();\n\t\tapplyFn.call(this.value, method, args, def.resolve, def.reject);\n\t} else {\n\t\treturn applyFn.call(this.value, method, args, deferred, reject);\n\t}\n\treturn def.promise;\n});\n","// 'invoke' - Promise extension\n//\n// promise.invoke(name[, arg0[, arg1[, ...]]])\n//\n// On resolved object calls method that returns immediately.\n// 'name' can be method name or method itself.\n\n'use strict';\n\nvar isCallable       = require('es5-ext/object/is-callable')\n  , deferred         = require('../../deferred')\n  , isPromise        = require('../../is-promise')\n  , processArguments = require('../_process-arguments')\n\n  , slice = Array.prototype.slice, apply = Function.prototype.apply\n  , reject = deferred.reject\n  , applyFn;\n\napplyFn = function (fn, args, resolve, reject) {\n\tvar value;\n\ttry {\n\t\tvalue = apply.call(fn, this, args);\n\t} catch (e) {\n\t\treturn reject(e);\n\t}\n\treturn resolve(value);\n};\n\ndeferred.extend('invoke', function (method/*, …args*/) {\n\tvar def;\n\tif (!this.pending) this.pending = [];\n\tdef = deferred();\n\tthis.pending.push('invoke', [arguments, def.resolve, def.reject]);\n\treturn def.promise;\n}, function (args, resolve, reject) {\n\tvar fn;\n\tif (this.failed) {\n\t\treject(this.value);\n\t\treturn;\n\t}\n\n\tif (this.value == null) {\n\t\treject(new TypeError(\"Cannot use null or undefined\"));\n\t\treturn;\n\t}\n\n\tfn = args[0];\n\tif (!isCallable(fn)) {\n\t\tfn = String(fn);\n\t\tif (!isCallable(this.value[fn])) {\n\t\t\treject(new TypeError(fn + \" is not a function\"));\n\t\t\treturn;\n\t\t}\n\t\tfn = this.value[fn];\n\t}\n\n\targs = processArguments(slice.call(args, 1));\n\tif (isPromise(args)) {\n\t\tif (args.failed) {\n\t\t\treject(args.value);\n\t\t\treturn;\n\t\t}\n\t\targs.done(function (args) {\n\t\t\tapplyFn.call(this, fn, args, resolve, reject);\n\t\t}.bind(this.value), reject);\n\t} else {\n\t\tapplyFn.call(this.value, fn, args, resolve, reject);\n\t}\n}, function (method/*, …args*/) {\n\tvar args, def;\n\tif (this.failed) return this;\n\n\tif (this.value == null) {\n\t\treturn reject(new TypeError(\"Cannot use null or undefined\"));\n\t}\n\n\tif (!isCallable(method)) {\n\t\tmethod = String(method);\n\t\tif (!isCallable(this.value[method])) {\n\t\t\treturn reject(new TypeError(method + \" is not a function\"));\n\t\t}\n\t\tmethod = this.value[method];\n\t}\n\n\targs = processArguments(slice.call(arguments, 1));\n\tif (isPromise(args)) {\n\t\tif (args.failed) return args;\n\t\tdef = deferred();\n\t\targs.done(function (args) {\n\t\t\tapplyFn.call(this, method, args, def.resolve, def.reject);\n\t\t}.bind(this.value), def.reject);\n\t\treturn def.promise;\n\t}\n\treturn applyFn.call(this.value, method, args, deferred, reject);\n});\n","// 'map' - Promise extension\n//\n// promise.map(fn[, thisArg[, concurrentLimit]])\n//\n// Promise aware map for array-like results\n\n'use strict';\n\nrequire('./_array')('map', require('../array/map'));\n","// 'reduce' - Promise extension\n//\n// promise.reduce(fn[, initial])\n//\n// Promise aware reduce for array-like results\n\n'use strict';\n\nrequire('./_array')('reduce', require('../array/reduce'));\n","// 'some' - Promise extension\n//\n// promise.some(fn[, thisArg])\n//\n// Promise aware some for array-like results\n\n'use strict';\n\nrequire('./_array')('some', require('../array/some'));\n","// 'spread' - Promise extensions\n//\n// promise.spread(onsuccess, onerror)\n//\n// Matches eventual list result onto function arguments,\n// otherwise works same as 'then' (promise function itself)\n\n'use strict';\n\nvar spread     = require('es5-ext/function/#/spread')\n  , callable   = require('es5-ext/object/valid-callable')\n  , isCallable = require('es5-ext/object/is-callable')\n  , isPromise  = require('../../is-promise')\n  , deferred   = require('../../deferred')\n\n  , resolve = deferred.resolve, reject = deferred.reject;\n\ndeferred.extend('spread', function (win, fail) {\n\tvar def;\n\t((win == null) || callable(win));\n\tif (!win && (fail == null)) return this;\n\tif (!this.pending) this.pending = [];\n\tdef = deferred();\n\tthis.pending.push('spread', [win, fail, def.resolve, def.reject]);\n\treturn def.promise;\n}, function (win, fail, resolve, reject) {\n\tvar cb, value;\n\tcb = this.failed ? fail : win;\n\tif (cb == null) {\n\t\tif (this.failed) reject(this.value);\n\t\telse resolve(this.value);\n\t}\n\tif (isCallable(cb)) {\n\t\tif (isPromise(cb)) {\n\t\t\tif (cb.resolved) {\n\t\t\t\tif (cb.failed) reject(cb.value);\n\t\t\t\telse resolve(cb.value);\n\t\t\t} else {\n\t\t\t\tcb.done(resolve, reject);\n\t\t\t}\n\t\t\treturn;\n\t\t}\n\t\tif (!this.failed) cb = spread.call(cb);\n\t\ttry {\n\t\t\tvalue = cb(this.value);\n\t\t} catch (e) {\n\t\t\treject(e);\n\t\t\treturn;\n\t\t}\n\t\tresolve(value);\n\t} else {\n\t\tresolve(cb);\n\t}\n}, function (win, fail) {\n\tvar cb, value;\n\tcb = this.failed ? fail : win;\n\tif (cb == null) return this;\n\tif (isCallable(cb)) {\n\t\tif (isPromise(cb)) return cb;\n\t\tif (!this.failed) cb = spread.call(cb);\n\t\ttry {\n\t\t\tvalue = cb(this.value);\n\t\t} catch (e) {\n\t\t\treturn reject(e);\n\t\t}\n\t\treturn resolve(value);\n\t}\n\treturn resolve(cb);\n});\n","// This construct deferred with all needed goodies that are being exported\n// when we import 'deferred' by main name.\n// All available promise extensions are also initialized.\n\n'use strict';\n\nvar call   = Function.prototype.call\n  , assign = require('es5-ext/object/assign');\n\nmodule.exports = assign(require('./deferred'), {\n\tinvokeAsync:   require('./invoke-async'),\n\tisPromise:     require('./is-promise'),\n\tdynamicQueue:  require('./dynamic-queue'),\n\tvalidPromise:  require('./valid-promise'),\n\tcallAsync:     call.bind(require('./ext/function/call-async')),\n\tdelay:         call.bind(require('./ext/function/delay')),\n\tgate:          call.bind(require('./ext/function/gate')),\n\tmonitor:       require('./monitor'),\n\tpromisify:     call.bind(require('./ext/function/promisify')),\n\tpromisifySync: call.bind(require('./ext/function/promisify-sync')),\n\tevery:         call.bind(require('./ext/array/every')),\n\tfind:          call.bind(require('./ext/array/find')),\n\tmap:           call.bind(require('./ext/array/map')),\n\treduce:        call.bind(require('./ext/array/reduce')),\n\tsome:          call.bind(require('./ext/array/some'))\n}, require('./profiler'));\n\nrequire('./ext/promise/aside');\nrequire('./ext/promise/catch');\nrequire('./ext/promise/cb');\nrequire('./ext/promise/finally');\nrequire('./ext/promise/get');\nrequire('./ext/promise/invoke');\nrequire('./ext/promise/invoke-async');\nrequire('./ext/promise/map');\nrequire('./ext/promise/spread');\nrequire('./ext/promise/some');\nrequire('./ext/promise/reduce');\n","// Invoke asynchronous function\n\n'use strict';\n\nvar isCallable = require('es5-ext/object/is-callable')\n  , callable   = require('es5-ext/object/valid-callable')\n  , value      = require('es5-ext/object/valid-value')\n  , callAsync  = require('./ext/function/call-async')._base\n\n  , slice = Array.prototype.slice;\n\nmodule.exports = function (obj, fn/*, …args*/) {\n\tvalue(obj);\n\tif (!isCallable(fn)) fn = callable(obj[fn]);\n\treturn callAsync(fn, null, obj, slice.call(arguments, 2));\n};\n","// Whether given object is a promise\n\n'use strict';\n\nmodule.exports = function (o) {\n\treturn (typeof o === 'function') && (typeof o.then === 'function') && (o.end !== o.done);\n};\n","// Promise aware Array's some\n\n'use strict';\n\nvar assign     = require('es5-ext/object/assign')\n  , value      = require('es5-ext/object/valid-value')\n  , callable   = require('es5-ext/object/valid-callable')\n  , deferred   = require('../deferred')\n  , isPromise  = require('../is-promise')\n  , assimilate = require('../assimilate')\n\n  , call = Function.prototype.call\n  , resolve = deferred.resolve;\n\nmodule.exports = function (resolvent) {\n\tvar Iterator = function (list, cb, context) {\n\t\tthis.list = list;\n\t\tthis.cb = cb;\n\t\tthis.context = context;\n\t\tthis.length = list.length >>> 0;\n\n\t\twhile (this.current < this.length) {\n\t\t\tif (this.current in list) {\n\t\t\t\tassign(this, deferred());\n\t\t\t\tthis.processCb = this.processCb.bind(this);\n\t\t\t\tthis.processValue = this.processValue.bind(this);\n\t\t\t\tthis.continue();\n\t\t\t\treturn this.promise;\n\t\t\t}\n\t\t\t++this.current;\n\t\t}\n\t\treturn resolve(!resolvent);\n\t};\n\n\tIterator.prototype = {\n\t\tcurrent: 0,\n\t\tstate: false,\n\t\tcontinue: function () {\n\t\t\tvar result;\n\t\t\twhile (!this.state) {\n\t\t\t\tresult = this.process();\n\t\t\t\tif (this.state !== 'cb') break;\n\t\t\t\tresult = this.processCb(result);\n\t\t\t\tif (this.state !== 'value') break;\n\t\t\t\tthis.processValue(result);\n\t\t\t}\n\t\t},\n\t\tprocess: function () {\n\t\t\tvar value = assimilate(this.list[this.current]);\n\t\t\tif (isPromise(value)) {\n\t\t\t\tif (!value.resolved) {\n\t\t\t\t\tvalue.done(function (result) {\n\t\t\t\t\t\tresult = this.processCb(result);\n\t\t\t\t\t\tif (this.state !== 'value') return;\n\t\t\t\t\t\tthis.processValue(result);\n\t\t\t\t\t\tif (!this.state) this.continue();\n\t\t\t\t\t}.bind(this), this.reject);\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tif (value.failed) {\n\t\t\t\t\tthis.reject(value.value);\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tvalue = value.value;\n\t\t\t}\n\t\t\tthis.state = 'cb';\n\t\t\treturn value;\n\t\t},\n\t\tprocessCb: function (value) {\n\t\t\tif (this.cb) {\n\t\t\t\ttry {\n\t\t\t\t\tvalue = call.call(this.cb, this.context, value, this.current, this.list);\n\t\t\t\t} catch (e) {\n\t\t\t\t\tthis.reject(e);\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tvalue = assimilate(value);\n\t\t\t\tif (isPromise(value)) {\n\t\t\t\t\tif (!value.resolved) {\n\t\t\t\t\t\tvalue.done(function (result) {\n\t\t\t\t\t\t\tthis.state = 'value';\n\t\t\t\t\t\t\tthis.processValue(result);\n\t\t\t\t\t\t\tif (!this.state) this.continue();\n\t\t\t\t\t\t}.bind(this), this.reject);\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\tif (value.failed) {\n\t\t\t\t\t\tthis.reject(value.value);\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\tvalue = value.value;\n\t\t\t\t}\n\t\t\t}\n\t\t\tthis.state = 'value';\n\t\t\treturn value;\n\t\t},\n\t\tprocessValue: function (value) {\n\t\t\tif (Boolean(value) === resolvent) {\n\t\t\t\tthis.resolve(resolvent);\n\t\t\t\treturn;\n\t\t\t}\n\t\t\twhile (++this.current < this.length) {\n\t\t\t\tif (this.current in this.list) {\n\t\t\t\t\tthis.state = false;\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t}\n\t\t\tthis.resolve(!resolvent);\n\t\t}\n\t};\n\n\treturn function (cb/*, thisArg*/) {\n\t\tvalue(this);\n\t\t((cb == null) || callable(cb));\n\n\t\treturn new Iterator(this, cb, arguments[1]);\n\t};\n};\n","// Run if you want to monitor unresolved promises (in properly working\n// application there should be no promises that are never resolved)\n\n'use strict';\n\nvar max        = Math.max\n  , callable   = require('es5-ext/object/valid-callable')\n  , isCallable = require('es5-ext/object/is-callable')\n  , toPosInt   = require('es5-ext/number/to-pos-integer')\n  , deferred   = require('./deferred');\n\nexports = module.exports = function (timeout, cb) {\n\tif (timeout === false) {\n\t\t// Cancel monitor\n\t\tdelete deferred._monitor;\n\t\tdelete exports.timeout;\n\t\tdelete exports.callback;\n\t\treturn;\n\t}\n\texports.timeout = timeout = max(toPosInt(timeout) || 5000, 50);\n\tif (cb == null) {\n\t\tif ((typeof console !== 'undefined') && console &&\n\t\t\t\tisCallable(console.error)) {\n\t\t\tcb = function (e) {\n\t\t\t\tconsole.error(((e.stack && e.stack.toString()) ||\n\t\t\t\t\t\"Unresolved promise: no stack available\"));\n\t\t\t};\n\t\t}\n\t} else {\n\t\tcallable(cb);\n\t}\n\texports.callback = cb;\n\n\tdeferred._monitor = function () {\n\t\tvar e = new Error(\"Unresolved promise\");\n\t\treturn setTimeout(function () {\n\t\t\tif (cb) cb(e);\n\t\t}, timeout);\n\t};\n};\n","'use strict';\n\nvar partial  = require('es5-ext/function/#/partial')\n  , forEach  = require('es5-ext/object/for-each')\n  , pad      = require('es5-ext/string/#/pad')\n  , deferred = require('./deferred')\n\n  , resolved, rStats, unresolved, uStats, profile;\n\nexports.profile = function () {\n\tresolved = 0;\n\trStats = {};\n\tunresolved = 0;\n\tuStats = {};\n\tdeferred._profile = profile;\n};\n\nprofile = function (isResolved) {\n\tvar stack, data;\n\n\tif (isResolved) {\n\t\t++resolved;\n\t\tdata = rStats;\n\t} else {\n\t\t++unresolved;\n\t\tdata = uStats;\n\t}\n\n\tstack = (new Error()).stack;\n\tif (!stack.split('\\n').slice(3).some(function (line) {\n\t\t\tif ((line.search(/[\\/\\\\]deferred[\\/\\\\]/) === -1) &&\n\t\t\t\t\t(line.search(/[\\/\\\\]es5-ext[\\/\\\\]/) === -1) &&\n\t\t\t\t\t(line.indexOf(' (native)') === -1)) {\n\t\t\t\tline = line.replace(/\\n/g, \"\\\\n\").trim();\n\t\t\t\tif (!data[line]) {\n\t\t\t\t\tdata[line] = { count: 0 };\n\t\t\t\t}\n\t\t\t\t++data[line].count;\n\t\t\t\treturn true;\n\t\t\t}\n\t\t})) {\n\t\tif (!data.unknown) {\n\t\t\tdata.unknown = { count: 0, stack: stack };\n\t\t}\n\t\t++data.unknown.count;\n\t}\n};\n\nexports.profileEnd = function () {\n\tvar total, lpad, log = '';\n\n\tif (!deferred._profile) {\n\t\tthrow new Error(\"Deferred profiler was not initialized\");\n\t}\n\tdelete deferred._profile;\n\n\tlog += \"------------------------------------------------------------\\n\";\n\tlog += \"Deferred usage statistics:\\n\\n\";\n\n\ttotal = String(resolved + unresolved);\n\tlpad = partial.call(pad, \" \", total.length);\n\tlog += total + \" Total promises initialized\\n\";\n\tlog += lpad.call(unresolved) + \" Initialized as Unresolved\\n\";\n\tlog += lpad.call(resolved) + \" Initialized as Resolved\\n\";\n\n\tif (unresolved) {\n\t\tlog += \"\\nUnresolved promises were initialized at:\\n\";\n\t\tforEach(uStats, function (data, name) {\n\t\t\tlog += lpad.call(data.count) + \" \" + name + \"\\n\";\n\t\t}, null, function (a, b) {\n\t\t\treturn this[b].count - this[a].count;\n\t\t});\n\t}\n\n\tif (resolved) {\n\t\tlog += \"\\nResolved promises were initialized at:\\n\";\n\t\tforEach(rStats, function (data, name) {\n\t\t\tlog += lpad.call(data.count) + \" \" + name + \"\\n\";\n\t\t}, null, function (a, b) {\n\t\t\treturn this[b].count - this[a].count;\n\t\t});\n\t}\n\tlog += \"------------------------------------------------------------\\n\";\n\n\treturn {\n\t\tlog: log,\n\t\tresolved: { count: resolved, stats: rStats },\n\t\tunresolved: { count: unresolved, stats: uStats }\n\t};\n};\n","'use strict';\n\nvar isPromise = require('./is-promise');\n\nmodule.exports = function (x) {\n\tif (!isPromise(x)) {\n\t\tthrow new TypeError(x + \" is not a promise object\");\n\t}\n\treturn x;\n};\n","'use strict';\n\nmodule.exports = require('./is-implemented')()\n\t? Array.from\n\t: require('./shim');\n","'use strict';\n\nmodule.exports = function () {\n\tvar from = Array.from, arr, result;\n\tif (typeof from !== 'function') return false;\n\tarr = ['raz', 'dwa'];\n\tresult = from(arr);\n\treturn Boolean(result && (result !== arr) && (result[1] === 'dwa'));\n};\n","'use strict';\n\nvar iteratorSymbol = require('es6-symbol').iterator\n  , isArguments    = require('../../function/is-arguments')\n  , isFunction     = require('../../function/is-function')\n  , toPosInt       = require('../../number/to-pos-integer')\n  , callable       = require('../../object/valid-callable')\n  , validValue     = require('../../object/valid-value')\n  , isString       = require('../../string/is-string')\n\n  , isArray = Array.isArray, call = Function.prototype.call\n  , desc = { configurable: true, enumerable: true, writable: true, value: null }\n  , defineProperty = Object.defineProperty;\n\nmodule.exports = function (arrayLike/*, mapFn, thisArg*/) {\n\tvar mapFn = arguments[1], thisArg = arguments[2], Constructor, i, j, arr, l, code, iterator\n\t  , result, getIterator, value;\n\n\tarrayLike = Object(validValue(arrayLike));\n\n\tif (mapFn != null) callable(mapFn);\n\tif (!this || (this === Array) || !isFunction(this)) {\n\t\t// Result: Plain array\n\t\tif (!mapFn) {\n\t\t\tif (isArguments(arrayLike)) {\n\t\t\t\t// Source: Arguments\n\t\t\t\tl = arrayLike.length;\n\t\t\t\tif (l !== 1) return Array.apply(null, arrayLike);\n\t\t\t\tarr = new Array(1);\n\t\t\t\tarr[0] = arrayLike[0];\n\t\t\t\treturn arr;\n\t\t\t}\n\t\t\tif (isArray(arrayLike)) {\n\t\t\t\t// Source: Array\n\t\t\t\tarr = new Array(l = arrayLike.length);\n\t\t\t\tfor (i = 0; i < l; ++i) arr[i] = arrayLike[i];\n\t\t\t\treturn arr;\n\t\t\t}\n\t\t}\n\t\tarr = [];\n\t} else {\n\t\t// Result: Non plain array\n\t\tConstructor = this;\n\t}\n\n\tif (!isArray(arrayLike)) {\n\t\tif ((getIterator = arrayLike[iteratorSymbol]) !== undefined) {\n\t\t\t// Source: Iterator\n\t\t\titerator = callable(getIterator).call(arrayLike);\n\t\t\tif (Constructor) arr = new Constructor();\n\t\t\tresult = iterator.next();\n\t\t\ti = 0;\n\t\t\twhile (!result.done) {\n\t\t\t\tvalue = mapFn ? call.call(mapFn, thisArg, result.value, i) : result.value;\n\t\t\t\tif (!Constructor) {\n\t\t\t\t\tarr[i] = value;\n\t\t\t\t} else {\n\t\t\t\t\tdesc.value = value;\n\t\t\t\t\tdefineProperty(arr, i, desc);\n\t\t\t\t}\n\t\t\t\tresult = iterator.next();\n\t\t\t\t++i;\n\t\t\t}\n\t\t\tl = i;\n\t\t} else if (isString(arrayLike)) {\n\t\t\t// Source: String\n\t\t\tl = arrayLike.length;\n\t\t\tif (Constructor) arr = new Constructor();\n\t\t\tfor (i = 0, j = 0; i < l; ++i) {\n\t\t\t\tvalue = arrayLike[i];\n\t\t\t\tif ((i + 1) < l) {\n\t\t\t\t\tcode = value.charCodeAt(0);\n\t\t\t\t\tif ((code >= 0xD800) && (code <= 0xDBFF)) value += arrayLike[++i];\n\t\t\t\t}\n\t\t\t\tvalue = mapFn ? call.call(mapFn, thisArg, value, j) : value;\n\t\t\t\tif (!Constructor) {\n\t\t\t\t\tarr[j] = value;\n\t\t\t\t} else {\n\t\t\t\t\tdesc.value = value;\n\t\t\t\t\tdefineProperty(arr, j, desc);\n\t\t\t\t}\n\t\t\t\t++j;\n\t\t\t}\n\t\t\tl = j;\n\t\t}\n\t}\n\tif (l === undefined) {\n\t\t// Source: array or array-like\n\t\tl = toPosInt(arrayLike.length);\n\t\tif (Constructor) arr = new Constructor(l);\n\t\tfor (i = 0; i < l; ++i) {\n\t\t\tvalue = mapFn ? call.call(mapFn, thisArg, arrayLike[i], i) : arrayLike[i];\n\t\t\tif (!Constructor) {\n\t\t\t\tarr[i] = value;\n\t\t\t} else {\n\t\t\t\tdesc.value = value;\n\t\t\t\tdefineProperty(arr, i, desc);\n\t\t\t}\n\t\t}\n\t}\n\tif (Constructor) {\n\t\tdesc.value = null;\n\t\tarr.length = l;\n\t}\n\treturn arr;\n};\n","'use strict';\n\nmodule.exports = require('./is-implemented')()\n\t? Array.of\n\t: require('./shim');\n","'use strict';\n\nmodule.exports = function () {\n\tvar of = Array.of, result;\n\tif (typeof of !== 'function') return false;\n\tresult = of('foo', 'bar');\n\treturn Boolean(result && (result[1] === 'bar'));\n};\n","'use strict';\n\nvar isFunction = require('../../function/is-function')\n\n  , slice = Array.prototype.slice, defineProperty = Object.defineProperty\n  , desc = { configurable: true, enumerable: true, writable: true, value: null };\n\nmodule.exports = function (/*…items*/) {\n\tvar result, i, l;\n\tif (!this || (this === Array) || !isFunction(this)) return slice.call(arguments);\n\tresult = new this(l = arguments.length);\n\tfor (i = 0; i < l; ++i) {\n\t\tdesc.value = arguments[i];\n\t\tdefineProperty(result, i, desc);\n\t}\n\tdesc.value = null;\n\tresult.length = l;\n\treturn result;\n};\n","'use strict';\n\nvar from = require('./from')\n\n  , isArray = Array.isArray;\n\nmodule.exports = function (arrayLike) {\n\treturn isArray(arrayLike) ? arrayLike : from(arrayLike);\n};\n","'use strict';\n\nvar toString = Object.prototype.toString\n\n  , id = toString.call(new Error());\n\nmodule.exports = function (x) {\n\treturn (x && ((x instanceof Error) || (toString.call(x)) === id)) || false;\n};\n","'use strict';\n\nvar callable     = require('../../object/valid-callable')\n  , aFrom        = require('../../array/from')\n  , defineLength = require('../_define-length')\n\n  , apply = Function.prototype.apply;\n\nmodule.exports = function (/*…args*/) {\n\tvar fn = callable(this)\n\t  , args = aFrom(arguments);\n\n\treturn defineLength(function () {\n\t\treturn apply.call(fn, this, args.concat(aFrom(arguments)));\n\t}, fn.length - args.length);\n};\n","'use strict';\n\nvar callable = require('../../object/valid-callable')\n\n  , apply = Function.prototype.apply;\n\nmodule.exports = function () {\n\tvar fn = callable(this);\n\treturn function (args) { return apply.call(fn, this, args); };\n};\n","'use strict';\n\nvar toPosInt = require('../number/to-pos-integer')\n\n  , test = function (a, b) {}, desc, defineProperty\n  , generate, mixin;\n\ntry {\n\tObject.defineProperty(test, 'length', { configurable: true, writable: false,\n\t\tenumerable: false, value: 1 });\n} catch (ignore) {}\n\nif (test.length === 1) {\n\t// ES6\n\tdesc = { configurable: true, writable: false, enumerable: false };\n\tdefineProperty = Object.defineProperty;\n\tmodule.exports = function (fn, length) {\n\t\tlength = toPosInt(length);\n\t\tif (fn.length === length) return fn;\n\t\tdesc.value = length;\n\t\treturn defineProperty(fn, 'length', desc);\n\t};\n} else {\n\tmixin = require('../object/mixin');\n\tgenerate = (function () {\n\t\tvar cache = [];\n\t\treturn function (l) {\n\t\t\tvar args, i = 0;\n\t\t\tif (cache[l]) return cache[l];\n\t\t\targs = [];\n\t\t\twhile (l--) args.push('a' + (++i).toString(36));\n\t\t\treturn new Function('fn', 'return function (' + args.join(', ') +\n\t\t\t\t') { return fn.apply(this, arguments); };');\n\t\t};\n\t}());\n\tmodule.exports = function (src, length) {\n\t\tvar target;\n\t\tlength = toPosInt(length);\n\t\tif (src.length === length) return src;\n\t\ttarget = generate(length)(src);\n\t\ttry { mixin(target, src); } catch (ignore) {}\n\t\treturn target;\n\t};\n}\n","'use strict';\n\nvar toString = Object.prototype.toString\n\n  , id = toString.call((function () { return arguments; }()));\n\nmodule.exports = function (x) { return (toString.call(x) === id); };\n","'use strict';\n\nvar toString = Object.prototype.toString\n\n  , id = toString.call(require('./noop'));\n\nmodule.exports = function (f) {\n\treturn (typeof f === \"function\") && (toString.call(f) === id);\n};\n","'use strict';\n\nmodule.exports = function () {};\n","'use strict';\n\nvar iteratorSymbol = require('es6-symbol').iterator\n  , isArrayLike    = require('../object/is-array-like');\n\nmodule.exports = function (x) {\n\tif (x == null) return false;\n\tif (typeof x[iteratorSymbol] === 'function') return true;\n\treturn isArrayLike(x);\n};\n","'use strict';\n\nvar isObject = require('../object/is-object')\n  , is       = require('./is');\n\nmodule.exports = function (x) {\n\tif (is(x) && isObject(x)) return x;\n\tthrow new TypeError(x + \" is not an iterable or array-like object\");\n};\n","'use strict';\n\nmodule.exports = require('./is-implemented')()\n\t? Math.sign\n\t: require('./shim');\n","'use strict';\n\nmodule.exports = function () {\n\tvar sign = Math.sign;\n\tif (typeof sign !== 'function') return false;\n\treturn ((sign(10) === 1) && (sign(-20) === -1));\n};\n","'use strict';\n\nmodule.exports = function (value) {\n\tvalue = Number(value);\n\tif (isNaN(value) || (value === 0)) return value;\n\treturn (value > 0) ? 1 : -1;\n};\n","'use strict';\n\nvar sign = require('../math/sign')\n\n  , abs = Math.abs, floor = Math.floor;\n\nmodule.exports = function (value) {\n\tif (isNaN(value)) return 0;\n\tvalue = Number(value);\n\tif ((value === 0) || !isFinite(value)) return value;\n\treturn sign(value) * floor(abs(value));\n};\n","'use strict';\n\nvar toInteger = require('./to-integer')\n\n  , max = Math.max;\n\nmodule.exports = function (value) { return max(0, toInteger(value)); };\n","// Internal method, used by iteration functions.\n// Calls a function for each key-value pair found in object\n// Optionally takes compareFn to iterate object in specific order\n\n'use strict';\n\nvar callable = require('./valid-callable')\n  , value    = require('./valid-value')\n\n  , bind = Function.prototype.bind, call = Function.prototype.call, keys = Object.keys\n  , propertyIsEnumerable = Object.prototype.propertyIsEnumerable;\n\nmodule.exports = function (method, defVal) {\n\treturn function (obj, cb/*, thisArg, compareFn*/) {\n\t\tvar list, thisArg = arguments[2], compareFn = arguments[3];\n\t\tobj = Object(value(obj));\n\t\tcallable(cb);\n\n\t\tlist = keys(obj);\n\t\tif (compareFn) {\n\t\t\tlist.sort((typeof compareFn === 'function') ? bind.call(compareFn, obj) : undefined);\n\t\t}\n\t\tif (typeof method !== 'function') method = list[method];\n\t\treturn call.call(method, list, function (key, index) {\n\t\t\tif (!propertyIsEnumerable.call(obj, key)) return defVal;\n\t\t\treturn call.call(cb, thisArg, obj[key], key, obj, index);\n\t\t});\n\t};\n};\n","'use strict';\n\nmodule.exports = require('./is-implemented')()\n\t? Object.assign\n\t: require('./shim');\n","'use strict';\n\nmodule.exports = function () {\n\tvar assign = Object.assign, obj;\n\tif (typeof assign !== 'function') return false;\n\tobj = { foo: 'raz' };\n\tassign(obj, { bar: 'dwa' }, { trzy: 'trzy' });\n\treturn (obj.foo + obj.bar + obj.trzy) === 'razdwatrzy';\n};\n","'use strict';\n\nvar keys  = require('../keys')\n  , value = require('../valid-value')\n\n  , max = Math.max;\n\nmodule.exports = function (dest, src/*, …srcn*/) {\n\tvar error, i, l = max(arguments.length, 2), assign;\n\tdest = Object(value(dest));\n\tassign = function (key) {\n\t\ttry { dest[key] = src[key]; } catch (e) {\n\t\t\tif (!error) error = e;\n\t\t}\n\t};\n\tfor (i = 1; i < l; ++i) {\n\t\tsrc = arguments[i];\n\t\tkeys(src).forEach(assign);\n\t}\n\tif (error !== undefined) throw error;\n\treturn dest;\n};\n","'use strict';\n\nmodule.exports = require('./_iterate')('forEach');\n","'use strict';\n\nvar isFunction = require('../function/is-function')\n  , isObject   = require('./is-object');\n\nmodule.exports = function (x) {\n\treturn ((x != null) && (typeof x.length === 'number') &&\n\n\t\t// Just checking ((typeof x === 'object') && (typeof x !== 'function'))\n\t\t// won't work right for some cases, e.g.:\n\t\t// type of instance of NodeList in Safari is a 'function'\n\n\t\t((isObject(x) && !isFunction(x)) || (typeof x === \"string\"))) || false;\n};\n","// Deprecated\n\n'use strict';\n\nmodule.exports = function (obj) { return typeof obj === 'function'; };\n","'use strict';\n\nvar map = { function: true, object: true };\n\nmodule.exports = function (x) {\n\treturn ((x != null) && map[typeof x]) || false;\n};\n","'use strict';\n\nmodule.exports = require('./is-implemented')()\n\t? Object.keys\n\t: require('./shim');\n","'use strict';\n\nmodule.exports = function () {\n\ttry {\n\t\tObject.keys('primitive');\n\t\treturn true;\n\t} catch (e) { return false; }\n};\n","'use strict';\n\nvar keys = Object.keys;\n\nmodule.exports = function (object) {\n\treturn keys(object == null ? object : Object(object));\n};\n","'use strict';\n\nvar value = require('./valid-value')\n\n  , defineProperty = Object.defineProperty\n  , getOwnPropertyDescriptor = Object.getOwnPropertyDescriptor\n  , getOwnPropertyNames = Object.getOwnPropertyNames;\n\nmodule.exports = function (target, source) {\n\tvar error;\n\ttarget = Object(value(target));\n\tgetOwnPropertyNames(Object(value(source))).forEach(function (name) {\n\t\ttry {\n\t\t\tdefineProperty(target, name, getOwnPropertyDescriptor(source, name));\n\t\t} catch (e) { error = e; }\n\t});\n\tif (error !== undefined) throw error;\n\treturn target;\n};\n","'use strict';\n\nvar forEach = Array.prototype.forEach, create = Object.create;\n\nvar process = function (src, obj) {\n\tvar key;\n\tfor (key in src) obj[key] = src[key];\n};\n\nmodule.exports = function (options/*, …options*/) {\n\tvar result = create(null);\n\tforEach.call(arguments, function (options) {\n\t\tif (options == null) return;\n\t\tprocess(Object(options), result);\n\t});\n\treturn result;\n};\n","'use strict';\n\nmodule.exports = function (fn) {\n\tif (typeof fn !== 'function') throw new TypeError(fn + \" is not a function\");\n\treturn fn;\n};\n","'use strict';\n\nvar isObject = require('./is-object');\n\nmodule.exports = function (value) {\n\tif (!isObject(value)) throw new TypeError(value + \" is not an Object\");\n\treturn value;\n};\n","'use strict';\n\nmodule.exports = function (value) {\n\tif (value == null) throw new TypeError(\"Cannot use null or undefined\");\n\treturn value;\n};\n","'use strict';\n\nmodule.exports = require('./is-implemented')()\n\t? String.prototype.contains\n\t: require('./shim');\n","'use strict';\n\nvar str = 'razdwatrzy';\n\nmodule.exports = function () {\n\tif (typeof str.contains !== 'function') return false;\n\treturn ((str.contains('dwa') === true) && (str.contains('foo') === false));\n};\n","'use strict';\n\nvar indexOf = String.prototype.indexOf;\n\nmodule.exports = function (searchString/*, position*/) {\n\treturn indexOf.call(this, searchString, arguments[1]) > -1;\n};\n","'use strict';\n\nvar toInteger = require('../../number/to-integer')\n  , value     = require('../../object/valid-value')\n  , repeat    = require('./repeat')\n\n  , abs = Math.abs, max = Math.max;\n\nmodule.exports = function (fill/*, length*/) {\n\tvar self = String(value(this))\n\t  , sLength = self.length\n\t  , length = arguments[1];\n\n\tlength = isNaN(length) ? 1 : toInteger(length);\n\tfill = repeat.call(String(fill), abs(length));\n\tif (length >= 0) return fill.slice(0, max(0, length - sLength)) + self;\n\treturn self + (((sLength + length) >= 0) ? '' : fill.slice(length + sLength));\n};\n","'use strict';\n\nmodule.exports = require('./is-implemented')()\n\t? String.prototype.repeat\n\t: require('./shim');\n","'use strict';\n\nvar str = 'foo';\n\nmodule.exports = function () {\n\tif (typeof str.repeat !== 'function') return false;\n\treturn (str.repeat(2) === 'foofoo');\n};\n","// Thanks: http://www.2ality.com/2014/01/efficient-string-repeat.html\n\n'use strict';\n\nvar value     = require('../../../object/valid-value')\n  , toInteger = require('../../../number/to-integer');\n\nmodule.exports = function (count) {\n\tvar str = String(value(this)), result;\n\tcount = toInteger(count);\n\tif (count < 0) throw new RangeError(\"Count must be >= 0\");\n\tif (!isFinite(count)) throw new RangeError(\"Count must be < ∞\");\n\tresult = '';\n\tif (!count) return result;\n\twhile (true) {\n\t\tif (count & 1) result += str;\n\t\tcount >>>= 1;\n\t\tif (count <= 0) break;\n\t\tstr += str;\n\t}\n\treturn result;\n};\n","'use strict';\n\nvar toString = Object.prototype.toString\n\n  , id = toString.call('');\n\nmodule.exports = function (x) {\n\treturn (typeof x === 'string') || (x && (typeof x === 'object') &&\n\t\t((x instanceof String) || (toString.call(x) === id))) || false;\n};\n","/*!\n * @overview es6-promise - a tiny implementation of Promises/A+.\n * @copyright Copyright (c) 2014 Yehuda Katz, Tom Dale, Stefan Penner and contributors (Conversion to ES6 API by Jake Archibald)\n * @license   Licensed under MIT license\n *            See https://raw.githubusercontent.com/jakearchibald/es6-promise/master/LICENSE\n * @version   3.1.2\n */\n\n(function() {\n    \"use strict\";\n    function lib$es6$promise$utils$$objectOrFunction(x) {\n      return typeof x === 'function' || (typeof x === 'object' && x !== null);\n    }\n\n    function lib$es6$promise$utils$$isFunction(x) {\n      return typeof x === 'function';\n    }\n\n    function lib$es6$promise$utils$$isMaybeThenable(x) {\n      return typeof x === 'object' && x !== null;\n    }\n\n    var lib$es6$promise$utils$$_isArray;\n    if (!Array.isArray) {\n      lib$es6$promise$utils$$_isArray = function (x) {\n        return Object.prototype.toString.call(x) === '[object Array]';\n      };\n    } else {\n      lib$es6$promise$utils$$_isArray = Array.isArray;\n    }\n\n    var lib$es6$promise$utils$$isArray = lib$es6$promise$utils$$_isArray;\n    var lib$es6$promise$asap$$len = 0;\n    var lib$es6$promise$asap$$vertxNext;\n    var lib$es6$promise$asap$$customSchedulerFn;\n\n    var lib$es6$promise$asap$$asap = function asap(callback, arg) {\n      lib$es6$promise$asap$$queue[lib$es6$promise$asap$$len] = callback;\n      lib$es6$promise$asap$$queue[lib$es6$promise$asap$$len + 1] = arg;\n      lib$es6$promise$asap$$len += 2;\n      if (lib$es6$promise$asap$$len === 2) {\n        // If len is 2, that means that we need to schedule an async flush.\n        // If additional callbacks are queued before the queue is flushed, they\n        // will be processed by this flush that we are scheduling.\n        if (lib$es6$promise$asap$$customSchedulerFn) {\n          lib$es6$promise$asap$$customSchedulerFn(lib$es6$promise$asap$$flush);\n        } else {\n          lib$es6$promise$asap$$scheduleFlush();\n        }\n      }\n    }\n\n    function lib$es6$promise$asap$$setScheduler(scheduleFn) {\n      lib$es6$promise$asap$$customSchedulerFn = scheduleFn;\n    }\n\n    function lib$es6$promise$asap$$setAsap(asapFn) {\n      lib$es6$promise$asap$$asap = asapFn;\n    }\n\n    var lib$es6$promise$asap$$browserWindow = (typeof window !== 'undefined') ? window : undefined;\n    var lib$es6$promise$asap$$browserGlobal = lib$es6$promise$asap$$browserWindow || {};\n    var lib$es6$promise$asap$$BrowserMutationObserver = lib$es6$promise$asap$$browserGlobal.MutationObserver || lib$es6$promise$asap$$browserGlobal.WebKitMutationObserver;\n    var lib$es6$promise$asap$$isNode = typeof process !== 'undefined' && {}.toString.call(process) === '[object process]';\n\n    // test for web worker but not in IE10\n    var lib$es6$promise$asap$$isWorker = typeof Uint8ClampedArray !== 'undefined' &&\n      typeof importScripts !== 'undefined' &&\n      typeof MessageChannel !== 'undefined';\n\n    // node\n    function lib$es6$promise$asap$$useNextTick() {\n      // node version 0.10.x displays a deprecation warning when nextTick is used recursively\n      // see https://github.com/cujojs/when/issues/410 for details\n      return function() {\n        process.nextTick(lib$es6$promise$asap$$flush);\n      };\n    }\n\n    // vertx\n    function lib$es6$promise$asap$$useVertxTimer() {\n      return function() {\n        lib$es6$promise$asap$$vertxNext(lib$es6$promise$asap$$flush);\n      };\n    }\n\n    function lib$es6$promise$asap$$useMutationObserver() {\n      var iterations = 0;\n      var observer = new lib$es6$promise$asap$$BrowserMutationObserver(lib$es6$promise$asap$$flush);\n      var node = document.createTextNode('');\n      observer.observe(node, { characterData: true });\n\n      return function() {\n        node.data = (iterations = ++iterations % 2);\n      };\n    }\n\n    // web worker\n    function lib$es6$promise$asap$$useMessageChannel() {\n      var channel = new MessageChannel();\n      channel.port1.onmessage = lib$es6$promise$asap$$flush;\n      return function () {\n        channel.port2.postMessage(0);\n      };\n    }\n\n    function lib$es6$promise$asap$$useSetTimeout() {\n      return function() {\n        setTimeout(lib$es6$promise$asap$$flush, 1);\n      };\n    }\n\n    var lib$es6$promise$asap$$queue = new Array(1000);\n    function lib$es6$promise$asap$$flush() {\n      for (var i = 0; i < lib$es6$promise$asap$$len; i+=2) {\n        var callback = lib$es6$promise$asap$$queue[i];\n        var arg = lib$es6$promise$asap$$queue[i+1];\n\n        callback(arg);\n\n        lib$es6$promise$asap$$queue[i] = undefined;\n        lib$es6$promise$asap$$queue[i+1] = undefined;\n      }\n\n      lib$es6$promise$asap$$len = 0;\n    }\n\n    function lib$es6$promise$asap$$attemptVertx() {\n      try {\n        var r = require;\n        var vertx = r('vertx');\n        lib$es6$promise$asap$$vertxNext = vertx.runOnLoop || vertx.runOnContext;\n        return lib$es6$promise$asap$$useVertxTimer();\n      } catch(e) {\n        return lib$es6$promise$asap$$useSetTimeout();\n      }\n    }\n\n    var lib$es6$promise$asap$$scheduleFlush;\n    // Decide what async method to use to triggering processing of queued callbacks:\n    if (lib$es6$promise$asap$$isNode) {\n      lib$es6$promise$asap$$scheduleFlush = lib$es6$promise$asap$$useNextTick();\n    } else if (lib$es6$promise$asap$$BrowserMutationObserver) {\n      lib$es6$promise$asap$$scheduleFlush = lib$es6$promise$asap$$useMutationObserver();\n    } else if (lib$es6$promise$asap$$isWorker) {\n      lib$es6$promise$asap$$scheduleFlush = lib$es6$promise$asap$$useMessageChannel();\n    } else if (lib$es6$promise$asap$$browserWindow === undefined && typeof require === 'function') {\n      lib$es6$promise$asap$$scheduleFlush = lib$es6$promise$asap$$attemptVertx();\n    } else {\n      lib$es6$promise$asap$$scheduleFlush = lib$es6$promise$asap$$useSetTimeout();\n    }\n    function lib$es6$promise$then$$then(onFulfillment, onRejection) {\n      var parent = this;\n      var state = parent._state;\n\n      if (state === lib$es6$promise$$internal$$FULFILLED && !onFulfillment || state === lib$es6$promise$$internal$$REJECTED && !onRejection) {\n        return this;\n      }\n\n      var child = new this.constructor(lib$es6$promise$$internal$$noop);\n      var result = parent._result;\n\n      if (state) {\n        var callback = arguments[state - 1];\n        lib$es6$promise$asap$$asap(function(){\n          lib$es6$promise$$internal$$invokeCallback(state, child, callback, result);\n        });\n      } else {\n        lib$es6$promise$$internal$$subscribe(parent, child, onFulfillment, onRejection);\n      }\n\n      return child;\n    }\n    var lib$es6$promise$then$$default = lib$es6$promise$then$$then;\n    function lib$es6$promise$promise$resolve$$resolve(object) {\n      /*jshint validthis:true */\n      var Constructor = this;\n\n      if (object && typeof object === 'object' && object.constructor === Constructor) {\n        return object;\n      }\n\n      var promise = new Constructor(lib$es6$promise$$internal$$noop);\n      lib$es6$promise$$internal$$resolve(promise, object);\n      return promise;\n    }\n    var lib$es6$promise$promise$resolve$$default = lib$es6$promise$promise$resolve$$resolve;\n\n    function lib$es6$promise$$internal$$noop() {}\n\n    var lib$es6$promise$$internal$$PENDING   = void 0;\n    var lib$es6$promise$$internal$$FULFILLED = 1;\n    var lib$es6$promise$$internal$$REJECTED  = 2;\n\n    var lib$es6$promise$$internal$$GET_THEN_ERROR = new lib$es6$promise$$internal$$ErrorObject();\n\n    function lib$es6$promise$$internal$$selfFulfillment() {\n      return new TypeError(\"You cannot resolve a promise with itself\");\n    }\n\n    function lib$es6$promise$$internal$$cannotReturnOwn() {\n      return new TypeError('A promises callback cannot return that same promise.');\n    }\n\n    function lib$es6$promise$$internal$$getThen(promise) {\n      try {\n        return promise.then;\n      } catch(error) {\n        lib$es6$promise$$internal$$GET_THEN_ERROR.error = error;\n        return lib$es6$promise$$internal$$GET_THEN_ERROR;\n      }\n    }\n\n    function lib$es6$promise$$internal$$tryThen(then, value, fulfillmentHandler, rejectionHandler) {\n      try {\n        then.call(value, fulfillmentHandler, rejectionHandler);\n      } catch(e) {\n        return e;\n      }\n    }\n\n    function lib$es6$promise$$internal$$handleForeignThenable(promise, thenable, then) {\n       lib$es6$promise$asap$$asap(function(promise) {\n        var sealed = false;\n        var error = lib$es6$promise$$internal$$tryThen(then, thenable, function(value) {\n          if (sealed) { return; }\n          sealed = true;\n          if (thenable !== value) {\n            lib$es6$promise$$internal$$resolve(promise, value);\n          } else {\n            lib$es6$promise$$internal$$fulfill(promise, value);\n          }\n        }, function(reason) {\n          if (sealed) { return; }\n          sealed = true;\n\n          lib$es6$promise$$internal$$reject(promise, reason);\n        }, 'Settle: ' + (promise._label || ' unknown promise'));\n\n        if (!sealed && error) {\n          sealed = true;\n          lib$es6$promise$$internal$$reject(promise, error);\n        }\n      }, promise);\n    }\n\n    function lib$es6$promise$$internal$$handleOwnThenable(promise, thenable) {\n      if (thenable._state === lib$es6$promise$$internal$$FULFILLED) {\n        lib$es6$promise$$internal$$fulfill(promise, thenable._result);\n      } else if (thenable._state === lib$es6$promise$$internal$$REJECTED) {\n        lib$es6$promise$$internal$$reject(promise, thenable._result);\n      } else {\n        lib$es6$promise$$internal$$subscribe(thenable, undefined, function(value) {\n          lib$es6$promise$$internal$$resolve(promise, value);\n        }, function(reason) {\n          lib$es6$promise$$internal$$reject(promise, reason);\n        });\n      }\n    }\n\n    function lib$es6$promise$$internal$$handleMaybeThenable(promise, maybeThenable, then) {\n      if (maybeThenable.constructor === promise.constructor &&\n          then === lib$es6$promise$then$$default &&\n          constructor.resolve === lib$es6$promise$promise$resolve$$default) {\n        lib$es6$promise$$internal$$handleOwnThenable(promise, maybeThenable);\n      } else {\n        if (then === lib$es6$promise$$internal$$GET_THEN_ERROR) {\n          lib$es6$promise$$internal$$reject(promise, lib$es6$promise$$internal$$GET_THEN_ERROR.error);\n        } else if (then === undefined) {\n          lib$es6$promise$$internal$$fulfill(promise, maybeThenable);\n        } else if (lib$es6$promise$utils$$isFunction(then)) {\n          lib$es6$promise$$internal$$handleForeignThenable(promise, maybeThenable, then);\n        } else {\n          lib$es6$promise$$internal$$fulfill(promise, maybeThenable);\n        }\n      }\n    }\n\n    function lib$es6$promise$$internal$$resolve(promise, value) {\n      if (promise === value) {\n        lib$es6$promise$$internal$$reject(promise, lib$es6$promise$$internal$$selfFulfillment());\n      } else if (lib$es6$promise$utils$$objectOrFunction(value)) {\n        lib$es6$promise$$internal$$handleMaybeThenable(promise, value, lib$es6$promise$$internal$$getThen(value));\n      } else {\n        lib$es6$promise$$internal$$fulfill(promise, value);\n      }\n    }\n\n    function lib$es6$promise$$internal$$publishRejection(promise) {\n      if (promise._onerror) {\n        promise._onerror(promise._result);\n      }\n\n      lib$es6$promise$$internal$$publish(promise);\n    }\n\n    function lib$es6$promise$$internal$$fulfill(promise, value) {\n      if (promise._state !== lib$es6$promise$$internal$$PENDING) { return; }\n\n      promise._result = value;\n      promise._state = lib$es6$promise$$internal$$FULFILLED;\n\n      if (promise._subscribers.length !== 0) {\n        lib$es6$promise$asap$$asap(lib$es6$promise$$internal$$publish, promise);\n      }\n    }\n\n    function lib$es6$promise$$internal$$reject(promise, reason) {\n      if (promise._state !== lib$es6$promise$$internal$$PENDING) { return; }\n      promise._state = lib$es6$promise$$internal$$REJECTED;\n      promise._result = reason;\n\n      lib$es6$promise$asap$$asap(lib$es6$promise$$internal$$publishRejection, promise);\n    }\n\n    function lib$es6$promise$$internal$$subscribe(parent, child, onFulfillment, onRejection) {\n      var subscribers = parent._subscribers;\n      var length = subscribers.length;\n\n      parent._onerror = null;\n\n      subscribers[length] = child;\n      subscribers[length + lib$es6$promise$$internal$$FULFILLED] = onFulfillment;\n      subscribers[length + lib$es6$promise$$internal$$REJECTED]  = onRejection;\n\n      if (length === 0 && parent._state) {\n        lib$es6$promise$asap$$asap(lib$es6$promise$$internal$$publish, parent);\n      }\n    }\n\n    function lib$es6$promise$$internal$$publish(promise) {\n      var subscribers = promise._subscribers;\n      var settled = promise._state;\n\n      if (subscribers.length === 0) { return; }\n\n      var child, callback, detail = promise._result;\n\n      for (var i = 0; i < subscribers.length; i += 3) {\n        child = subscribers[i];\n        callback = subscribers[i + settled];\n\n        if (child) {\n          lib$es6$promise$$internal$$invokeCallback(settled, child, callback, detail);\n        } else {\n          callback(detail);\n        }\n      }\n\n      promise._subscribers.length = 0;\n    }\n\n    function lib$es6$promise$$internal$$ErrorObject() {\n      this.error = null;\n    }\n\n    var lib$es6$promise$$internal$$TRY_CATCH_ERROR = new lib$es6$promise$$internal$$ErrorObject();\n\n    function lib$es6$promise$$internal$$tryCatch(callback, detail) {\n      try {\n        return callback(detail);\n      } catch(e) {\n        lib$es6$promise$$internal$$TRY_CATCH_ERROR.error = e;\n        return lib$es6$promise$$internal$$TRY_CATCH_ERROR;\n      }\n    }\n\n    function lib$es6$promise$$internal$$invokeCallback(settled, promise, callback, detail) {\n      var hasCallback = lib$es6$promise$utils$$isFunction(callback),\n          value, error, succeeded, failed;\n\n      if (hasCallback) {\n        value = lib$es6$promise$$internal$$tryCatch(callback, detail);\n\n        if (value === lib$es6$promise$$internal$$TRY_CATCH_ERROR) {\n          failed = true;\n          error = value.error;\n          value = null;\n        } else {\n          succeeded = true;\n        }\n\n        if (promise === value) {\n          lib$es6$promise$$internal$$reject(promise, lib$es6$promise$$internal$$cannotReturnOwn());\n          return;\n        }\n\n      } else {\n        value = detail;\n        succeeded = true;\n      }\n\n      if (promise._state !== lib$es6$promise$$internal$$PENDING) {\n        // noop\n      } else if (hasCallback && succeeded) {\n        lib$es6$promise$$internal$$resolve(promise, value);\n      } else if (failed) {\n        lib$es6$promise$$internal$$reject(promise, error);\n      } else if (settled === lib$es6$promise$$internal$$FULFILLED) {\n        lib$es6$promise$$internal$$fulfill(promise, value);\n      } else if (settled === lib$es6$promise$$internal$$REJECTED) {\n        lib$es6$promise$$internal$$reject(promise, value);\n      }\n    }\n\n    function lib$es6$promise$$internal$$initializePromise(promise, resolver) {\n      try {\n        resolver(function resolvePromise(value){\n          lib$es6$promise$$internal$$resolve(promise, value);\n        }, function rejectPromise(reason) {\n          lib$es6$promise$$internal$$reject(promise, reason);\n        });\n      } catch(e) {\n        lib$es6$promise$$internal$$reject(promise, e);\n      }\n    }\n\n    function lib$es6$promise$promise$all$$all(entries) {\n      return new lib$es6$promise$enumerator$$default(this, entries).promise;\n    }\n    var lib$es6$promise$promise$all$$default = lib$es6$promise$promise$all$$all;\n    function lib$es6$promise$promise$race$$race(entries) {\n      /*jshint validthis:true */\n      var Constructor = this;\n\n      var promise = new Constructor(lib$es6$promise$$internal$$noop);\n\n      if (!lib$es6$promise$utils$$isArray(entries)) {\n        lib$es6$promise$$internal$$reject(promise, new TypeError('You must pass an array to race.'));\n        return promise;\n      }\n\n      var length = entries.length;\n\n      function onFulfillment(value) {\n        lib$es6$promise$$internal$$resolve(promise, value);\n      }\n\n      function onRejection(reason) {\n        lib$es6$promise$$internal$$reject(promise, reason);\n      }\n\n      for (var i = 0; promise._state === lib$es6$promise$$internal$$PENDING && i < length; i++) {\n        lib$es6$promise$$internal$$subscribe(Constructor.resolve(entries[i]), undefined, onFulfillment, onRejection);\n      }\n\n      return promise;\n    }\n    var lib$es6$promise$promise$race$$default = lib$es6$promise$promise$race$$race;\n    function lib$es6$promise$promise$reject$$reject(reason) {\n      /*jshint validthis:true */\n      var Constructor = this;\n      var promise = new Constructor(lib$es6$promise$$internal$$noop);\n      lib$es6$promise$$internal$$reject(promise, reason);\n      return promise;\n    }\n    var lib$es6$promise$promise$reject$$default = lib$es6$promise$promise$reject$$reject;\n\n    var lib$es6$promise$promise$$counter = 0;\n\n    function lib$es6$promise$promise$$needsResolver() {\n      throw new TypeError('You must pass a resolver function as the first argument to the promise constructor');\n    }\n\n    function lib$es6$promise$promise$$needsNew() {\n      throw new TypeError(\"Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.\");\n    }\n\n    var lib$es6$promise$promise$$default = lib$es6$promise$promise$$Promise;\n    /**\n      Promise objects represent the eventual result of an asynchronous operation. The\n      primary way of interacting with a promise is through its `then` method, which\n      registers callbacks to receive either a promise's eventual value or the reason\n      why the promise cannot be fulfilled.\n\n      Terminology\n      -----------\n\n      - `promise` is an object or function with a `then` method whose behavior conforms to this specification.\n      - `thenable` is an object or function that defines a `then` method.\n      - `value` is any legal JavaScript value (including undefined, a thenable, or a promise).\n      - `exception` is a value that is thrown using the throw statement.\n      - `reason` is a value that indicates why a promise was rejected.\n      - `settled` the final resting state of a promise, fulfilled or rejected.\n\n      A promise can be in one of three states: pending, fulfilled, or rejected.\n\n      Promises that are fulfilled have a fulfillment value and are in the fulfilled\n      state.  Promises that are rejected have a rejection reason and are in the\n      rejected state.  A fulfillment value is never a thenable.\n\n      Promises can also be said to *resolve* a value.  If this value is also a\n      promise, then the original promise's settled state will match the value's\n      settled state.  So a promise that *resolves* a promise that rejects will\n      itself reject, and a promise that *resolves* a promise that fulfills will\n      itself fulfill.\n\n\n      Basic Usage:\n      ------------\n\n      ```js\n      var promise = new Promise(function(resolve, reject) {\n        // on success\n        resolve(value);\n\n        // on failure\n        reject(reason);\n      });\n\n      promise.then(function(value) {\n        // on fulfillment\n      }, function(reason) {\n        // on rejection\n      });\n      ```\n\n      Advanced Usage:\n      ---------------\n\n      Promises shine when abstracting away asynchronous interactions such as\n      `XMLHttpRequest`s.\n\n      ```js\n      function getJSON(url) {\n        return new Promise(function(resolve, reject){\n          var xhr = new XMLHttpRequest();\n\n          xhr.open('GET', url);\n          xhr.onreadystatechange = handler;\n          xhr.responseType = 'json';\n          xhr.setRequestHeader('Accept', 'application/json');\n          xhr.send();\n\n          function handler() {\n            if (this.readyState === this.DONE) {\n              if (this.status === 200) {\n                resolve(this.response);\n              } else {\n                reject(new Error('getJSON: `' + url + '` failed with status: [' + this.status + ']'));\n              }\n            }\n          };\n        });\n      }\n\n      getJSON('/posts.json').then(function(json) {\n        // on fulfillment\n      }, function(reason) {\n        // on rejection\n      });\n      ```\n\n      Unlike callbacks, promises are great composable primitives.\n\n      ```js\n      Promise.all([\n        getJSON('/posts'),\n        getJSON('/comments')\n      ]).then(function(values){\n        values[0] // => postsJSON\n        values[1] // => commentsJSON\n\n        return values;\n      });\n      ```\n\n      @class Promise\n      @param {function} resolver\n      Useful for tooling.\n      @constructor\n    */\n    function lib$es6$promise$promise$$Promise(resolver) {\n      this._id = lib$es6$promise$promise$$counter++;\n      this._state = undefined;\n      this._result = undefined;\n      this._subscribers = [];\n\n      if (lib$es6$promise$$internal$$noop !== resolver) {\n        typeof resolver !== 'function' && lib$es6$promise$promise$$needsResolver();\n        this instanceof lib$es6$promise$promise$$Promise ? lib$es6$promise$$internal$$initializePromise(this, resolver) : lib$es6$promise$promise$$needsNew();\n      }\n    }\n\n    lib$es6$promise$promise$$Promise.all = lib$es6$promise$promise$all$$default;\n    lib$es6$promise$promise$$Promise.race = lib$es6$promise$promise$race$$default;\n    lib$es6$promise$promise$$Promise.resolve = lib$es6$promise$promise$resolve$$default;\n    lib$es6$promise$promise$$Promise.reject = lib$es6$promise$promise$reject$$default;\n    lib$es6$promise$promise$$Promise._setScheduler = lib$es6$promise$asap$$setScheduler;\n    lib$es6$promise$promise$$Promise._setAsap = lib$es6$promise$asap$$setAsap;\n    lib$es6$promise$promise$$Promise._asap = lib$es6$promise$asap$$asap;\n\n    lib$es6$promise$promise$$Promise.prototype = {\n      constructor: lib$es6$promise$promise$$Promise,\n\n    /**\n      The primary way of interacting with a promise is through its `then` method,\n      which registers callbacks to receive either a promise's eventual value or the\n      reason why the promise cannot be fulfilled.\n\n      ```js\n      findUser().then(function(user){\n        // user is available\n      }, function(reason){\n        // user is unavailable, and you are given the reason why\n      });\n      ```\n\n      Chaining\n      --------\n\n      The return value of `then` is itself a promise.  This second, 'downstream'\n      promise is resolved with the return value of the first promise's fulfillment\n      or rejection handler, or rejected if the handler throws an exception.\n\n      ```js\n      findUser().then(function (user) {\n        return user.name;\n      }, function (reason) {\n        return 'default name';\n      }).then(function (userName) {\n        // If `findUser` fulfilled, `userName` will be the user's name, otherwise it\n        // will be `'default name'`\n      });\n\n      findUser().then(function (user) {\n        throw new Error('Found user, but still unhappy');\n      }, function (reason) {\n        throw new Error('`findUser` rejected and we're unhappy');\n      }).then(function (value) {\n        // never reached\n      }, function (reason) {\n        // if `findUser` fulfilled, `reason` will be 'Found user, but still unhappy'.\n        // If `findUser` rejected, `reason` will be '`findUser` rejected and we're unhappy'.\n      });\n      ```\n      If the downstream promise does not specify a rejection handler, rejection reasons will be propagated further downstream.\n\n      ```js\n      findUser().then(function (user) {\n        throw new PedagogicalException('Upstream error');\n      }).then(function (value) {\n        // never reached\n      }).then(function (value) {\n        // never reached\n      }, function (reason) {\n        // The `PedgagocialException` is propagated all the way down to here\n      });\n      ```\n\n      Assimilation\n      ------------\n\n      Sometimes the value you want to propagate to a downstream promise can only be\n      retrieved asynchronously. This can be achieved by returning a promise in the\n      fulfillment or rejection handler. The downstream promise will then be pending\n      until the returned promise is settled. This is called *assimilation*.\n\n      ```js\n      findUser().then(function (user) {\n        return findCommentsByAuthor(user);\n      }).then(function (comments) {\n        // The user's comments are now available\n      });\n      ```\n\n      If the assimliated promise rejects, then the downstream promise will also reject.\n\n      ```js\n      findUser().then(function (user) {\n        return findCommentsByAuthor(user);\n      }).then(function (comments) {\n        // If `findCommentsByAuthor` fulfills, we'll have the value here\n      }, function (reason) {\n        // If `findCommentsByAuthor` rejects, we'll have the reason here\n      });\n      ```\n\n      Simple Example\n      --------------\n\n      Synchronous Example\n\n      ```javascript\n      var result;\n\n      try {\n        result = findResult();\n        // success\n      } catch(reason) {\n        // failure\n      }\n      ```\n\n      Errback Example\n\n      ```js\n      findResult(function(result, err){\n        if (err) {\n          // failure\n        } else {\n          // success\n        }\n      });\n      ```\n\n      Promise Example;\n\n      ```javascript\n      findResult().then(function(result){\n        // success\n      }, function(reason){\n        // failure\n      });\n      ```\n\n      Advanced Example\n      --------------\n\n      Synchronous Example\n\n      ```javascript\n      var author, books;\n\n      try {\n        author = findAuthor();\n        books  = findBooksByAuthor(author);\n        // success\n      } catch(reason) {\n        // failure\n      }\n      ```\n\n      Errback Example\n\n      ```js\n\n      function foundBooks(books) {\n\n      }\n\n      function failure(reason) {\n\n      }\n\n      findAuthor(function(author, err){\n        if (err) {\n          failure(err);\n          // failure\n        } else {\n          try {\n            findBoooksByAuthor(author, function(books, err) {\n              if (err) {\n                failure(err);\n              } else {\n                try {\n                  foundBooks(books);\n                } catch(reason) {\n                  failure(reason);\n                }\n              }\n            });\n          } catch(error) {\n            failure(err);\n          }\n          // success\n        }\n      });\n      ```\n\n      Promise Example;\n\n      ```javascript\n      findAuthor().\n        then(findBooksByAuthor).\n        then(function(books){\n          // found books\n      }).catch(function(reason){\n        // something went wrong\n      });\n      ```\n\n      @method then\n      @param {Function} onFulfilled\n      @param {Function} onRejected\n      Useful for tooling.\n      @return {Promise}\n    */\n      then: lib$es6$promise$then$$default,\n\n    /**\n      `catch` is simply sugar for `then(undefined, onRejection)` which makes it the same\n      as the catch block of a try/catch statement.\n\n      ```js\n      function findAuthor(){\n        throw new Error('couldn't find that author');\n      }\n\n      // synchronous\n      try {\n        findAuthor();\n      } catch(reason) {\n        // something went wrong\n      }\n\n      // async with promises\n      findAuthor().catch(function(reason){\n        // something went wrong\n      });\n      ```\n\n      @method catch\n      @param {Function} onRejection\n      Useful for tooling.\n      @return {Promise}\n    */\n      'catch': function(onRejection) {\n        return this.then(null, onRejection);\n      }\n    };\n    var lib$es6$promise$enumerator$$default = lib$es6$promise$enumerator$$Enumerator;\n    function lib$es6$promise$enumerator$$Enumerator(Constructor, input) {\n      this._instanceConstructor = Constructor;\n      this.promise = new Constructor(lib$es6$promise$$internal$$noop);\n\n      if (Array.isArray(input)) {\n        this._input     = input;\n        this.length     = input.length;\n        this._remaining = input.length;\n\n        this._result = new Array(this.length);\n\n        if (this.length === 0) {\n          lib$es6$promise$$internal$$fulfill(this.promise, this._result);\n        } else {\n          this.length = this.length || 0;\n          this._enumerate();\n          if (this._remaining === 0) {\n            lib$es6$promise$$internal$$fulfill(this.promise, this._result);\n          }\n        }\n      } else {\n        lib$es6$promise$$internal$$reject(this.promise, this._validationError());\n      }\n    }\n\n    lib$es6$promise$enumerator$$Enumerator.prototype._validationError = function() {\n      return new Error('Array Methods must be provided an Array');\n    };\n\n    lib$es6$promise$enumerator$$Enumerator.prototype._enumerate = function() {\n      var length  = this.length;\n      var input   = this._input;\n\n      for (var i = 0; this._state === lib$es6$promise$$internal$$PENDING && i < length; i++) {\n        this._eachEntry(input[i], i);\n      }\n    };\n\n    lib$es6$promise$enumerator$$Enumerator.prototype._eachEntry = function(entry, i) {\n      var c = this._instanceConstructor;\n      var resolve = c.resolve;\n\n      if (resolve === lib$es6$promise$promise$resolve$$default) {\n        var then = lib$es6$promise$$internal$$getThen(entry);\n\n        if (then === lib$es6$promise$then$$default &&\n            entry._state !== lib$es6$promise$$internal$$PENDING) {\n          this._settledAt(entry._state, i, entry._result);\n        } else if (typeof then !== 'function') {\n          this._remaining--;\n          this._result[i] = entry;\n        } else if (c === lib$es6$promise$promise$$default) {\n          var promise = new c(lib$es6$promise$$internal$$noop);\n          lib$es6$promise$$internal$$handleMaybeThenable(promise, entry, then);\n          this._willSettleAt(promise, i);\n        } else {\n          this._willSettleAt(new c(function(resolve) { resolve(entry); }), i);\n        }\n      } else {\n        this._willSettleAt(resolve(entry), i);\n      }\n    };\n\n    lib$es6$promise$enumerator$$Enumerator.prototype._settledAt = function(state, i, value) {\n      var promise = this.promise;\n\n      if (promise._state === lib$es6$promise$$internal$$PENDING) {\n        this._remaining--;\n\n        if (state === lib$es6$promise$$internal$$REJECTED) {\n          lib$es6$promise$$internal$$reject(promise, value);\n        } else {\n          this._result[i] = value;\n        }\n      }\n\n      if (this._remaining === 0) {\n        lib$es6$promise$$internal$$fulfill(promise, this._result);\n      }\n    };\n\n    lib$es6$promise$enumerator$$Enumerator.prototype._willSettleAt = function(promise, i) {\n      var enumerator = this;\n\n      lib$es6$promise$$internal$$subscribe(promise, undefined, function(value) {\n        enumerator._settledAt(lib$es6$promise$$internal$$FULFILLED, i, value);\n      }, function(reason) {\n        enumerator._settledAt(lib$es6$promise$$internal$$REJECTED, i, reason);\n      });\n    };\n    function lib$es6$promise$polyfill$$polyfill() {\n      var local;\n\n      if (typeof global !== 'undefined') {\n          local = global;\n      } else if (typeof self !== 'undefined') {\n          local = self;\n      } else {\n          try {\n              local = Function('return this')();\n          } catch (e) {\n              throw new Error('polyfill failed because global object is unavailable in this environment');\n          }\n      }\n\n      var P = local.Promise;\n\n      if (P && Object.prototype.toString.call(P.resolve()) === '[object Promise]' && !P.cast) {\n        return;\n      }\n\n      local.Promise = lib$es6$promise$promise$$default;\n    }\n    var lib$es6$promise$polyfill$$default = lib$es6$promise$polyfill$$polyfill;\n\n    var lib$es6$promise$umd$$ES6Promise = {\n      'Promise': lib$es6$promise$promise$$default,\n      'polyfill': lib$es6$promise$polyfill$$default\n    };\n\n    /* global define:true module:true window: true */\n    if (typeof define === 'function' && define['amd']) {\n      define(function() { return lib$es6$promise$umd$$ES6Promise; });\n    } else if (typeof module !== 'undefined' && module['exports']) {\n      module['exports'] = lib$es6$promise$umd$$ES6Promise;\n    } else if (typeof this !== 'undefined') {\n      this['ES6Promise'] = lib$es6$promise$umd$$ES6Promise;\n    }\n\n    lib$es6$promise$polyfill$$default();\n}).call(this);\n\n","'use strict';\n\nmodule.exports = require('./is-implemented')() ? Symbol : require('./polyfill');\n","'use strict';\n\nmodule.exports = function () {\n\tvar symbol;\n\tif (typeof Symbol !== 'function') return false;\n\tsymbol = Symbol('test symbol');\n\ttry { String(symbol); } catch (e) { return false; }\n\tif (typeof Symbol.iterator === 'symbol') return true;\n\n\t// Return 'true' for polyfills\n\tif (typeof Symbol.isConcatSpreadable !== 'object') return false;\n\tif (typeof Symbol.iterator !== 'object') return false;\n\tif (typeof Symbol.toPrimitive !== 'object') return false;\n\tif (typeof Symbol.toStringTag !== 'object') return false;\n\tif (typeof Symbol.unscopables !== 'object') return false;\n\n\treturn true;\n};\n","'use strict';\n\nmodule.exports = function (x) {\n\treturn (x && ((typeof x === 'symbol') || (x['@@toStringTag'] === 'Symbol'))) || false;\n};\n","// ES2015 Symbol polyfill for environments that do not support it (or partially support it_\n\n'use strict';\n\nvar d              = require('d')\n  , validateSymbol = require('./validate-symbol')\n\n  , create = Object.create, defineProperties = Object.defineProperties\n  , defineProperty = Object.defineProperty, objPrototype = Object.prototype\n  , NativeSymbol, SymbolPolyfill, HiddenSymbol, globalSymbols = create(null);\n\nif (typeof Symbol === 'function') NativeSymbol = Symbol;\n\nvar generateName = (function () {\n\tvar created = create(null);\n\treturn function (desc) {\n\t\tvar postfix = 0, name, ie11BugWorkaround;\n\t\twhile (created[desc + (postfix || '')]) ++postfix;\n\t\tdesc += (postfix || '');\n\t\tcreated[desc] = true;\n\t\tname = '@@' + desc;\n\t\tdefineProperty(objPrototype, name, d.gs(null, function (value) {\n\t\t\t// For IE11 issue see:\n\t\t\t// https://connect.microsoft.com/IE/feedbackdetail/view/1928508/\n\t\t\t//    ie11-broken-getters-on-dom-objects\n\t\t\t// https://github.com/medikoo/es6-symbol/issues/12\n\t\t\tif (ie11BugWorkaround) return;\n\t\t\tie11BugWorkaround = true;\n\t\t\tdefineProperty(this, name, d(value));\n\t\t\tie11BugWorkaround = false;\n\t\t}));\n\t\treturn name;\n\t};\n}());\n\n// Internal constructor (not one exposed) for creating Symbol instances.\n// This one is used to ensure that `someSymbol instanceof Symbol` always return false\nHiddenSymbol = function Symbol(description) {\n\tif (this instanceof HiddenSymbol) throw new TypeError('TypeError: Symbol is not a constructor');\n\treturn SymbolPolyfill(description);\n};\n\n// Exposed `Symbol` constructor\n// (returns instances of HiddenSymbol)\nmodule.exports = SymbolPolyfill = function Symbol(description) {\n\tvar symbol;\n\tif (this instanceof Symbol) throw new TypeError('TypeError: Symbol is not a constructor');\n\tsymbol = create(HiddenSymbol.prototype);\n\tdescription = (description === undefined ? '' : String(description));\n\treturn defineProperties(symbol, {\n\t\t__description__: d('', description),\n\t\t__name__: d('', generateName(description))\n\t});\n};\ndefineProperties(SymbolPolyfill, {\n\tfor: d(function (key) {\n\t\tif (globalSymbols[key]) return globalSymbols[key];\n\t\treturn (globalSymbols[key] = SymbolPolyfill(String(key)));\n\t}),\n\tkeyFor: d(function (s) {\n\t\tvar key;\n\t\tvalidateSymbol(s);\n\t\tfor (key in globalSymbols) if (globalSymbols[key] === s) return key;\n\t}),\n\n\t// If there's native implementation of given symbol, let's fallback to it\n\t// to ensure proper interoperability with other native functions e.g. Array.from\n\thasInstance: d('', (NativeSymbol && NativeSymbol.hasInstance) || SymbolPolyfill('hasInstance')),\n\tisConcatSpreadable: d('', (NativeSymbol && NativeSymbol.isConcatSpreadable) ||\n\t\tSymbolPolyfill('isConcatSpreadable')),\n\titerator: d('', (NativeSymbol && NativeSymbol.iterator) || SymbolPolyfill('iterator')),\n\tmatch: d('', (NativeSymbol && NativeSymbol.match) || SymbolPolyfill('match')),\n\treplace: d('', (NativeSymbol && NativeSymbol.replace) || SymbolPolyfill('replace')),\n\tsearch: d('', (NativeSymbol && NativeSymbol.search) || SymbolPolyfill('search')),\n\tspecies: d('', (NativeSymbol && NativeSymbol.species) || SymbolPolyfill('species')),\n\tsplit: d('', (NativeSymbol && NativeSymbol.split) || SymbolPolyfill('split')),\n\ttoPrimitive: d('', (NativeSymbol && NativeSymbol.toPrimitive) || SymbolPolyfill('toPrimitive')),\n\ttoStringTag: d('', (NativeSymbol && NativeSymbol.toStringTag) || SymbolPolyfill('toStringTag')),\n\tunscopables: d('', (NativeSymbol && NativeSymbol.unscopables) || SymbolPolyfill('unscopables'))\n});\n\n// Internal tweaks for real symbol producer\ndefineProperties(HiddenSymbol.prototype, {\n\tconstructor: d(SymbolPolyfill),\n\ttoString: d('', function () { return this.__name__; })\n});\n\n// Proper implementation of methods exposed on Symbol.prototype\n// They won't be accessible on produced symbol instances as they derive from HiddenSymbol.prototype\ndefineProperties(SymbolPolyfill.prototype, {\n\ttoString: d(function () { return 'Symbol (' + validateSymbol(this).__description__ + ')'; }),\n\tvalueOf: d(function () { return validateSymbol(this); })\n});\ndefineProperty(SymbolPolyfill.prototype, SymbolPolyfill.toPrimitive, d('',\n\tfunction () { return validateSymbol(this); }));\ndefineProperty(SymbolPolyfill.prototype, SymbolPolyfill.toStringTag, d('c', 'Symbol'));\n\n// Proper implementaton of toPrimitive and toStringTag for returned symbol instances\ndefineProperty(HiddenSymbol.prototype, SymbolPolyfill.toStringTag,\n\td('c', SymbolPolyfill.prototype[SymbolPolyfill.toStringTag]));\n\n// Note: It's important to define `toPrimitive` as last one, as some implementations\n// implement `toPrimitive` natively without implementing `toStringTag` (or other specified symbols)\n// And that may invoke error in definition flow:\n// See: https://github.com/medikoo/es6-symbol/issues/13#issuecomment-164146149\ndefineProperty(HiddenSymbol.prototype, SymbolPolyfill.toPrimitive,\n\td('c', SymbolPolyfill.prototype[SymbolPolyfill.toPrimitive]));\n","'use strict';\n\nvar isSymbol = require('./is-symbol');\n\nmodule.exports = function (value) {\n\tif (!isSymbol(value)) throw new TypeError(value + \" is not a symbol\");\n\treturn value;\n};\n","'use strict';\n\nvar d        = require('d')\n  , callable = require('es5-ext/object/valid-callable')\n\n  , apply = Function.prototype.apply, call = Function.prototype.call\n  , create = Object.create, defineProperty = Object.defineProperty\n  , defineProperties = Object.defineProperties\n  , hasOwnProperty = Object.prototype.hasOwnProperty\n  , descriptor = { configurable: true, enumerable: false, writable: true }\n\n  , on, once, off, emit, methods, descriptors, base;\n\non = function (type, listener) {\n\tvar data;\n\n\tcallable(listener);\n\n\tif (!hasOwnProperty.call(this, '__ee__')) {\n\t\tdata = descriptor.value = create(null);\n\t\tdefineProperty(this, '__ee__', descriptor);\n\t\tdescriptor.value = null;\n\t} else {\n\t\tdata = this.__ee__;\n\t}\n\tif (!data[type]) data[type] = listener;\n\telse if (typeof data[type] === 'object') data[type].push(listener);\n\telse data[type] = [data[type], listener];\n\n\treturn this;\n};\n\nonce = function (type, listener) {\n\tvar once, self;\n\n\tcallable(listener);\n\tself = this;\n\ton.call(this, type, once = function () {\n\t\toff.call(self, type, once);\n\t\tapply.call(listener, this, arguments);\n\t});\n\n\tonce.__eeOnceListener__ = listener;\n\treturn this;\n};\n\noff = function (type, listener) {\n\tvar data, listeners, candidate, i;\n\n\tcallable(listener);\n\n\tif (!hasOwnProperty.call(this, '__ee__')) return this;\n\tdata = this.__ee__;\n\tif (!data[type]) return this;\n\tlisteners = data[type];\n\n\tif (typeof listeners === 'object') {\n\t\tfor (i = 0; (candidate = listeners[i]); ++i) {\n\t\t\tif ((candidate === listener) ||\n\t\t\t\t\t(candidate.__eeOnceListener__ === listener)) {\n\t\t\t\tif (listeners.length === 2) data[type] = listeners[i ? 0 : 1];\n\t\t\t\telse listeners.splice(i, 1);\n\t\t\t}\n\t\t}\n\t} else {\n\t\tif ((listeners === listener) ||\n\t\t\t\t(listeners.__eeOnceListener__ === listener)) {\n\t\t\tdelete data[type];\n\t\t}\n\t}\n\n\treturn this;\n};\n\nemit = function (type) {\n\tvar i, l, listener, listeners, args;\n\n\tif (!hasOwnProperty.call(this, '__ee__')) return;\n\tlisteners = this.__ee__[type];\n\tif (!listeners) return;\n\n\tif (typeof listeners === 'object') {\n\t\tl = arguments.length;\n\t\targs = new Array(l - 1);\n\t\tfor (i = 1; i < l; ++i) args[i - 1] = arguments[i];\n\n\t\tlisteners = listeners.slice();\n\t\tfor (i = 0; (listener = listeners[i]); ++i) {\n\t\t\tapply.call(listener, this, args);\n\t\t}\n\t} else {\n\t\tswitch (arguments.length) {\n\t\tcase 1:\n\t\t\tcall.call(listeners, this);\n\t\t\tbreak;\n\t\tcase 2:\n\t\t\tcall.call(listeners, this, arguments[1]);\n\t\t\tbreak;\n\t\tcase 3:\n\t\t\tcall.call(listeners, this, arguments[1], arguments[2]);\n\t\t\tbreak;\n\t\tdefault:\n\t\t\tl = arguments.length;\n\t\t\targs = new Array(l - 1);\n\t\t\tfor (i = 1; i < l; ++i) {\n\t\t\t\targs[i - 1] = arguments[i];\n\t\t\t}\n\t\t\tapply.call(listeners, this, args);\n\t\t}\n\t}\n};\n\nmethods = {\n\ton: on,\n\tonce: once,\n\toff: off,\n\temit: emit\n};\n\ndescriptors = {\n\ton: d(on),\n\tonce: d(once),\n\toff: d(off),\n\temit: d(emit)\n};\n\nbase = defineProperties({}, descriptors);\n\nmodule.exports = exports = function (o) {\n\treturn (o == null) ? create(base) : defineProperties(Object(o), descriptors);\n};\nexports.methods = methods;\n","'use strict';\n\nvar forEach    = require('es5-ext/object/for-each')\n  , validValue = require('es5-ext/object/valid-object')\n\n  , push = Array.prototype.apply, defineProperty = Object.defineProperty\n  , create = Object.create, hasOwnProperty = Object.prototype.hasOwnProperty\n  , d = { configurable: true, enumerable: false, writable: true };\n\nmodule.exports = function (e1, e2) {\n\tvar data;\n\t(validValue(e1) && validValue(e2));\n\tif (!hasOwnProperty.call(e1, '__ee__')) {\n\t\tif (!hasOwnProperty.call(e2, '__ee__')) {\n\t\t\td.value = create(null);\n\t\t\tdefineProperty(e1, '__ee__', d);\n\t\t\tdefineProperty(e2, '__ee__', d);\n\t\t\td.value = null;\n\t\t\treturn;\n\t\t}\n\t\td.value = e2.__ee__;\n\t\tdefineProperty(e1, '__ee__', d);\n\t\td.value = null;\n\t\treturn;\n\t}\n\tdata = d.value = e1.__ee__;\n\tif (!hasOwnProperty.call(e2, '__ee__')) {\n\t\tdefineProperty(e2, '__ee__', d);\n\t\td.value = null;\n\t\treturn;\n\t}\n\tif (data === e2.__ee__) return;\n\tforEach(e2.__ee__, function (listener, name) {\n\t\tif (!data[name]) {\n\t\t\tdata[name] = listener;\n\t\t\treturn;\n\t\t}\n\t\tif (typeof data[name] === 'object') {\n\t\t\tif (typeof listener === 'object') push.apply(data[name], listener);\n\t\t\telse data[name].push(listener);\n\t\t} else if (typeof listener === 'object') {\n\t\t\tlistener.unshift(data[name]);\n\t\t\tdata[name] = listener;\n\t\t} else {\n\t\t\tdata[name] = [data[name], listener];\n\t\t}\n\t});\n\tdefineProperty(e2, '__ee__', d);\n\td.value = null;\n};\n","'use strict';\n\nvar callable, byObserver;\n\ncallable = function (fn) {\n\tif (typeof fn !== 'function') throw new TypeError(fn + \" is not a function\");\n\treturn fn;\n};\n\nbyObserver = function (Observer) {\n\tvar node = document.createTextNode(''), queue, i = 0;\n\tnew Observer(function () {\n\t\tvar data;\n\t\tif (!queue) return;\n\t\tdata = queue;\n\t\tqueue = null;\n\t\tif (typeof data === 'function') {\n\t\t\tdata();\n\t\t\treturn;\n\t\t}\n\t\tdata.forEach(function (fn) { fn(); });\n\t}).observe(node, { characterData: true });\n\treturn function (fn) {\n\t\tcallable(fn);\n\t\tif (queue) {\n\t\t\tif (typeof queue === 'function') queue = [queue, fn];\n\t\t\telse queue.push(fn);\n\t\t\treturn;\n\t\t}\n\t\tqueue = fn;\n\t\tnode.data = (i = ++i % 2);\n\t};\n};\n\nmodule.exports = (function () {\n\t// Node.js\n\tif ((typeof process !== 'undefined') && process &&\n\t\t\t(typeof process.nextTick === 'function')) {\n\t\treturn process.nextTick;\n\t}\n\n\t// MutationObserver=\n\tif ((typeof document === 'object') && document) {\n\t\tif (typeof MutationObserver === 'function') {\n\t\t\treturn byObserver(MutationObserver);\n\t\t}\n\t\tif (typeof WebKitMutationObserver === 'function') {\n\t\t\treturn byObserver(WebKitMutationObserver);\n\t\t}\n\t}\n\n\t// W3C Draft\n\t// http://dvcs.w3.org/hg/webperf/raw-file/tip/specs/setImmediate/Overview.html\n\tif (typeof setImmediate === 'function') {\n\t\treturn function (cb) { setImmediate(callable(cb)); };\n\t}\n\n\t// Wide available standard\n\tif (typeof setTimeout === 'function') {\n\t\treturn function (cb) { setTimeout(callable(cb), 0); };\n\t}\n\n\treturn null;\n}());\n","// shim for using process in browser\n\nvar process = module.exports = {};\nvar queue = [];\nvar draining = false;\nvar currentQueue;\nvar queueIndex = -1;\n\nfunction cleanUpNextTick() {\n    draining = false;\n    if (currentQueue.length) {\n        queue = currentQueue.concat(queue);\n    } else {\n        queueIndex = -1;\n    }\n    if (queue.length) {\n        drainQueue();\n    }\n}\n\nfunction drainQueue() {\n    if (draining) {\n        return;\n    }\n    var timeout = setTimeout(cleanUpNextTick);\n    draining = true;\n\n    var len = queue.length;\n    while(len) {\n        currentQueue = queue;\n        queue = [];\n        while (++queueIndex < len) {\n            if (currentQueue) {\n                currentQueue[queueIndex].run();\n            }\n        }\n        queueIndex = -1;\n        len = queue.length;\n    }\n    currentQueue = null;\n    draining = false;\n    clearTimeout(timeout);\n}\n\nprocess.nextTick = function (fun) {\n    var args = new Array(arguments.length - 1);\n    if (arguments.length > 1) {\n        for (var i = 1; i < arguments.length; i++) {\n            args[i - 1] = arguments[i];\n        }\n    }\n    queue.push(new Item(fun, args));\n    if (queue.length === 1 && !draining) {\n        setTimeout(drainQueue, 0);\n    }\n};\n\n// v8 likes predictible objects\nfunction Item(fun, array) {\n    this.fun = fun;\n    this.array = array;\n}\nItem.prototype.run = function () {\n    this.fun.apply(null, this.array);\n};\nprocess.title = 'browser';\nprocess.browser = true;\nprocess.env = {};\nprocess.argv = [];\nprocess.version = ''; // empty string to avoid regexp issues\nprocess.versions = {};\n\nfunction noop() {}\n\nprocess.on = noop;\nprocess.addListener = noop;\nprocess.once = noop;\nprocess.off = noop;\nprocess.removeListener = noop;\nprocess.removeAllListeners = noop;\nprocess.emit = noop;\n\nprocess.binding = function (name) {\n    throw new Error('process.binding is not supported');\n};\n\nprocess.cwd = function () { return '/' };\nprocess.chdir = function (dir) {\n    throw new Error('process.chdir is not supported');\n};\nprocess.umask = function() { return 0; };\n","(function (factory) {\n    if (typeof exports === 'object') {\n        // Node/CommonJS\n        module.exports = factory();\n    } else if (typeof define === 'function' && define.amd) {\n        // AMD\n        define(factory);\n    } else {\n        // Browser globals (with support for web workers)\n        var glob;\n\n        try {\n            glob = window;\n        } catch (e) {\n            glob = self;\n        }\n\n        glob.SparkMD5 = factory();\n    }\n}(function (undefined) {\n\n    'use strict';\n\n    /*\n     * Fastest md5 implementation around (JKM md5).\n     * Credits: Joseph Myers\n     *\n     * @see http://www.myersdaily.org/joseph/javascript/md5-text.html\n     * @see http://jsperf.com/md5-shootout/7\n     */\n\n    /* this function is much faster,\n      so if possible we use it. Some IEs\n      are the only ones I know of that\n      need the idiotic second function,\n      generated by an if clause.  */\n    var add32 = function (a, b) {\n        return (a + b) & 0xFFFFFFFF;\n    },\n        hex_chr = ['0', '1', '2', '3', '4', '5', '6', '7', '8', '9', 'a', 'b', 'c', 'd', 'e', 'f'];\n\n\n    function cmn(q, a, b, x, s, t) {\n        a = add32(add32(a, q), add32(x, t));\n        return add32((a << s) | (a >>> (32 - s)), b);\n    }\n\n    function ff(a, b, c, d, x, s, t) {\n        return cmn((b & c) | ((~b) & d), a, b, x, s, t);\n    }\n\n    function gg(a, b, c, d, x, s, t) {\n        return cmn((b & d) | (c & (~d)), a, b, x, s, t);\n    }\n\n    function hh(a, b, c, d, x, s, t) {\n        return cmn(b ^ c ^ d, a, b, x, s, t);\n    }\n\n    function ii(a, b, c, d, x, s, t) {\n        return cmn(c ^ (b | (~d)), a, b, x, s, t);\n    }\n\n    function md5cycle(x, k) {\n        var a = x[0],\n            b = x[1],\n            c = x[2],\n            d = x[3];\n\n        a = ff(a, b, c, d, k[0], 7, -680876936);\n        d = ff(d, a, b, c, k[1], 12, -389564586);\n        c = ff(c, d, a, b, k[2], 17, 606105819);\n        b = ff(b, c, d, a, k[3], 22, -1044525330);\n        a = ff(a, b, c, d, k[4], 7, -176418897);\n        d = ff(d, a, b, c, k[5], 12, 1200080426);\n        c = ff(c, d, a, b, k[6], 17, -1473231341);\n        b = ff(b, c, d, a, k[7], 22, -45705983);\n        a = ff(a, b, c, d, k[8], 7, 1770035416);\n        d = ff(d, a, b, c, k[9], 12, -1958414417);\n        c = ff(c, d, a, b, k[10], 17, -42063);\n        b = ff(b, c, d, a, k[11], 22, -1990404162);\n        a = ff(a, b, c, d, k[12], 7, 1804603682);\n        d = ff(d, a, b, c, k[13], 12, -40341101);\n        c = ff(c, d, a, b, k[14], 17, -1502002290);\n        b = ff(b, c, d, a, k[15], 22, 1236535329);\n\n        a = gg(a, b, c, d, k[1], 5, -165796510);\n        d = gg(d, a, b, c, k[6], 9, -1069501632);\n        c = gg(c, d, a, b, k[11], 14, 643717713);\n        b = gg(b, c, d, a, k[0], 20, -373897302);\n        a = gg(a, b, c, d, k[5], 5, -701558691);\n        d = gg(d, a, b, c, k[10], 9, 38016083);\n        c = gg(c, d, a, b, k[15], 14, -660478335);\n        b = gg(b, c, d, a, k[4], 20, -405537848);\n        a = gg(a, b, c, d, k[9], 5, 568446438);\n        d = gg(d, a, b, c, k[14], 9, -1019803690);\n        c = gg(c, d, a, b, k[3], 14, -187363961);\n        b = gg(b, c, d, a, k[8], 20, 1163531501);\n        a = gg(a, b, c, d, k[13], 5, -1444681467);\n        d = gg(d, a, b, c, k[2], 9, -51403784);\n        c = gg(c, d, a, b, k[7], 14, 1735328473);\n        b = gg(b, c, d, a, k[12], 20, -1926607734);\n\n        a = hh(a, b, c, d, k[5], 4, -378558);\n        d = hh(d, a, b, c, k[8], 11, -2022574463);\n        c = hh(c, d, a, b, k[11], 16, 1839030562);\n        b = hh(b, c, d, a, k[14], 23, -35309556);\n        a = hh(a, b, c, d, k[1], 4, -1530992060);\n        d = hh(d, a, b, c, k[4], 11, 1272893353);\n        c = hh(c, d, a, b, k[7], 16, -155497632);\n        b = hh(b, c, d, a, k[10], 23, -1094730640);\n        a = hh(a, b, c, d, k[13], 4, 681279174);\n        d = hh(d, a, b, c, k[0], 11, -358537222);\n        c = hh(c, d, a, b, k[3], 16, -722521979);\n        b = hh(b, c, d, a, k[6], 23, 76029189);\n        a = hh(a, b, c, d, k[9], 4, -640364487);\n        d = hh(d, a, b, c, k[12], 11, -421815835);\n        c = hh(c, d, a, b, k[15], 16, 530742520);\n        b = hh(b, c, d, a, k[2], 23, -995338651);\n\n        a = ii(a, b, c, d, k[0], 6, -198630844);\n        d = ii(d, a, b, c, k[7], 10, 1126891415);\n        c = ii(c, d, a, b, k[14], 15, -1416354905);\n        b = ii(b, c, d, a, k[5], 21, -57434055);\n        a = ii(a, b, c, d, k[12], 6, 1700485571);\n        d = ii(d, a, b, c, k[3], 10, -1894986606);\n        c = ii(c, d, a, b, k[10], 15, -1051523);\n        b = ii(b, c, d, a, k[1], 21, -2054922799);\n        a = ii(a, b, c, d, k[8], 6, 1873313359);\n        d = ii(d, a, b, c, k[15], 10, -30611744);\n        c = ii(c, d, a, b, k[6], 15, -1560198380);\n        b = ii(b, c, d, a, k[13], 21, 1309151649);\n        a = ii(a, b, c, d, k[4], 6, -145523070);\n        d = ii(d, a, b, c, k[11], 10, -1120210379);\n        c = ii(c, d, a, b, k[2], 15, 718787259);\n        b = ii(b, c, d, a, k[9], 21, -343485551);\n\n        x[0] = add32(a, x[0]);\n        x[1] = add32(b, x[1]);\n        x[2] = add32(c, x[2]);\n        x[3] = add32(d, x[3]);\n    }\n\n    function md5blk(s) {\n        var md5blks = [],\n            i; /* Andy King said do it this way. */\n\n        for (i = 0; i < 64; i += 4) {\n            md5blks[i >> 2] = s.charCodeAt(i) + (s.charCodeAt(i + 1) << 8) + (s.charCodeAt(i + 2) << 16) + (s.charCodeAt(i + 3) << 24);\n        }\n        return md5blks;\n    }\n\n    function md5blk_array(a) {\n        var md5blks = [],\n            i; /* Andy King said do it this way. */\n\n        for (i = 0; i < 64; i += 4) {\n            md5blks[i >> 2] = a[i] + (a[i + 1] << 8) + (a[i + 2] << 16) + (a[i + 3] << 24);\n        }\n        return md5blks;\n    }\n\n    function md51(s) {\n        var n = s.length,\n            state = [1732584193, -271733879, -1732584194, 271733878],\n            i,\n            length,\n            tail,\n            tmp,\n            lo,\n            hi;\n\n        for (i = 64; i <= n; i += 64) {\n            md5cycle(state, md5blk(s.substring(i - 64, i)));\n        }\n        s = s.substring(i - 64);\n        length = s.length;\n        tail = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0];\n        for (i = 0; i < length; i += 1) {\n            tail[i >> 2] |= s.charCodeAt(i) << ((i % 4) << 3);\n        }\n        tail[i >> 2] |= 0x80 << ((i % 4) << 3);\n        if (i > 55) {\n            md5cycle(state, tail);\n            for (i = 0; i < 16; i += 1) {\n                tail[i] = 0;\n            }\n        }\n\n        // Beware that the final length might not fit in 32 bits so we take care of that\n        tmp = n * 8;\n        tmp = tmp.toString(16).match(/(.*?)(.{0,8})$/);\n        lo = parseInt(tmp[2], 16);\n        hi = parseInt(tmp[1], 16) || 0;\n\n        tail[14] = lo;\n        tail[15] = hi;\n\n        md5cycle(state, tail);\n        return state;\n    }\n\n    function md51_array(a) {\n        var n = a.length,\n            state = [1732584193, -271733879, -1732584194, 271733878],\n            i,\n            length,\n            tail,\n            tmp,\n            lo,\n            hi;\n\n        for (i = 64; i <= n; i += 64) {\n            md5cycle(state, md5blk_array(a.subarray(i - 64, i)));\n        }\n\n        // Not sure if it is a bug, however IE10 will always produce a sub array of length 1\n        // containing the last element of the parent array if the sub array specified starts\n        // beyond the length of the parent array - weird.\n        // https://connect.microsoft.com/IE/feedback/details/771452/typed-array-subarray-issue\n        a = (i - 64) < n ? a.subarray(i - 64) : new Uint8Array(0);\n\n        length = a.length;\n        tail = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0];\n        for (i = 0; i < length; i += 1) {\n            tail[i >> 2] |= a[i] << ((i % 4) << 3);\n        }\n\n        tail[i >> 2] |= 0x80 << ((i % 4) << 3);\n        if (i > 55) {\n            md5cycle(state, tail);\n            for (i = 0; i < 16; i += 1) {\n                tail[i] = 0;\n            }\n        }\n\n        // Beware that the final length might not fit in 32 bits so we take care of that\n        tmp = n * 8;\n        tmp = tmp.toString(16).match(/(.*?)(.{0,8})$/);\n        lo = parseInt(tmp[2], 16);\n        hi = parseInt(tmp[1], 16) || 0;\n\n        tail[14] = lo;\n        tail[15] = hi;\n\n        md5cycle(state, tail);\n\n        return state;\n    }\n\n    function rhex(n) {\n        var s = '',\n            j;\n        for (j = 0; j < 4; j += 1) {\n            s += hex_chr[(n >> (j * 8 + 4)) & 0x0F] + hex_chr[(n >> (j * 8)) & 0x0F];\n        }\n        return s;\n    }\n\n    function hex(x) {\n        var i;\n        for (i = 0; i < x.length; i += 1) {\n            x[i] = rhex(x[i]);\n        }\n        return x.join('');\n    }\n\n    // In some cases the fast add32 function cannot be used..\n    if (hex(md51('hello')) !== '5d41402abc4b2a76b9719d911017c592') {\n        add32 = function (x, y) {\n            var lsw = (x & 0xFFFF) + (y & 0xFFFF),\n                msw = (x >> 16) + (y >> 16) + (lsw >> 16);\n            return (msw << 16) | (lsw & 0xFFFF);\n        };\n    }\n\n    // ---------------------------------------------------\n\n    /**\n     * ArrayBuffer slice polyfill.\n     *\n     * @see https://github.com/ttaubert/node-arraybuffer-slice\n     */\n\n    if (typeof ArrayBuffer !== 'undefined' && !ArrayBuffer.prototype.slice) {\n        (function () {\n            function clamp(val, length) {\n                val = (val | 0) || 0;\n\n                if (val < 0) {\n                    return Math.max(val + length, 0);\n                }\n\n                return Math.min(val, length);\n            }\n\n            ArrayBuffer.prototype.slice = function (from, to) {\n                var length = this.byteLength,\n                    begin = clamp(from, length),\n                    end = length,\n                    num,\n                    target,\n                    targetArray,\n                    sourceArray;\n\n                if (to !== undefined) {\n                    end = clamp(to, length);\n                }\n\n                if (begin > end) {\n                    return new ArrayBuffer(0);\n                }\n\n                num = end - begin;\n                target = new ArrayBuffer(num);\n                targetArray = new Uint8Array(target);\n\n                sourceArray = new Uint8Array(this, begin, num);\n                targetArray.set(sourceArray);\n\n                return target;\n            };\n        })();\n    }\n\n    // ---------------------------------------------------\n\n    /**\n     * Helpers.\n     */\n\n    function toUtf8(str) {\n        if (/[\\u0080-\\uFFFF]/.test(str)) {\n            str = unescape(encodeURIComponent(str));\n        }\n\n        return str;\n    }\n\n    function utf8Str2ArrayBuffer(str, returnUInt8Array) {\n        var length = str.length,\n           buff = new ArrayBuffer(length),\n           arr = new Uint8Array(buff),\n           i;\n\n        for (i = 0; i < length; i += 1) {\n            arr[i] = str.charCodeAt(i);\n        }\n\n        return returnUInt8Array ? arr : buff;\n    }\n\n    function arrayBuffer2Utf8Str(buff) {\n        return String.fromCharCode.apply(null, new Uint8Array(buff));\n    }\n\n    function concatenateArrayBuffers(first, second, returnUInt8Array) {\n        var result = new Uint8Array(first.byteLength + second.byteLength);\n\n        result.set(new Uint8Array(first));\n        result.set(new Uint8Array(second), first.byteLength);\n\n        return returnUInt8Array ? result : result.buffer;\n    }\n\n    function hexToBinaryString(hex) {\n        var bytes = [],\n            length = hex.length,\n            x;\n\n        for (x = 0; x < length - 1; x += 2) {\n            bytes.push(parseInt(hex.substr(x, 2), 16));\n        }\n\n        return String.fromCharCode.apply(String, bytes);\n    }\n\n    // ---------------------------------------------------\n\n    /**\n     * SparkMD5 OOP implementation.\n     *\n     * Use this class to perform an incremental md5, otherwise use the\n     * static methods instead.\n     */\n\n    function SparkMD5() {\n        // call reset to init the instance\n        this.reset();\n    }\n\n    /**\n     * Appends a string.\n     * A conversion will be applied if an utf8 string is detected.\n     *\n     * @param {String} str The string to be appended\n     *\n     * @return {SparkMD5} The instance itself\n     */\n    SparkMD5.prototype.append = function (str) {\n        // Converts the string to utf8 bytes if necessary\n        // Then append as binary\n        this.appendBinary(toUtf8(str));\n\n        return this;\n    };\n\n    /**\n     * Appends a binary string.\n     *\n     * @param {String} contents The binary string to be appended\n     *\n     * @return {SparkMD5} The instance itself\n     */\n    SparkMD5.prototype.appendBinary = function (contents) {\n        this._buff += contents;\n        this._length += contents.length;\n\n        var length = this._buff.length,\n            i;\n\n        for (i = 64; i <= length; i += 64) {\n            md5cycle(this._hash, md5blk(this._buff.substring(i - 64, i)));\n        }\n\n        this._buff = this._buff.substring(i - 64);\n\n        return this;\n    };\n\n    /**\n     * Finishes the incremental computation, reseting the internal state and\n     * returning the result.\n     *\n     * @param {Boolean} raw True to get the raw string, false to get the hex string\n     *\n     * @return {String} The result\n     */\n    SparkMD5.prototype.end = function (raw) {\n        var buff = this._buff,\n            length = buff.length,\n            i,\n            tail = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],\n            ret;\n\n        for (i = 0; i < length; i += 1) {\n            tail[i >> 2] |= buff.charCodeAt(i) << ((i % 4) << 3);\n        }\n\n        this._finish(tail, length);\n        ret = hex(this._hash);\n\n        if (raw) {\n            ret = hexToBinaryString(ret);\n        }\n\n        this.reset();\n\n        return ret;\n    };\n\n    /**\n     * Resets the internal state of the computation.\n     *\n     * @return {SparkMD5} The instance itself\n     */\n    SparkMD5.prototype.reset = function () {\n        this._buff = '';\n        this._length = 0;\n        this._hash = [1732584193, -271733879, -1732584194, 271733878];\n\n        return this;\n    };\n\n    /**\n     * Gets the internal state of the computation.\n     *\n     * @return {Object} The state\n     */\n    SparkMD5.prototype.getState = function () {\n        return {\n            buff: this._buff,\n            length: this._length,\n            hash: this._hash\n        };\n    };\n\n    /**\n     * Gets the internal state of the computation.\n     *\n     * @param {Object} state The state\n     *\n     * @return {SparkMD5} The instance itself\n     */\n    SparkMD5.prototype.setState = function (state) {\n        this._buff = state.buff;\n        this._length = state.length;\n        this._hash = state.hash;\n\n        return this;\n    };\n\n    /**\n     * Releases memory used by the incremental buffer and other additional\n     * resources. If you plan to use the instance again, use reset instead.\n     */\n    SparkMD5.prototype.destroy = function () {\n        delete this._hash;\n        delete this._buff;\n        delete this._length;\n    };\n\n    /**\n     * Finish the final calculation based on the tail.\n     *\n     * @param {Array}  tail   The tail (will be modified)\n     * @param {Number} length The length of the remaining buffer\n     */\n    SparkMD5.prototype._finish = function (tail, length) {\n        var i = length,\n            tmp,\n            lo,\n            hi;\n\n        tail[i >> 2] |= 0x80 << ((i % 4) << 3);\n        if (i > 55) {\n            md5cycle(this._hash, tail);\n            for (i = 0; i < 16; i += 1) {\n                tail[i] = 0;\n            }\n        }\n\n        // Do the final computation based on the tail and length\n        // Beware that the final length may not fit in 32 bits so we take care of that\n        tmp = this._length * 8;\n        tmp = tmp.toString(16).match(/(.*?)(.{0,8})$/);\n        lo = parseInt(tmp[2], 16);\n        hi = parseInt(tmp[1], 16) || 0;\n\n        tail[14] = lo;\n        tail[15] = hi;\n        md5cycle(this._hash, tail);\n    };\n\n    /**\n     * Performs the md5 hash on a string.\n     * A conversion will be applied if utf8 string is detected.\n     *\n     * @param {String}  str The string\n     * @param {Boolean} raw True to get the raw string, false to get the hex string\n     *\n     * @return {String} The result\n     */\n    SparkMD5.hash = function (str, raw) {\n        // Converts the string to utf8 bytes if necessary\n        // Then compute it using the binary function\n        return SparkMD5.hashBinary(toUtf8(str), raw);\n    };\n\n    /**\n     * Performs the md5 hash on a binary string.\n     *\n     * @param {String}  content The binary string\n     * @param {Boolean} raw     True to get the raw string, false to get the hex string\n     *\n     * @return {String} The result\n     */\n    SparkMD5.hashBinary = function (content, raw) {\n        var hash = md51(content),\n            ret = hex(hash);\n\n        return raw ? hexToBinaryString(ret) : ret;\n    };\n\n    // ---------------------------------------------------\n\n    /**\n     * SparkMD5 OOP implementation for array buffers.\n     *\n     * Use this class to perform an incremental md5 ONLY for array buffers.\n     */\n    SparkMD5.ArrayBuffer = function () {\n        // call reset to init the instance\n        this.reset();\n    };\n\n    /**\n     * Appends an array buffer.\n     *\n     * @param {ArrayBuffer} arr The array to be appended\n     *\n     * @return {SparkMD5.ArrayBuffer} The instance itself\n     */\n    SparkMD5.ArrayBuffer.prototype.append = function (arr) {\n        var buff = concatenateArrayBuffers(this._buff.buffer, arr, true),\n            length = buff.length,\n            i;\n\n        this._length += arr.byteLength;\n\n        for (i = 64; i <= length; i += 64) {\n            md5cycle(this._hash, md5blk_array(buff.subarray(i - 64, i)));\n        }\n\n        this._buff = (i - 64) < length ? new Uint8Array(buff.buffer.slice(i - 64)) : new Uint8Array(0);\n\n        return this;\n    };\n\n    /**\n     * Finishes the incremental computation, reseting the internal state and\n     * returning the result.\n     *\n     * @param {Boolean} raw True to get the raw string, false to get the hex string\n     *\n     * @return {String} The result\n     */\n    SparkMD5.ArrayBuffer.prototype.end = function (raw) {\n        var buff = this._buff,\n            length = buff.length,\n            tail = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],\n            i,\n            ret;\n\n        for (i = 0; i < length; i += 1) {\n            tail[i >> 2] |= buff[i] << ((i % 4) << 3);\n        }\n\n        this._finish(tail, length);\n        ret = hex(this._hash);\n\n        if (raw) {\n            ret = hexToBinaryString(ret);\n        }\n\n        this.reset();\n\n        return ret;\n    };\n\n    /**\n     * Resets the internal state of the computation.\n     *\n     * @return {SparkMD5.ArrayBuffer} The instance itself\n     */\n    SparkMD5.ArrayBuffer.prototype.reset = function () {\n        this._buff = new Uint8Array(0);\n        this._length = 0;\n        this._hash = [1732584193, -271733879, -1732584194, 271733878];\n\n        return this;\n    };\n\n    /**\n     * Gets the internal state of the computation.\n     *\n     * @return {Object} The state\n     */\n    SparkMD5.ArrayBuffer.prototype.getState = function () {\n        var state = SparkMD5.prototype.getState.call(this);\n\n        // Convert buffer to a string\n        state.buff = arrayBuffer2Utf8Str(state.buff);\n\n        return state;\n    };\n\n    /**\n     * Gets the internal state of the computation.\n     *\n     * @param {Object} state The state\n     *\n     * @return {SparkMD5.ArrayBuffer} The instance itself\n     */\n    SparkMD5.ArrayBuffer.prototype.setState = function (state) {\n        // Convert string to buffer\n        state.buff = utf8Str2ArrayBuffer(state.buff, true);\n\n        return SparkMD5.prototype.setState.call(this, state);\n    };\n\n    SparkMD5.ArrayBuffer.prototype.destroy = SparkMD5.prototype.destroy;\n\n    SparkMD5.ArrayBuffer.prototype._finish = SparkMD5.prototype._finish;\n\n    /**\n     * Performs the md5 hash on an array buffer.\n     *\n     * @param {ArrayBuffer} arr The array buffer\n     * @param {Boolean}     raw True to get the raw string, false to get the hex one\n     *\n     * @return {String} The result\n     */\n    SparkMD5.ArrayBuffer.hash = function (arr, raw) {\n        var hash = md51_array(new Uint8Array(arr)),\n            ret = hex(hash);\n\n        return raw ? hexToBinaryString(ret) : ret;\n    };\n\n    return SparkMD5;\n}));\n","'use strict';\n\n(function (root, factory) {\n    if (typeof define === 'function' && define.amd) {\n        // AMD. Register as an anonymous module.\n        define([], factory);\n    } else if (typeof module === 'object' && module.exports) {\n        // Node. Does not work with strict CommonJS, but\n        // only CommonJS-like environments that support module.exports,\n        // like Node.\n        module.exports = factory();\n    } else {\n        // Browser globals (root is window)\n        root.striptags = factory();\n  }\n}(this, function () {\n    var STATE_OUTPUT       = 0,\n        STATE_HTML         = 1,\n        STATE_PRE_COMMENT  = 2,\n        STATE_COMMENT      = 3,\n        WHITESPACE         = /\\s/,\n        ALLOWED_TAGS_REGEX = /<(\\w*)>/g;\n\n    function striptags(html, allowableTags) {\n        var html = html || '',\n            state = STATE_OUTPUT,\n            depth = 0,\n            output = '',\n            tagBuffer = '',\n            inQuote = false,\n            i, length, c;\n\n        if (typeof allowableTags === 'string') {\n            // Parse the string into an array of tags\n            allowableTags = parseAllowableTags(allowableTags);\n        } else if (!Array.isArray(allowableTags)) {\n            // If it is not an array, explicitly set to null\n            allowableTags = null;\n        }\n\n        for (i = 0, length = html.length; i < length; i++) {\n            c = html[i];\n\n            switch (c) {\n                case '<': {\n                    // ignore '<' if inside a quote\n                    if (inQuote) {\n                        break;\n                    }\n\n                    // '<' followed by a space is not a valid tag, continue\n                    if (html[i + 1] == ' ') {\n                        consumeCharacter(c);\n                        break;\n                    }\n\n                    // change to STATE_HTML\n                    if (state == STATE_OUTPUT) {\n                        state = STATE_HTML;\n\n                        consumeCharacter(c);\n                        break;\n                    }\n\n                    // ignore additional '<' characters when inside a tag\n                    if (state == STATE_HTML) {\n                        depth++;\n                        break;\n                    }\n\n                    consumeCharacter(c);\n                    break;\n                }\n\n                case '>': {\n                    // something like this is happening: '<<>>'\n                    if (depth) {\n                        depth--;\n                        break;\n                    }\n\n                    // ignore '>' if inside a quote\n                    if (inQuote) {\n                        break;\n                    }\n\n                    // an HTML tag was closed\n                    if (state == STATE_HTML) {\n                        inQuote = state = 0;\n\n                        if (allowableTags) {\n                            tagBuffer += '>';\n                            flushTagBuffer();\n                        }\n\n                        break;\n                    }\n\n                    // '<!' met its ending '>'\n                    if (state == STATE_PRE_COMMENT) {\n                        inQuote = state = 0;\n                        tagBuffer = '';\n                        break;\n                    }\n\n                    // if last two characters were '--', then end comment\n                    if (state == STATE_COMMENT &&\n                        html[i - 1] == '-' &&\n                        html[i - 2] == '-') {\n\n                        inQuote = state = 0;\n                        tagBuffer = '';\n                        break;\n                    }\n\n                    consumeCharacter(c);\n                    break;\n                }\n\n                // catch both single and double quotes\n                case '\"':\n                case '\\'': {\n                    if (state == STATE_HTML) {\n                        if (inQuote == c) {\n                            // end quote found\n                            inQuote = false;\n                        } else if (!inQuote) {\n                            // start quote only if not already in one\n                            inQuote = c;\n                        }\n                    }\n\n                    consumeCharacter(c);\n                    break;\n                }\n\n                case '!': {\n                    if (state == STATE_HTML &&\n                        html[i - 1] == '<') {\n\n                        // looks like we might be starting a comment\n                        state = STATE_PRE_COMMENT;\n                        break;\n                    }\n\n                    consumeCharacter(c);\n                    break;\n                }\n\n                case '-': {\n                    // if the previous two characters were '!-', this is a comment\n                    if (state == STATE_PRE_COMMENT &&\n                        html[i - 1] == '-' &&\n                        html[i - 2] == '!') {\n\n                        state = STATE_COMMENT;\n                        break;\n                    }\n\n                    consumeCharacter(c);\n                    break;\n                }\n\n                case 'E':\n                case 'e': {\n                    // check for DOCTYPE, because it looks like a comment and isn't\n                    if (state == STATE_PRE_COMMENT &&\n                        html.substr(i - 6, 7).toLowerCase() == 'doctype') {\n\n                        state = STATE_HTML;\n                        break;\n                    }\n\n                    consumeCharacter(c);\n                    break;\n                }\n\n                default: {\n                    consumeCharacter(c);\n                }\n            }\n        }\n\n        function consumeCharacter(c) {\n            if (state == STATE_OUTPUT) {\n                output += c;\n            } else if (allowableTags && state == STATE_HTML) {\n                tagBuffer += c;\n            }\n        }\n\n        function flushTagBuffer() {\n            var normalized = '',\n                nonWhitespaceSeen = false,\n                i, length, c;\n\n            normalizeTagBuffer:\n            for (i = 0, length = tagBuffer.length; i < length; i++) {\n                c = tagBuffer[i].toLowerCase();\n\n                switch (c) {\n                    case '<': {\n                        break;\n                    }\n\n                    case '>': {\n                        break normalizeTagBuffer;\n                    }\n\n                    case '/': {\n                        nonWhitespaceSeen = true;\n                        break;\n                    }\n\n                    default: {\n                        if (!c.match(WHITESPACE)) {\n                            nonWhitespaceSeen = true;\n                            normalized += c;\n                        } else if (nonWhitespaceSeen) {\n                            break normalizeTagBuffer;\n                        }\n                    }\n                }\n            }\n\n            if (allowableTags.indexOf(normalized) !== -1) {\n                output += tagBuffer;\n            }\n\n            tagBuffer = '';\n        }\n\n        return output;\n    }\n\n    /**\n     * Return an array containing tags that are allowed to pass through the\n     * algorithm.\n     *\n     * @param string allowableTags A string of tags to allow (e.g. \"<b><strong>\").\n     * @return array|null An array of allowed tags or null if none.\n     */\n    function parseAllowableTags(allowableTags) {\n        var tagsArray = [],\n            match;\n\n        while ((match = ALLOWED_TAGS_REGEX.exec(allowableTags)) !== null) {\n            tagsArray.push(match[1]);\n        }\n\n        return tagsArray.length !== 0 ? tagsArray : null;\n    }\n\n    return striptags;\n}));\n","'use strict';\n\nmodule.exports = 2147483647;\n","'use strict';\n\nvar toPosInt   = require('es5-ext/number/to-pos-integer')\n  , maxTimeout = require('./max-timeout');\n\nmodule.exports = function (value) {\n\tvalue = toPosInt(value);\n\tif (value > maxTimeout) throw new TypeError(value + \" exceeds maximum possible timeout\");\n\treturn value;\n};\n","'use strict';\n\nvar Ajax = {};\n\nAjax.errorCallback = function(response){\n\tZ.error(response);\n\tZ.debug('ajax error callback', 2);\n\tZ.debug('textStatus: ' + response.textStatus, 2);\n\tZ.debug('errorThrown: ', 2);\n\tZ.debug(response.errorThrown, 2);\n\tZ.debug(response.jqxhr, 2);\n};\n\nAjax.error = Ajax.errorCallback;\nAjax.activeRequests = [];\n\n/*\n * Requires {target:items|collections|tags, libraryType:user|group, libraryID:<>}\n */\nAjax.apiRequestUrl = function(params){\n\tZ.debug('Zotero.Ajax.apiRequestUrl', 4);\n\tZ.debug(params, 4);\n\tObject.keys(params).forEach(function(key){\n\t\tvar val = params[key];\n\t\t//should probably figure out exactly why I'm doing this, is it just to make sure no hashes snuck in?\n\t\t//if so the new validation below takes care of that instead\n\t\tif(typeof val == 'string'){\n\t\t\tval = val.split('#', 1);\n\t\t\tparams[key] = val[0];\n\t\t}\n\t\t\n\t\t//validate params based on patterns in Zotero.validate\n\t\tif(Zotero.validator.validate(val, key) === false){\n\t\t\t//warn on invalid parameter and drop from params that will be used\n\t\t\tZotero.warn('API argument failed validation: ' + key + ' cannot be ' + val);\n\t\t\tZotero.warn(params);\n\t\t\tdelete params[key];\n\t\t}\n\t});\n\t\n\tif(!params.target) throw new Error('No target defined for api request');\n\tif(!(params.libraryType == 'user' ||\n\t\tparams.libraryType == 'group' ||\n\t\tparams.libraryType === '')) {\n\t\tthrow new Error('Unexpected libraryType for api request ' + JSON.stringify(params));\n\t}\n\tif((params.libraryType) && !(params.libraryID)) {\n\t\tthrow new Error('No libraryID defined for api request');\n\t}\n\tif((params.target == 'publications') && (params.libraryType != 'user')){\n\t\tthrow new Error('publications is only valid for user libraries');\n\t}\n\t\n\tvar base = Zotero.config.baseApiUrl;\n\tvar url;\n\t\n\tif(params.libraryType !== ''){\n\t\turl = base + '/' + params.libraryType + 's/' + params.libraryID;\n\t\tif(params.collectionKey){\n\t\t\tif(params.collectionKey == 'trash'){\n\t\t\t\turl += '/items/trash';\n\t\t\t\treturn url;\n\t\t\t}\n\t\t\telse if(params.collectionKey.indexOf(',') !== -1){\n\t\t\t\t\n\t\t\t}\n\t\t\telse if(params.target != 'collections'){\n\t\t\t\turl += '/collections/' + params.collectionKey;\n\t\t\t}\n\t\t}\n\t}\n\telse{\n\t\turl = base;\n\t}\n\t\n\tswitch(params.target){\n\t\tcase 'items':\n\t\t\turl += '/items';\n\t\t\tbreak;\n\t\tcase 'item':\n\t\t\tif(params.itemKey){\n\t\t\t\turl += '/items/' + params.itemKey;\n\t\t\t}\n\t\t\telse{\n\t\t\t\turl += '/items';\n\t\t\t}\n\t\t\tbreak;\n\t\tcase 'collections':\n\t\t\turl += '/collections';\n\t\t\tbreak;\n\t\tcase 'childCollections':\n\t\t\turl += '/collections';\n\t\t\tbreak;\n\t\tcase 'collection':\n\t\t\tbreak;\n\t\tcase 'tags':\n\t\t\turl += '/tags';\n\t\t\tbreak;\n\t\tcase 'children':\n\t\t\turl += '/items/' + params.itemKey + '/children';\n\t\t\tbreak;\n\t\tcase 'key':\n\t\t\turl = base + '/users/' + params.libraryID + '/keys/' + params.apiKey;\n\t\t\tbreak;\n\t\tcase 'deleted':\n\t\t\turl += '/deleted';\n\t\t\tbreak;\n\t\tcase 'userGroups':\n\t\t\turl = base + '/users/' + params.libraryID + '/groups';\n\t\t\tbreak;\n\t\tcase 'settings':\n\t\t\turl += '/settings/' + (params.settingsKey || '');\n\t\t\tbreak;\n\t\tcase 'publications':\n\t\t\turl += '/publications/items';\n\t\t\tbreak;\n\t\tdefault:\n\t\t\treturn false;\n\t}\n\tswitch(params.targetModifier){\n\t\tcase 'top':\n\t\t\turl += '/top';\n\t\t\tbreak;\n\t\tcase 'file':\n\t\t\turl += '/file';\n\t\t\tbreak;\n\t\tcase 'viewsnapshot':\n\t\t\turl += '/file/view';\n\t\t\tbreak;\n\t}\n\t//Z.debug(\"returning apiRequestUrl: \" + url, 3);\n\treturn url;\n};\n\nAjax.apiQueryString = function(passedParams, useConfigKey){\n\tZ.debug('Zotero.Ajax.apiQueryString', 4);\n\tZ.debug(passedParams, 4);\n\tif(useConfigKey === null || typeof useConfigKey === 'undefined'){\n\t\tuseConfigKey = true;\n\t}\n\t\n\tObject.keys(passedParams).forEach(function(key){\n\t\tvar val = passedParams[key];\n\t\tif(typeof val == 'string'){\n\t\t\tval = val.split('#', 1);\n\t\t\tpassedParams[key] = val[0];\n\t\t}\n\t});\n\tif(passedParams.hasOwnProperty('order') && passedParams['order'] == 'creatorSummary'){\n\t\tpassedParams['order'] = 'creator';\n\t}\n\tif(passedParams.hasOwnProperty('order') && passedParams['order'] == 'year'){\n\t\tpassedParams['order'] = 'date';\n\t}\n\tif(useConfigKey && Zotero.config.sessionAuth) {\n\t\tvar sessionKey = Zotero.utils.readCookie(Zotero.config.sessionCookieName);\n\t\tpassedParams['session'] = sessionKey;\n\t}\n\telse if(useConfigKey && Zotero.config.apiKey){\n\t\tpassedParams['key'] = Zotero.config.apiKey;\n\t}\n\t\n\t//Z.debug()\n\tif(passedParams.hasOwnProperty('sort') && passedParams['sort'] == 'undefined' ){\n\t\t//alert('fixed a bad sort');\n\t\tpassedParams['sort'] = 'asc';\n\t}\n\t\n\tZ.debug(passedParams, 4);\n\t\n\tvar queryString = '?';\n\tvar queryParamsArray = [];\n\tvar queryParamOptions = ['start',\n\t\t\t\t\t\t\t'limit',\n\t\t\t\t\t\t\t'order',\n\t\t\t\t\t\t\t'sort',\n\t\t\t\t\t\t\t'content',\n\t\t\t\t\t\t\t'include',\n\t\t\t\t\t\t\t'format',\n\t\t\t\t\t\t\t'q',\n\t\t\t\t\t\t\t'fq',\n\t\t\t\t\t\t\t'itemType',\n\t\t\t\t\t\t\t'itemKey',\n\t\t\t\t\t\t\t'collectionKey',\n\t\t\t\t\t\t\t'searchKey',\n\t\t\t\t\t\t\t'locale',\n\t\t\t\t\t\t\t'tag',\n\t\t\t\t\t\t\t'tagType',\n\t\t\t\t\t\t\t'key',\n\t\t\t\t\t\t\t'style',\n\t\t\t\t\t\t\t'linkMode',\n\t\t\t\t\t\t\t'linkwrap',\n\t\t\t\t\t\t\t'session',\n\t\t\t\t\t\t\t'newer',\n\t\t\t\t\t\t\t'since'\n\t];\n\tqueryParamOptions.sort();\n\t//build simple api query parameters object\n\tvar queryParams = {};\n\tqueryParamOptions.forEach(function(val){\n\t\tif(passedParams.hasOwnProperty(val) && (passedParams[val] !== '')){\n\t\t\tqueryParams[val] = passedParams[val];\n\t\t}\n\t});\n\t\n\t//take out itemKey if it is not a list\n\tif(passedParams.hasOwnProperty('target') && passedParams['target'] !== 'items'){\n\t\tif(queryParams.hasOwnProperty('itemKey') && queryParams['itemKey'].indexOf(',') == -1){\n\t\t\tdelete queryParams['itemKey'];\n\t\t}\n\t}\n\t\n\t//take out collectionKey if it is not a list\n\tif(passedParams.hasOwnProperty('target') && passedParams['target'] !== 'collections'){\n\t\tif(queryParams.hasOwnProperty('collectionKey') && queryParams['collectionKey'].indexOf(',') === -1){\n\t\t\tdelete queryParams['collectionKey'];\n\t\t}\n\t}\n\t\n\t//add each of the found queryParams onto array\n\tObject.keys(queryParams).forEach(function(key){\n\t\tvar value = queryParams[key];\n\t\tif(Array.isArray(value)){\n\t\t\tvalue.forEach(function(v){\n\t\t\t\tif(key == 'tag' && v[0] == '-'){\n\t\t\t\t\tv = '\\\\' + v;\n\t\t\t\t}\n\t\t\t\tqueryParamsArray.push(encodeURIComponent(key) + '=' + encodeURIComponent(v));\n\t\t\t});\n\t\t}\n\t\telse{\n\t\t\tif(key == 'tag' && value[0] == '-'){\n\t\t\t\tvalue = '\\\\' + value;\n\t\t\t}\n\t\t\tqueryParamsArray.push(encodeURIComponent(key) + '=' + encodeURIComponent(value));\n\t\t}\n\t});\n\t\n\t//build query string by concatenating array\n\tqueryString += queryParamsArray.join('&');\n\t//Z.debug(\"resulting queryString:\" + queryString);\n\treturn queryString;\n};\n\nAjax.apiRequestString = function(config){\n\treturn Ajax.apiRequestUrl(config) + Ajax.apiQueryString(config);\n};\n\nAjax.proxyWrapper = function(requestUrl, method){\n\tif(Zotero.config.proxy){\n\t\tif(!method){\n\t\t\tmethod = 'GET';\n\t\t}\n\t\treturn Zotero.config.proxyPath + '?requestMethod=' + method + '&requestUrl=' + encodeURIComponent(requestUrl);\n\t}\n\telse{\n\t\treturn requestUrl;\n\t}\n};\n\nAjax.parseQueryString = function(query){\n\t\n};\n\nAjax.webUrl = function(args){\n\t\n};\n\nAjax.downloadBlob = function(url){\n\treturn new Promise(function(resolve, reject){\n\t\tvar xhr = new XMLHttpRequest();\n\t\tvar blob;\n\t\t\n\t\txhr.open('GET', url, true);\n\t\txhr.responseType = 'blob';\n\t\t\n\t\txhr.addEventListener('load', function () {\n\t\t\tif (xhr.status === 200) {\n\t\t\t\tZ.debug('downloadBlob Image retrieved. resolving', 3);\n\t\t\t\tresolve(xhr.response);\n\t\t\t}\n\t\t\telse {\n\t\t\t\treject(xhr.response);\n\t\t\t}\n\t\t} );\n\t\t// Send XHR\n\t\txhr.send();\n\t});\n};\n\nmodule.exports = Ajax;\n","'use strict';\n\nmodule.exports = function(){\n\tthis.instance = 'Zotero.ApiObject';\n\tthis.version = 0;\n};\n\n//associate Entry with a library so we can update it on the server\nmodule.exports.prototype.associateWithLibrary = function(library){\n\tvar apiObject = this;\n\tapiObject.owningLibrary = library;\n\tif(typeof this.apiObj.library == 'object'){\n\t\tthis.apiObj.library.type = library.type;\n\t\tthis.apiObj.library.id = library.libraryID;\n\t}\n\treturn apiObject;\n};\n\nmodule.exports.prototype.fieldComparer = function(attr){\n\tif(Intl){\n\t\tvar collator = new Intl.Collator();\n\t\treturn function(a, b){\n\t\t\treturn collator.compare(a.apiObj.data[attr], b.apiObj.data[attr]);\n\t\t};\n\t} else {\n\t\treturn function(a, b){\n\t\t\tif(a.apiObj.data[attr].toLowerCase() == b.apiObj.data[attr].toLowerCase()){\n\t\t\t\treturn 0;\n\t\t\t}\n\t\t\tif(a.apiObj.data[attr].toLowerCase() < b.apiObj.data[attr].toLowerCase()){\n\t\t\t\treturn -1;\n\t\t\t}\n\t\t\treturn 1;\n\t\t};\n\t}\n};\n","'use strict';\n\nmodule.exports = function(response) {\n\tZ.debug('Zotero.ApiResponse', 3);\n\tthis.totalResults = 0;\n\tthis.apiVersion = null;\n\tthis.lastModifiedVersion = 0;\n\tthis.linkHeader = '';\n\tthis.links = {};\n\t\n\tif(response){\n\t\tif(!response.isError){\n\t\t\tthis.isError = false;\n\t\t} else {\n\t\t\tthis.isError = true;\n\t\t}\n\t\tthis.data = response.data;\n\t\t//this.jqxhr = response.jqxhr;\n\t\tthis.parseResponse(response);\n\t}\n};\n\nmodule.exports.prototype.parseResponse = function(response){\n\tZ.debug('parseResponse');\n\tvar apiResponse = this;\n\tapiResponse.jqxhr = response.jqxhr;\n\tapiResponse.status = response.jqxhr.status;\n\t//keep track of relevant headers\n\tapiResponse.lastModifiedVersion = response.jqxhr.getResponseHeader('Last-Modified-Version');\n\tapiResponse.apiVersion = response.jqxhr.getResponseHeader('Zotero-API-Version');\n\tapiResponse.backoff = response.jqxhr.getResponseHeader('Backoff');\n\tapiResponse.retryAfter = response.jqxhr.getResponseHeader('Retry-After');\n\tapiResponse.contentType = response.jqxhr.getResponseHeader('Content-Type');\n\tapiResponse.linkHeader = response.jqxhr.getResponseHeader('Link');\n\tapiResponse.totalResults = response.jqxhr.getResponseHeader('Total-Results');\n\tif(apiResponse.backoff){\n\t\tapiResponse.backoff = parseInt(apiResponse.backoff, 10);\n\t}\n\tif(apiResponse.retryAfter){\n\t\tapiResponse.retryAfter = parseInt(apiResponse.retryAfter, 10);\n\t}\n\t//TODO: parse link header into individual links\n\tZ.debug('parse link header');\n\tZ.debug(apiResponse.linkHeader);\n\tif(apiResponse.linkHeader){\n\t\tvar links = apiResponse.linkHeader.split(',');\n\t\tvar parsedLinks = {};\n\t\tvar linkRegex = /^<([^>]+)>; rel=\"([^\\\"]*)\"$/;\n\t\tfor(var i = 0; i < links.length; i++){\n\t\t\tvar matches = linkRegex.exec(links[i].trim());\n\t\t\tif(matches[2]){\n\t\t\t\tparsedLinks[matches[2]] = matches[1];\n\t\t\t}\n\t\t}\n\t\tapiResponse.parsedLinks = parsedLinks;\n\t}\n\tZ.debug('done parsing response');\n};","'use strict';\n\nvar Zotero = {\n\tcallbacks: {},\n\tui: {\n\t\tcallbacks: {},\n\t\tkeyCode: {\n\t\t\tBACKSPACE: 8,\n\t\t\tCOMMA: 188,\n\t\t\tDELETE: 46,\n\t\t\tDOWN: 40,\n\t\t\tEND: 35,\n\t\t\tENTER: 13,\n\t\t\tESCAPE: 27,\n\t\t\tHOME: 36,\n\t\t\tLEFT: 37,\n\t\t\tPAGE_DOWN: 34,\n\t\t\tPAGE_UP: 33,\n\t\t\tPERIOD: 190,\n\t\t\tRIGHT: 39,\n\t\t\tSPACE: 32,\n\t\t\tTAB: 9,\n\t\t\tUP: 38\n\t\t}\n\t},\n\toffline: {},\n\ttemp: {},\n\t\n\tconfig: {librarySettings: {},\n\t\t\tbaseApiUrl: 'https://api.zotero.org',\n\t\t\tbaseWebsiteUrl: 'https://zotero.org',\n\t\t\tbaseFeedUrl: 'https://api.zotero.org',\n\t\t\tbaseZoteroWebsiteUrl: 'https://www.zotero.org',\n\t\t\tbaseDownloadUrl: 'https://www.zotero.org',\n\t\t\tnonparsedBaseUrl: '',\n\t\t\tdebugLogEndpoint: '',\n\t\t\tstoreDebug: true,\n\t\t\tdirectDownloads: true,\n\t\t\tproxyPath: '/proxyrequest',\n\t\t\tignoreLoggedInStatus: false,\n\t\t\tstorePrefsRemote: true,\n\t\t\tpreferUrlItem: true,\n\t\t\tsessionAuth: false,\n\t\t\tproxy: false,\n\t\t\tapiKey: '',\n\t\t\tapiVersion: 3,\n\t\t\tlocale: 'en-US',\n\t\t\tcacheStoreType: 'localStorage',\n\t\t\tpreloadCachedLibrary: true,\n\t\t\tsortOrdering: {\n\t\t\t\t'dateAdded': 'desc',\n\t\t\t\t'dateModified': 'desc',\n\t\t\t\t'date': 'desc',\n\t\t\t\t'year': 'desc',\n\t\t\t\t'accessDate': 'desc',\n\t\t\t\t'title': 'asc',\n\t\t\t\t'creator': 'asc'\n\t\t\t},\n\t\t\tdefaultSortColumn: 'title',\n\t\t\tdefaultSortOrder: 'asc',\n\t\t\tlargeFields: {\n\t\t\t\t'title': 1,\n\t\t\t\t'abstractNote': 1,\n\t\t\t\t'extra' : 1\n\t\t\t},\n\t\t\trichTextFields: {\n\t\t\t\t'note': 1\n\t\t\t},\n\t\t\tmaxFieldSummaryLength: {title:60},\n\t\t\texportFormats: [\n\t\t\t\t'bibtex',\n\t\t\t\t'bookmarks',\n\t\t\t\t'mods',\n\t\t\t\t'refer',\n\t\t\t\t'rdf_bibliontology',\n\t\t\t\t'rdf_dc',\n\t\t\t\t'rdf_zotero',\n\t\t\t\t'ris',\n\t\t\t\t'wikipedia'\n\t\t\t\t],\n\t\t\texportFormatsMap: {\n\t\t\t\t'bibtex': 'BibTeX',\n\t\t\t\t'bookmarks': 'Bookmarks',\n\t\t\t\t'mods': 'MODS',\n\t\t\t\t'refer': 'Refer/BibIX',\n\t\t\t\t'rdf_bibliontology': 'Bibliontology RDF',\n\t\t\t\t'rdf_dc': 'Unqualified Dublin Core RDF',\n\t\t\t\t'rdf_zotero': 'Zotero RDF',\n\t\t\t\t'ris': 'RIS',\n\t\t\t\t'wikipedia': 'Wikipedia Citation Templates'\n\t\t\t},\n\t\t\tdefaultApiArgs: {\n\t\t\t\t'order': 'title',\n\t\t\t\t'sort': 'asc',\n\t\t\t\t'limit': 50,\n\t\t\t\t'start': 0\n\t\t\t}\n\t},\n\t\n\tdebug: function(debugstring, level){\n\t\tvar prefLevel = 3;\n\t\tif(Zotero.config.storeDebug){\n\t\t\tif(level <= prefLevel){\n\t\t\t\tZotero.debugstring += 'DEBUG:' + debugstring + '\\n';\n\t\t\t}\n\t\t}\n\t\tif(typeof console == 'undefined'){\n\t\t\treturn;\n\t\t}\n\t\tif(typeof(level) !== 'number'){\n\t\t\tlevel = 1;\n\t\t}\n\t\tif(Zotero.preferences !== undefined){\n\t\t\tprefLevel = Zotero.preferences.getPref('debug_level');\n\t\t}\n\t\tif(level <= prefLevel) {\n\t\t\tconsole.log(debugstring);\n\t\t}\n\t},\n\t\n\twarn: function(warnstring){\n\t\tif(Zotero.config.storeDebug){\n\t\t\tZotero.debugstring += 'WARN:' + warnstring + '\\n';\n\t\t}\n\t\tif(typeof console == 'undefined' || typeof console.warn == 'undefined'){\n\t\t\tthis.debug(warnstring);\n\t\t}\n\t\telse{\n\t\t\tconsole.warn(warnstring);\n\t\t}\n\t},\n\t\n\terror: function(errorstring){\n\t\tif(Zotero.config.storeDebug){\n\t\t\tZotero.debugstring += 'ERROR:' + errorstring + '\\n';\n\t\t}\n\t\tif(typeof console == 'undefined' || typeof console.error == 'undefined'){\n\t\t\tthis.debug(errorstring);\n\t\t}\n\t\telse{\n\t\t\tconsole.error(errorstring);\n\t\t}\n\t},\n\n\tsubmitDebugLog: function(){\n\t\tZotero.net.ajax({\n\t\t\turl: Zotero.config.debugLogEndpoint,\n\t\t\tdata: {'debug_string': Zotero.debugstring}\n\t\t}).then(function(xhr){\n\t\t\tvar data = JSON.parse(xhr.responseText);\n\t\t\tif(data.logID) {\n\t\t\t\talert('ZoteroWWW debug logID:' + data.logID);\n\t\t\t} else if (data.error) {\n\t\t\t\talert('Error submitting ZoteroWWW debug log:' + data.error);\n\t\t\t}\n\t\t});\n\t},\n\t\n\tcatchPromiseError: function(err){\n\t\tZotero.error(err);\n\t},\n\t\n\tlibraries: {},\n\t\n\tvalidator: {\n\t\tpatterns: {\n\t\t\t//'itemKey': /^([A-Z0-9]{8,},?)+$/,\n\t\t\t'itemKey': /^.+$/,\n\t\t\t'collectionKey': /^([A-Z0-9]{8,})|trash$/,\n\t\t\t//'tag': /^[^#]*$/,\n\t\t\t'libraryID': /^[0-9]+$/,\n\t\t\t'libraryType': /^(user|group|)$/,\n\t\t\t'target': /^(items?|collections?|tags|children|deleted|userGroups|key|settings|publications)$/,\n\t\t\t'targetModifier': /^(top|file|file\\/view)$/,\n\t\t\t\n\t\t\t//get params\n\t\t\t'sort': /^(asc|desc)$/,\n\t\t\t'start': /^[0-9]*$/,\n\t\t\t'limit': /^[0-9]*$/,\n\t\t\t'order': /^\\S*$/,\n\t\t\t'content': /^((html|json|data|bib|none|bibtex|bookmarks|coins|csljson|mods|refer|rdf_bibliontology|rdf_dc|ris|tei|wikipedia),?)+$/,\n\t\t\t'include': /^((html|json|data|bib|none|bibtex|bookmarks|coins|csljson|mods|refer|rdf_bibliontology|rdf_dc|ris|tei|wikipedia),?)+$/,\n\t\t\t'q': /^.*$/,\n\t\t\t'fq': /^\\S*$/,\n\t\t\t'itemType': /^\\S*$/,\n\t\t\t'locale': /^\\S*$/,\n\t\t\t'tag': /^.*$/,\n\t\t\t'tagType': /^(0|1)$/,\n\t\t\t'key': /^\\S*/,\n\t\t\t'format': /^(json|atom|bib|keys|versions|bibtex|bookmarks|mods|refer|rdf_bibliontology|rdf_dc|rdf_zotero|ris|wikipedia)$/,\n\t\t\t'style': /^\\S*$/,\n\t\t\t'linkwrap': /^(0|1)*$/\n\t\t},\n\t\t\n\t\tvalidate: function(arg, type){\n\t\t\tZ.debug('Zotero.validate', 4);\n\t\t\tif(arg === ''){\n\t\t\t\treturn null;\n\t\t\t}\n\t\t\telse if(arg === null){\n\t\t\t\treturn true;\n\t\t\t}\n\t\t\tZ.debug(arg + ' ' + type, 4);\n\t\t\tvar patterns = this.patterns;\n\t\t\t\n\t\t\tif(patterns.hasOwnProperty(type)){\n\t\t\t\treturn patterns[type].test(arg);\n\t\t\t}\n\t\t\telse{\n\t\t\t\treturn null;\n\t\t\t}\n\t\t}\n\t},\n\t\n\t_logEnabled: 0,\n\tenableLogging: function(){\n\t\tZotero._logEnabled++;\n\t\tif(Zotero._logEnabled > 0){\n\t\t\t//TODO: enable debug_log?\n\t\t}\n\t},\n\t\n\tdisableLogging: function(){\n\t\tZotero._logEnabled--;\n\t\tif(Zotero._logEnabled <= 0){\n\t\t\tZotero._logEnabled = 0;\n\t\t\t//TODO: disable debug_log?\n\t\t}\n\t},\n\t\n\tinit: function(){\n\t\tvar store;\n\t\tif(Zotero.config.cacheStoreType == 'localStorage' && typeof localStorage != 'undefined'){\n\t\t\tstore = localStorage;\n\t\t}\n\t\telse if(Zotero.config.cacheStoreType == 'sessionStorage' && typeof sessionStorage != 'undefined'){\n\t\t\tstore = sessionStorage;\n\t\t}\n\t\telse{\n\t\t\tstore = {};\n\t\t}\n\t\tZotero.store = store;\n\t\t\n\t\tZotero.cache = new Zotero.Cache(store);\n\t\t\n\t\t//initialize global preferences object\n\t\tZotero.preferences = new Zotero.Preferences(Zotero.store, 'global');\n\t\t\n\t\t//get localized item constants if not stored in localstorage\n\t\tvar locale = 'en-US';\n\t\tif(Zotero.config.locale){\n\t\t\tlocale = Zotero.config.locale;\n\t\t}\n\t\tlocale = 'en-US';\n\t}\n};\n\n\nZotero.ajaxRequest = function(url, type, options){\n\tZ.debug('Zotero.ajaxRequest ==== ' + url, 3);\n\tif(!type){\n\t\ttype = 'GET';\n\t}\n\tif(!options){\n\t\toptions = {};\n\t}\n\tvar requestObject = {\n\t\turl: url,\n\t\ttype: type\n\t};\n\trequestObject = Z.extend({}, requestObject, options);\n\tZ.debug(requestObject, 3);\n\treturn Zotero.net.queueRequest(requestObject);\n};\n\n//non-DOM (jquery) event management\nZotero.eventmanager = {\n\tcallbacks: {}\n};\n\nZotero.trigger = function(eventType, data={}, filter=false){\n\tif(filter){\n\t\tZ.debug('filter is not false', 3);\n\t\teventType += '_' + filter;\n\t}\n\tZotero.debug('Triggering eventful ' + eventType, 3);\n\tZ.debug(data);\n\t\n\tdata.zeventful = true;\n\t// if(data.triggeringElement === null || data.triggeringElement === undefined){\n\t// \tdata.triggeringElement = J('#eventful');\n\t// }\n\t\n\ttry{\n\t\tif(Zotero.eventmanager.callbacks.hasOwnProperty(eventType)){\n\t\t\tvar callbacks = Zotero.eventmanager.callbacks[eventType];\n\t\t\tcallbacks.forEach(function(callback){\n\t\t\t\tvar cdata = Z.extend({}, data, callback.data);\n\t\t\t\tvar e = {\n\t\t\t\t\tdata: cdata\n\t\t\t\t};\n\t\t\t\tcallback.f(e);\n\t\t\t});\n\t\t}\n\t}\n\tcatch(e){\n\t\tZ.error('failed triggering:' + eventType);\n\t\tZ.error(e);\n\t}\n};\n\nZotero.listen = function(events, handler, data, filter){\n\tZ.debug('Zotero.listen: ' + events);\n\t//append filter to event strings if it's specified\n\tvar eventsArray = events.split(' ');\n\tif(eventsArray.length > 0 && filter){\n\t\tfor(var i = 0; i < eventsArray.length; i++){\n\t\t\teventsArray[i] += '_' + filter;\n\t\t}\n\t}\n\teventsArray.forEach(function(ev){\n\t\tif(Zotero.eventmanager.callbacks.hasOwnProperty(ev)){\n\t\t\tZotero.eventmanager.callbacks[ev].push({\n\t\t\t\tdata: data,\n\t\t\t\tf: handler\n\t\t\t});\n\t\t} else {\n\t\t\tZotero.eventmanager.callbacks[ev] = [{\n\t\t\t\tdata: data,\n\t\t\t\tf: handler\n\t\t\t}];\n\t\t}\n\t});\n};\n\nZotero.extend = function() {\n\tvar res = {};\n\tfor(var i = 0; i < arguments.length; i++){\n\t\tvar a = arguments[i];\n\t\tif(typeof a != 'object'){\n\t\t\tcontinue;\n\t\t}\n\t\tObject.keys(a).forEach(function(key){\n\t\t\tres[key] = a[key];\n\t\t});\n\t}\n\treturn res;\n};\n\nmodule.exports = Zotero;","'use strict';\n\n//build a consistent string from an object to use as a cache key\n//put object key/value pairs into array, sort array, and concatenate\n//array with '/'\nmodule.exports = function(store) {\n\tthis.store = store;\n\tvar registry = this.store._registry;\n\tif(registry === null || typeof registry == 'undefined'){\n\t\tregistry = {};\n\t\tthis.store._registry = JSON.stringify(registry);\n\t}\n};\n\nmodule.exports.prototype.objectCacheString = function(params){\n\tvar paramVarsArray = [];\n\tObject.keys(params).forEach(function(index){\n\t\tvar value = params[index];\n\t\tif(!value) { return; }\n\t\telse if(Array.isArray(value)){\n\t\t\tvalue.forEach(function(v){\n\t\t\t\tparamVarsArray.push(index + '/' + encodeURIComponent(v) );\n\t\t\t});\n\t\t}\n\t\telse{\n\t\t\tparamVarsArray.push(index + '/' + encodeURIComponent(value) );\n\t\t}\n\t});\n\tparamVarsArray.sort();\n\tZ.debug(paramVarsArray, 4);\n\tvar objectCacheString = paramVarsArray.join('/');\n\treturn objectCacheString;\n};\n\n//should use setItem and getItem if I extend that to the case where no Storage object is available in the browser\nmodule.exports.prototype.save = function(params, object, cachetags){\n\t//cachetags for expiring entries\n\tif(!Array.isArray(cachetags)){\n\t\tcachetags = [];\n\t}\n\t//get registry object from storage\n\tvar registry = JSON.parse(this.store._registry);\n\tif(!registry){\n\t\tregistry = {};\n\t}\n\tvar objectCacheString = this.objectCacheString(params);\n\t//save object in storage\n\tthis.store[objectCacheString] = JSON.stringify(object);\n\t//make registry entry for object\n\tvar registryEntry = {'id':objectCacheString, saved:Date.now(), cachetags:cachetags};\n\tregistry[objectCacheString] = registryEntry;\n\t//save registry back to storage\n\tthis.store._registry = JSON.stringify(registry);\n};\n\nmodule.exports.prototype.load = function(params){\n\tZ.debug('Zotero.Cache.load', 3);\n\tvar objectCacheString = this.objectCacheString(params);\n\tZ.debug(objectCacheString, 4);\n\ttry{\n\t\tvar s = this.store[objectCacheString];\n\t\tif(!s){\n\t\t\tZ.warn('No value found in cache store - ' + objectCacheString, 3);\n\t\t\treturn null;\n\t\t}\n\t\telse{\n\t\t\treturn JSON.parse(s);\n\t\t}\n\t}\n\tcatch(e){\n\t\tZ.error('Error parsing retrieved cache data: ' + objectCacheString + ' : ' + s);\n\t\treturn null;\n\t}\n};\n\nmodule.exports.prototype.expireCacheTag = function(tag){\n\tZ.debug('Zotero.Cache.expireCacheTag', 3);\n\tvar registry = JSON.parse(this.store._registry);\n\tvar store = this.store;\n\tObject.keys(registry).forEach(function(index){\n\t\tvar value = registry[index];\n\t\tif(value.cachetags.indexOf(tag) != (-1)){\n\t\t\tZ.debug('tag ' + tag + ' found for item ' + value['id'] + ' : expiring', 4);\n\t\t\tdelete store[value['id']];\n\t\t\tdelete registry[value['id']];\n\t\t}\n\t});\n};\n\nmodule.exports.prototype.clear = function(){\n\tif(typeof(this.store.clear) == 'function'){\n\t\tthis.store.clear();\n\t}\n\telse{\n\t\tthis.store = {};\n\t}\n};","'use strict';\n\nmodule.exports = function(collectionObj){\n\tthis.instance = 'Zotero.Collection';\n\tthis.libraryUrlIdentifier = '';\n\tthis.itemKeys = false;\n\tthis.key = '';\n\tthis.version = 0;\n\tthis.synced = false;\n\tthis.pristineData = null;\n\tthis.apiObj = {\n\t\t'key': '',\n\t\t'version': 0,\n\t\t'library':{},\n\t\t'links':{},\n\t\t'meta':{},\n\t\t'data':{\n\t\t\t'key': '',\n\t\t\t'version': 0,\n\t\t\t'name': '',\n\t\t\t'parentCollection': false,\n\t\t\t'relations':{}\n\t\t}\n\t};\n\tthis.children = [];\n\tthis.topLevel = true;\n\tif(collectionObj){\n\t\tthis.parseJsonCollection(collectionObj);\n\t}\n};\n\nmodule.exports.prototype = new Zotero.ApiObject();\nmodule.exports.prototype.instance = 'Zotero.Collection';\n\nmodule.exports.prototype.updateObjectKey = function(collectionKey){\n\tthis.updateCollectionKey(collectionKey);\n};\n\nmodule.exports.prototype.updateCollectionKey = function(collectionKey){\n\tvar collection = this;\n\tcollection.key = collectionKey;\n\tcollection.apiObj.key = collectionKey;\n\tcollection.apiObj.data.key = collectionKey;\n\treturn collection;\n};\n\nmodule.exports.prototype.parseJsonCollection = function(apiObj) {\n\tZ.debug('parseJsonCollection', 4);\n\tvar collection = this;\n\tcollection.key = apiObj.key;\n\tcollection.version = apiObj.version;\n\tcollection.apiObj = Z.extend({}, apiObj);\n\tcollection.pristineData = Z.extend({}, apiObj.data);\n\n\tcollection.parentCollection = false;\n\tcollection.topLevel = true;\n\tcollection.synced = true;\n\tcollection.initSecondaryData();\n};\n\nmodule.exports.prototype.initSecondaryData = function() {\n\tvar collection = this;\n\t\n\tif(collection.apiObj.data['parentCollection']){\n\t\tcollection.topLevel = false;\n\t} else {\n\t\tcollection.topLevel = true;\n\t}\n\t\n\tif(Zotero.config.librarySettings.libraryPathString){\n\t\tcollection.websiteCollectionLink = Zotero.config.librarySettings.libraryPathString + \n\t\t'/collectionKey/' + collection.apiObj.key;\n\t}\n\telse {\n\t\tcollection.websiteCollectionLink = '';\n\t}\n\tcollection.hasChildren = (collection.apiObj.meta.numCollections) ? true : false;\n\t\n};\n\nmodule.exports.prototype.nestCollection = function(collectionsObject) {\n\tZ.debug('Zotero.Collection.nestCollection', 4);\n\tvar collection = this;\n\tvar parentCollectionKey = collection.get('parentCollection');\n\tif(parentCollectionKey !== false){\n\t\tif(collectionsObject.hasOwnProperty(parentCollectionKey)) {\n\t\t\tvar parentOb = collectionsObject[parentCollectionKey];\n\t\t\tparentOb.children.push(collection);\n\t\t\tparentOb.hasChildren = true;\n\t\t\tcollection.topLevel = false;\n\t\t\treturn true;\n\t\t}\n\t}\n\treturn false;\n};\n\nmodule.exports.prototype.addItems = function(itemKeys){\n\tZ.debug('Zotero.Collection.addItems', 3);\n\tvar collection = this;\n\tvar config = {\n\t\t'target':'items',\n\t\t'libraryType':collection.apiObj.library.type,\n\t\t'libraryID':collection.apiObj.library.id,\n\t\t'collectionKey':collection.key\n\t};\n\tvar requestData = itemKeys.join(' ');\n\t\n\treturn Zotero.ajaxRequest(config, 'POST', {\n\t\tdata: requestData\n\t});\n};\n\nmodule.exports.prototype.getMemberItemKeys = function(){\n\tZ.debug('Zotero.Collection.getMemberItemKeys', 3);\n\tvar collection = this;\n\tvar config = {\n\t\t'target':'items',\n\t\t'libraryType':collection.apiObj.library.type,\n\t\t'libraryID':collection.apiObj.library.id,\n\t\t'collectionKey':collection.key,\n\t\t'format':'keys'\n\t};\n\t\n\treturn Zotero.ajaxRequest(config, 'GET', {processData: false} )\n\t.then(function(response){\n\t\tZ.debug('getMemberItemKeys proxied callback', 3);\n\t\tvar result = response.data;\n\t\tvar keys = result.trim().split(/[\\s]+/);\n\t\tcollection.itemKeys = keys;\n\t\treturn keys;\n\t});\n};\n\nmodule.exports.prototype.removeItem = function(itemKey){\n\tvar collection = this;\n\tvar config = {\n\t\t'target':'item',\n\t\t'libraryType':collection.apiObj.library.type,\n\t\t'libraryID':collection.apiObj.library.id,\n\t\t'collectionKey':collection.key,\n\t\t'itemKey':itemKey\n\t};\n\treturn Zotero.ajaxRequest(config, 'DELETE', {\n\t\tprocessData: false,\n\t\tcache:false\n\t});\n};\n\nmodule.exports.prototype.update = function(name, parentKey){\n\tvar collection = this;\n\tif(!parentKey) parentKey = false;\n\tvar config = {\n\t\t'target':'collection',\n\t\t'libraryType':collection.apiObj.library.type,\n\t\t'libraryID':collection.apiObj.library.id,\n\t\t'collectionKey':collection.key\n\t};\n\t\n\tcollection.set('name', name);\n\tcollection.set('parentCollection', parentKey);\n\t\n\tvar writeObject = collection.writeApiObj();\n\tvar requestData = JSON.stringify(writeObject);\n\t\n\treturn Zotero.ajaxRequest(config, 'PUT', {\n\t\tdata: requestData,\n\t\tprocessData: false,\n\t\theaders:{\n\t\t\t'If-Unmodified-Since-Version': collection.version\n\t\t},\n\t\tcache:false\n\t});\n};\n\nmodule.exports.prototype.writeApiObj = function(){\n\tvar collection = this;\n\tvar writeObj = Z.extend({}, collection.pristineData, collection.apiObj.data);\n\treturn writeObj;\n};\n\nmodule.exports.prototype.remove = function(){\n\tZ.debug('Zotero.Collection.delete', 3);\n\tvar collection = this;\n\tvar owningLibrary = collection.owningLibrary;\n\tvar config = {\n\t\t'target':'collection',\n\t\t'libraryType':collection.apiObj.library.type,\n\t\t'libraryID':collection.apiObj.library.id,\n\t\t'collectionKey':collection.key\n\t};\n\t\n\treturn Zotero.ajaxRequest(config, 'DELETE', {\n\t\tprocessData: false,\n\t\theaders:{\n\t\t\t'If-Unmodified-Since-Version': collection.version\n\t\t},\n\t\tcache:false\n\t}).then(function(){\n\t\tZ.debug('done deleting collection. remove local copy.', 3);\n\t\towningLibrary.collections.removeLocalCollection(collection.key);\n\t\towningLibrary.trigger('libraryCollectionsUpdated');\n\t});\n};\n\nmodule.exports.prototype.get = function(key){\n\tvar collection = this;\n\tswitch(key) {\n\t\tcase 'title':\n\t\tcase 'name':\n\t\treturn collection.apiObj.data.name;\n\t\tcase 'collectionKey':\n\t\tcase 'key':\n\t\treturn collection.apiObj.key || collection.key;\n\t\tcase 'collectionVersion':\n\t\tcase 'version':\n\t\treturn collection.apiObj.version;\n\t\tcase 'parentCollection':\n\t\treturn collection.apiObj.data.parentCollection;\n\t}\n\t\n\tif(key in collection.apiObj.data){\n\t\treturn collection.apiObj.data[key];\n\t}\n\telse if(collection.apiObj.meta.hasOwnProperty(key)){\n\t\treturn collection.apiObj.meta[key];\n\t}\n\telse if(collection.hasOwnProperty(key)){\n\t\treturn collection[key];\n\t}\n\t\n\treturn null;\n};\n/*\n module.exports.prototype.get = function(key){\n\tvar collection = this;\n\tswitch(key) {\n\t\tcase 'title':\n\t\tcase 'name':\n\t\t\treturn collection.apiObj.data['name'];\n\t\tcase 'collectionKey':\n\t\tcase 'key':\n\t\t\treturn collection.apiObj.key;\n\t\tcase 'parentCollection':\n\t\t\treturn collection.apiObj.data['parentCollection'];\n\t\tcase 'collectionVersion':\n\t\tcase 'version':\n\t\t\treturn collection.apiObj.version;\n\t}\n\t\n\tif(key in collection.apiObj.data){\n\t\treturn collection.apiObj.data[key];\n\t}\n\telse if(key in collection.apiObj.meta){\n\t\treturn collection.apiObj.meta[key];\n\t}\n\telse if(collection.hasOwnProperty(key)){\n\t\treturn collection[key];\n\t}\n\t\n\treturn null;\n};\n*/\n\nmodule.exports.prototype.set = function(key, val){\n\tvar collection = this;\n\tif(key in collection.apiObj.data){\n\t\tcollection.apiObj.data[key] = val;\n\t}\n\tswitch(key){\n\t\tcase 'title':\n\t\tcase 'name':\n\t\tcollection.apiObj.data['name'] = val;\n\t\tbreak;\n\t\tcase 'collectionKey':\n\t\tcase 'key':\n\t\tcollection.key = val;\n\t\tcollection.apiObj.key = val;\n\t\tcollection.apiObj.data.key = val;\n\t\tbreak;\n\t\tcase 'parentCollection':\n\t\tcollection.apiObj.data['parentCollection'] = val;\n\t\tbreak;\n\t\tcase 'collectionVersion':\n\t\tcase 'version':\n\t\tcollection.version = val;\n\t\tcollection.apiObj.version = val;\n\t\tcollection.apiObj.data.version = val;\n\t\tbreak;\n\t}\n\t\n\tif(collection.hasOwnProperty(key)) {\n\t\tcollection[key] = val;\n\t}\n};\n","'use strict';\n\nmodule.exports = function(jsonBody){\n\tvar collections = this;\n\tthis.instance = 'Zotero.Collections';\n\tthis.version = 0;\n\tthis.syncState = {\n\t\tearliestVersion: null,\n\t\tlatestVersion: null\n\t};\n\tthis.collectionObjects = {};\n\tthis.collectionsArray = [];\n\tthis.objectMap = this.collectionObjects;\n\tthis.objectArray = this.collectionsArray;\n\tthis.dirty = false;\n\tthis.loaded = false;\n\t\n\tif(jsonBody){\n\t\tthis.addCollectionsFromJson(jsonBody);\n\t\tthis.initSecondaryData();\n\t}\n};\n\n module.exports.prototype = new Zotero.Container();\n//build up secondary data necessary to rendering and easy operations but that\n//depend on all collections already being present\n module.exports.prototype.initSecondaryData = function(){\n\tZ.debug('Zotero.Collections.initSecondaryData', 3);\n\tvar collections = this;\n\t\n\t//rebuild collectionsArray\n\tcollections.collectionsArray = [];\n\tObject.keys(collections.collectionObjects).forEach(function(key){\n\t\tvar collection = collections.collectionObjects[key];\n\t\tcollections.collectionsArray.push(collection);\n\t});\n\t\n\tcollections.collectionsArray.sort(Zotero.ApiObject.prototype.fieldComparer('name'));\n\tcollections.nestCollections();\n\tcollections.assignDepths(0, collections.collectionsArray);\n};\n\n//take Collection XML and insert a Collection object\n module.exports.prototype.addCollection = function(collection){\n\tthis.addObject(collection);\n\treturn this;\n};\n\n module.exports.prototype.addCollectionsFromJson = function(jsonBody){\n\tZ.debug('addCollectionsFromJson');\n\tZ.debug(jsonBody);\n\tvar collections = this;\n\tvar collectionsAdded = [];\n\tjsonBody.forEach(function(collectionObj){\n\t\tvar collection = new Zotero.Collection(collectionObj);\n\t\tcollections.addObject(collection);\n\t\tcollectionsAdded.push(collection);\n\t});\n\treturn collectionsAdded;\n};\n\n module.exports.prototype.assignDepths = function(depth, cArray){\n\tZ.debug('Zotero.Collections.assignDepths', 3);\n\tvar collections = this;\n\tvar insertchildren = function(depth, children){\n\t\tchildren.forEach(function(col){\n\t\t\tcol.nestingDepth = depth;\n\t\t\tif(col.hasChildren){\n\t\t\t\tinsertchildren((depth + 1), col.children);\n\t\t\t}\n\t\t});\n\t};\n\tcollections.collectionsArray.forEach(function(collection){\n\t\tif(collection.topLevel){\n\t\t\tcollection.nestingDepth = 1;\n\t\t\tif(collection.hasChildren){\n\t\t\t\tinsertchildren(2, collection.children);\n\t\t\t}\n\t\t}\n\t});\n};\n\n module.exports.prototype.nestedOrderingArray = function(){\n\tZ.debug('Zotero.Collections.nestedOrderingArray', 3);\n\tvar collections = this;\n\tvar nested = [];\n\tvar insertchildren = function(a, children){\n\t\tchildren.forEach(function(col){\n\t\t\ta.push(col);\n\t\t\tif(col.hasChildren){\n\t\t\t\tinsertchildren(a, col.children);\n\t\t\t}\n\t\t});\n\t};\n\tcollections.collectionsArray.forEach(function(collection){\n\t\tif(collection.topLevel){\n\t\t\tnested.push(collection);\n\t\t\tif(collection.hasChildren){\n\t\t\t\tinsertchildren(nested, collection.children);\n\t\t\t}\n\t\t}\n\t});\n\tZ.debug('Done with nestedOrderingArray', 3);\n\treturn nested;\n};\n\n module.exports.prototype.getCollection = function(key){\n\treturn this.getObject(key);\n};\n\n module.exports.prototype.remoteDeleteCollection = function(collectionKey){\n\tvar collections = this;\n\treturn collections.removeLocalCollection(collectionKey);\n};\n\n module.exports.prototype.removeLocalCollection = function(collectionKey){\n\tvar collections = this;\n\treturn collections.removeLocalCollections([collectionKey]);\n};\n\n module.exports.prototype.removeLocalCollections = function(collectionKeys){\n\tvar collections = this;\n\t//delete Collection from collectionObjects\n\tfor(var i = 0; i < collectionKeys.length; i++){\n\t\tdelete collections.collectionObjects[collectionKeys[i]];\n\t}\n\t\n\t//rebuild collectionsArray\n\tcollections.initSecondaryData();\n};\n\n//reprocess all collections to add references to children inside their parents\n module.exports.prototype.nestCollections = function(){\n\tvar collections = this;\n\t//clear out all child references so we don't duplicate\n\tcollections.collectionsArray.forEach(function(collection){\n\t\tcollection.children = [];\n\t});\n\t\n\tcollections.collectionsArray.sort(Zotero.ApiObject.prototype.fieldComparer('name'));\n\tcollections.collectionsArray.forEach(function(collection){\n\t\tcollection.nestCollection(collections.collectionObjects);\n\t});\n};\n\n module.exports.prototype.writeCollections = function(collectionsArray){\n\tZ.debug('Zotero.Collections.writeCollections', 3);\n\tvar collections = this;\n\tvar library = collections.owningLibrary;\n\tvar i;\n\t\n\tvar config = {\n\t\t'target':'collections',\n\t\t'libraryType':collections.owningLibrary.libraryType,\n\t\t'libraryID':collections.owningLibrary.libraryID\n\t};\n\tvar requestUrl = Zotero.ajax.apiRequestString(config);\n\t\n\t//add collectionKeys to collections if they don't exist yet\n\tfor(i = 0; i < collectionsArray.length; i++){\n\t\tvar collection = collectionsArray[i];\n\t\t//generate a collectionKey if the collection does not already have one\n\t\tvar collectionKey = collection.get('key');\n\t\tif(collectionKey === '' || collectionKey === null) {\n\t\t\tvar newCollectionKey = Zotero.utils.getKey();\n\t\t\tcollection.set('key', newCollectionKey);\n\t\t\tcollection.set('version', 0);\n\t\t}\n\t}\n\n\tvar writeChunks = collections.chunkObjectsArray(collectionsArray);\n\tvar rawChunkObjects = collections.rawChunks(writeChunks);\n\t//update collections with server response if successful\n\tvar writeCollectionsSuccessCallback = function(response){\n\t\tZ.debug('writeCollections successCallback', 3);\n\t\tvar library = this.library;\n\t\tvar writeChunk = this.writeChunk;\n\t\tlibrary.collections.updateObjectsFromWriteResponse(this.writeChunk, response);\n\t\t//save updated collections to collections\n\t\tfor(var i = 0; i < writeChunk.length; i++){\n\t\t\tvar collection = writeChunk[i];\n\t\t\tif(collection.synced && (!collection.writeFailure)) {\n\t\t\t\tlibrary.collections.addCollection(collection);\n\t\t\t\t//save updated collections to IDB\n\t\t\t\tif(Zotero.config.useIndexedDB){\n\t\t\t\t\tZ.debug('updating indexedDB collections');\n\t\t\t\t\tlibrary.idbLibrary.updateCollections(writeChunk);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tresponse.returnCollections = writeChunk;\n\t\treturn response;\n\t};\n\t\n\tZ.debug('collections.version: ' + collections.version, 3);\n\tZ.debug('collections.libraryVersion: ' + collections.libraryVersion, 3);\n\t\n\tvar requestObjects = [];\n\tfor(i = 0; i < writeChunks.length; i++){\n\t\tvar successContext = {\n\t\t\twriteChunk: writeChunks[i],\n\t\t\tlibrary: library\n\t\t};\n\t\t\n\t\tvar requestData = JSON.stringify(rawChunkObjects[i]);\n\t\trequestObjects.push({\n\t\t\turl: requestUrl,\n\t\t\ttype: 'POST',\n\t\t\tdata: requestData,\n\t\t\tprocessData: false,\n\t\t\theaders:{\n\t\t\t\t//'If-Unmodified-Since-Version': collections.version,\n\t\t\t\t//'Content-Type': 'application/json'\n\t\t\t},\n\t\t\tsuccess: writeCollectionsSuccessCallback.bind(successContext)\n\t\t});\n\t}\n\n\treturn library.sequentialRequests(requestObjects)\n\t.then(function(responses){\n\t\tZ.debug('Done with writeCollections sequentialRequests promise', 3);\n\t\tcollections.initSecondaryData();\n\t\t\n\t\tresponses.forEach(function(response){\n\t\t\tif(response.isError || (response.data.hasOwnProperty('failed') && Object.keys(response.data.failed).length > 0) ){\n\t\t\t\tthrow new Error('failure when writing collections');\n\t\t\t}\n\t\t});\n\t\treturn responses;\n\t})\n\t.catch(function(err){\n\t\tZ.error(err);\n\t\t//rethrow so widget doesn't report success\n\t\tthrow(err);\n\t});\n};\n","'use strict';\n\nmodule.exports = function(){\n\t\n};\n\nmodule.exports.prototype.initSecondaryData = function(){\n\t\n};\n\nmodule.exports.prototype.addObject = function(object){\n\tZotero.debug('Zotero.Container.addObject', 4);\n\tvar container = this;\n\tcontainer.objectArray.push(object);\n\tcontainer.objectMap[object.key] = object;\n\tif(container.owningLibrary){\n\t\tobject.associateWithLibrary(container.owningLibrary);\n\t}\n\t\n\treturn container;\n};\n\nmodule.exports.prototype.fieldComparer = function(field){\n\tif(Intl){\n\t\tvar collator = new Intl.Collator();\n\t\treturn function(a, b){\n\t\t\treturn collator.compare(a.apiObj.data[field], b.apiObj.data[field]);\n\t\t};\n\t} else {\n\t\treturn function(a, b){\n\t\t\tif(a.apiObj.data[field].toLowerCase() == b.apiObj.data[field].toLowerCase()){\n\t\t\t\treturn 0;\n\t\t\t}\n\t\t\tif(a.apiObj.data[field].toLowerCase() < b.apiObj.data[field].toLowerCase()){\n\t\t\t\treturn -1;\n\t\t\t}\n\t\t\treturn 1;\n\t\t};\n\t}\n};\n\nmodule.exports.prototype.getObject = function(key){\n\tvar container = this;\n\tif(container.objectMap.hasOwnProperty(key)){\n\t\treturn container.objectMap[key];\n\t}\n\telse{\n\t\treturn false;\n\t}\n};\n\nmodule.exports.prototype.getObjects = function(keys){\n\tvar container = this;\n\tvar objects = [];\n\tvar object;\n\tfor(var i = 0; i < keys.length; i++){\n\t\tobject = container.getObject(keys[i]);\n\t\tif(object){\n\t\t\tobjects.push(object);\n\t\t}\n\t}\n\treturn objects;\n};\n\nmodule.exports.prototype.removeObject = function(key){\n\tvar container = this;\n\tif(container.objectMap.hasOwnProperty(key)){\n\t\tdelete container.objectmap[key];\n\t\tcontainer.initSecondaryData();\n\t}\n};\n\nmodule.exports.prototype.removeObjects = function(keys){\n\tvar container = this;\n\t//delete Objects from objectMap;\n\tfor(var i = 0; i < keys.length; i++){\n\t\tdelete container.objectMap[keys[i]];\n\t}\n\t\n\t//rebuild array\n\tcontainer.initSecondaryData();\n};\n\nmodule.exports.prototype.writeObjects = function(objects){\n\t//TODO:implement\n};\n\n//generate keys for objects about to be written if they are new\nmodule.exports.prototype.assignKeys = function(objectsArray){\n\tvar object;\n\tfor(var i = 0; i < objectsArray.length; i++){\n\t\tobject = objectsArray[i];\n\t\tvar key = object.get('key');\n\t\tif(!key) {\n\t\t\tvar newObjectKey = Zotero.utils.getKey();\n\t\t\tobject.set('key', newObjectKey);\n\t\t\tobject.set('version', 0);\n\t\t}\n\t}\n\treturn objectsArray;\n};\n\n//split an array of objects into chunks to write over multiple api requests\nmodule.exports.prototype.chunkObjectsArray = function(objectsArray){\n\tvar chunkSize = 50;\n\tvar writeChunks = [];\n\t\n\tfor(var i = 0; i < objectsArray.length; i = i + chunkSize){\n\t\twriteChunks.push(objectsArray.slice(i, i+chunkSize));\n\t}\n\t\n\treturn writeChunks;\n};\n\nmodule.exports.prototype.rawChunks = function(chunks){\n\tvar rawChunkObjects = [];\n\t\n\tfor(var i = 0; i < chunks.length; i++){\n\t\trawChunkObjects[i] = [];\n\t\tfor(var j = 0; j < chunks[i].length; j++){\n\t\t\trawChunkObjects[i].push(chunks[i][j].writeApiObj());\n\t\t}\n\t}\n\treturn rawChunkObjects;\n};\n\n/**\n * Update syncState property on container to keep track of updates that occur during sync process.\n * Set earliestVersion to MIN(earliestVersion, version).\n * Set latestVersion to MAX(latestVersion, version).\n * This should be called with the modifiedVersion header for each response tied to this container\n * during a sync process.\n * @param  {int} version\n * @return {null}\n */\nmodule.exports.prototype.updateSyncState = function(version) {\n\tvar container = this;\n\tZ.debug('updateSyncState: ' + version, 3);\n\tif(!container.hasOwnProperty('syncState')){\n\t\tZ.debug('no syncState property');\n\t\tthrow new Error('Attempt to update sync state of object with no syncState property');\n\t}\n\tif(container.syncState.earliestVersion === null){\n\t\tcontainer.syncState.earliestVersion = version;\n\t}\n\tif(container.syncState.latestVersion === null){\n\t\tcontainer.syncState.latestVersion = version;\n\t}\n\tif(version < container.syncState.earliestVersion){\n\t\tcontainer.syncState.earliestVersion = version;\n\t}\n\tif(version > container.syncState.latestVersion){\n\t\tcontainer.syncState.latestVersion = version;\n\t}\n\tZ.debug('done updating sync state', 3);\n};\n\nmodule.exports.prototype.updateSyncedVersion = function(versionField) {\n\tvar container = this;\n\tif(container.syncState.earliestVersion !== null &&\n\t\t(container.syncState.earliestVersion == container.syncState.latestVersion) ){\n\t\tcontainer.version = container.syncState.latestVersion;\n\t\tcontainer.synced = true;\n\t}\n\telse if(container.syncState.earliestVersion !== null) {\n\t\tcontainer.version = container.syncState.earliestVersion;\n\t}\n};\n\nmodule.exports.prototype.processDeletions = function(deletedKeys) {\n\tvar container = this;\n\tfor(var i = 0; i < deletedKeys.length; i++){\n\t\tvar localObject = container.get(deletedKeys[i]);\n\t\tif(localObject !== false){\n\t\t\t//still have object locally\n\t\t\tif(localObject.synced === true){\n\t\t\t\t//our object is not modified, so delete it as the server thinks we should\n\t\t\t\tcontainer.removeObjects([deletedKeys[i]]);\n\t\t\t}\n\t\t\telse {\n\t\t\t\t//TODO: conflict resolution\n\t\t\t}\n\t\t}\n\t}\n};\n\n//update items appropriately based on response to multi-write request\n//for success:\n//  update objectKey if item doesn't have one yet (newly created item)\n//  update itemVersion to response's Last-Modified-Version header\n//  mark as synced\n//for unchanged:\n//  don't need to do anything? itemVersion should remain the same?\n//  mark as synced if not already?\n//for failed:\n//  add the failure to the object under writeFailure\n//  don't mark as synced\n//  calling code should check for writeFailure after the written objects\n//  are returned\nmodule.exports.prototype.updateObjectsFromWriteResponse = function(objectsArray, response){\n\tZ.debug('Zotero.Container.updateObjectsFromWriteResponse', 3);\n\tZ.debug('statusCode: ' + response.status, 3);\n\tvar data = response.data;\n\tif(response.status == 200){\n\t\tZ.debug('newLastModifiedVersion: ' + response.lastModifiedVersion, 3);\n\t\t//make sure writes were actually successful and\n\t\t//update the itemKey for the parent\n\t\tif(data.hasOwnProperty('success')){\n\t\t\t//update each successfully written item, possibly with new itemKeys\n\t\t\tObject.keys(data.success).forEach(function(ind){\n\t\t\t\tvar i = parseInt(ind, 10);\n\t\t\t\tvar key = data.success[ind];\n\t\t\t\tvar object = objectsArray[i];\n\t\t\t\t//throw error if objectKey mismatch\n\t\t\t\tif(object.key !== '' && object.key !== key){\n\t\t\t\t\tthrow new Error('object key mismatch in multi-write response');\n\t\t\t\t}\n\t\t\t\tif(object.key === ''){\n\t\t\t\t\tobject.updateObjectKey(key);\n\t\t\t\t}\n\t\t\t\tobject.set('version', response.lastModifiedVersion);\n\t\t\t\tobject.synced = true;\n\t\t\t\tobject.writeFailure = false;\n\t\t\t});\n\t\t}\n\t\tif(data.hasOwnProperty('failed')){\n\t\t\tZ.debug('updating objects with failed writes', 3);\n\t\t\tObject.keys(data.failed).forEach(function(ind){\n\t\t\t\tvar failure = data.failed[ind];\n\t\t\t\tZ.error('failed write ' + ind + ' - ' + failure);\n\t\t\t\tvar i = parseInt(ind, 10);\n\t\t\t\tvar object = objectsArray[i];\n\t\t\t\tobject.writeFailure = failure;\n\t\t\t});\n\t\t}\n\t}\n\telse if(response.status == 204){\n\t\t//single item put response, this probably should never go to this function\n\t\tobjectsArray[0].synced = true;\n\t}\n};\n\n//return the key as a string when passed an argument that \n//could be either a string key or an object with a key property\nmodule.exports.prototype.extractKey = function(object){\n\tif(typeof object == 'string'){\n\t\treturn object;\n\t}\n\treturn object.get('key');\n};\n","'use strict';\n\nmodule.exports = function(data){\n\tthis.instance = 'Zotero.Deleted';\n\tif(typeof data === 'string'){\n\t\tthis.deletedData = JSON.parse(data);\n\t}\n\telse {\n\t\tthis.deletedData = data;\n\t}\n\tthis.untilVersion = null;\n\tthis.sinceVersion = null;\n\tthis.waitingPromises = [];\n\tthis.pending = false;\n};\n\n//create, save referece, and return a Promise that will be resolved\n//the next time we finish a deleted request\nmodule.exports.prototype.addWaiter = function(){\n\t\n};\n","'use strict';\n\nvar SparkMD5 = require('spark-md5');\n\n\nmodule.exports = {};\n\nmodule.exports.getFileInfo = function(file){\n\t//fileInfo: md5, filename, filesize, mtime, zip, contentType, charset\n\tif(typeof FileReader === 'undefined'){\n\t\treturn Promise.reject(new Error('FileReader not supported'));\n\t}\n\t\n\treturn new Promise(function(resolve, reject){\n\t\tvar fileInfo = {};\n\t\tvar reader = new FileReader();\n\t\treader.onload = function(e){\n\t\t\tZ.debug('Zotero.file.getFileInfo onloadFunc', 3);\n\t\t\tvar result = e.target.result;\n\t\t\tZotero.debug(result, 3);\n\t\t\tfileInfo.md5 = SparkMD5.ArrayBuffer.hash(result);\n\t\t\tfileInfo.filename = file.name;\n\t\t\tfileInfo.filesize = file.size;\n\t\t\tfileInfo.mtime = Date.now();\n\t\t\tfileInfo.contentType = file.type;\n\t\t\t//fileInfo.reader = reader;\n\t\t\tfileInfo.filedata = result;\n\t\t\tresolve(fileInfo);\n\t\t};\n\t\t\n\t\treader.readAsArrayBuffer(file);\n\t});\n};\n\nmodule.exports.uploadFile = function(uploadInfo, fileInfo){\n\tZ.debug('Zotero.file.uploadFile', 3);\n\tZ.debug(uploadInfo, 4);\n\t\n\tvar formData = new FormData();\n\tObject.keys(uploadInfo.params).forEach(function(key){\n\t\tvar val = uploadInfo.params[key];\n\t\tformData.append(key, val);\n\t});\n\t\n\tvar blobData = new Blob([fileInfo.filedata], {type : fileInfo.contentType});\n\tformData.append('file', blobData);\n\t\n\tvar xhr = new XMLHttpRequest();\n\t\n\txhr.open('POST', uploadInfo.url, true);\n\t\n\treturn new Promise(function(resolve, reject){\n\t\txhr.onload = function(evt){\n\t\t\tZ.debug('uploadFile onload event', 3);\n\t\t\tif(this.status == 201){\n\t\t\t\tZ.debug('successful upload - 201', 3);\n\t\t\t\tresolve();\n\t\t\t}\n\t\t\telse {\n\t\t\t\tZ.error('uploadFile failed - ' + xhr.status);\n\t\t\t\treject({\n\t\t\t\t\t'message': 'Failure uploading file.',\n\t\t\t\t\t'code': xhr.status,\n\t\t\t\t\t'serverMessage': xhr.responseText\n\t\t\t\t});\n\t\t\t}\n\t\t};\n\t\t\n\t\txhr.onprogress = function(evt){\n\t\t\tZ.debug('progress event');\n\t\t\tZ.debug(evt);\n\t\t};\n\t\txhr.send(formData);\n\t});\n\t\n\t//If CORS is not enabled on s3 this XHR will not have the normal status\n\t//information, but will still fire readyStateChanges so you can tell\n\t//when the upload has finished (even if you can't tell if it was successful\n\t//from JS)\n};\n\n","'use strict';\n\nmodule.exports = function (groupObj) {\n\tvar group = this;\n\tgroup.instance = 'Zotero.Group';\n\tif(groupObj){\n\t\tthis.parseJsonGroup(groupObj);\n\t}\n};\n\nmodule.exports.prototype = new Zotero.ApiObject();\n\nmodule.exports.prototype.parseJsonGroup = function(groupObj) {\n\tvar group = this;\n\tgroup.apiObj = groupObj;\n};\n\nmodule.exports.prototype.get = function(key) {\n\tvar group = this;\n\tswitch(key) {\n\t\tcase 'title':\n\t\tcase 'name':\n\t\t\treturn group.apiObj.data.name;\n\t}\n\t\n\tif(key in group.apiObj){\n\t\treturn group.apiObj[key];\n\t}\n\tif(key in group.apiObj.data){\n\t\treturn group.apiObj.data[key];\n\t}\n\tif(key in group.apiObj.meta){\n\t\treturn group.apiObj.meta[key];\n\t}\n\tif(group.hasOwnProperty(key)){\n\t\treturn group[key];\n\t}\n\t\n\treturn null;\n};\n\nmodule.exports.prototype.isWritable = function(userID){\n\tvar group = this;\n\tswitch(true){\n\t\tcase group.get('owner') == userID:\n\t\t\treturn true;\n\t\tcase (group.apiObj.data.admins && (group.apiObj.data.admins.indexOf(userID) != -1) ):\n\t\t\treturn true;\n\t\tcase ((group.apiObj.data.libraryEditing == 'members') &&\n\t\t\t(group.apiObj.data.members) &&\n\t\t\t(group.apiObj.data.members.indexOf(userID) != -1)):\n\t\t\treturn true;\n\t\tdefault:\n\t\t\treturn false;\n\t}\n};\n\nmodule.exports.prototype.typeMap = {\n\t'Private': 'Private',\n\t'PublicOpen': 'Public, Open Membership',\n\t'PublicClosed': 'Public, Closed Membership'\n};\n\nmodule.exports.prototype.accessMap = {\n\t'all'     : {\n\t\t'members' : 'Anyone can view, only members can edit',\n\t\t'admins'  : 'Anyone can view, only admins can edit'\n\t},\n\t'members' : {\n\t\t'members' : 'Only members can view and edit',\n\t\t'admins'  : 'Only members can view, only admins can edit'\n\t},\n\t'admins'  : {\n\t\t'members' : 'Only admins can view, only members can edit',\n\t\t'admins'  : 'Only admins can view and edit'\n\t}\n};\n\n","'use strict';\n\nmodule.exports = function(){\n \tthis.instance = 'Zotero.Groups';\n \tthis.groupsArray = [];\n };\n/*\n module.exports.prototype.fetchGroup = function(groupID, apikey){\n\t//TODO: implement\n};\n*/\nmodule.exports.prototype.addGroupsFromJson = function(jsonBody){\n\tvar groups = this;\n\tvar groupsAdded = [];\n\tjsonBody.forEach(function(groupObj){\n\t\tZ.debug(groupObj, 3);\n\t\tvar group = new Zotero.Group(groupObj);\n\t\tgroups.groupsArray.push(group);\n\t\tgroupsAdded.push(group);\n\t});\n\treturn groupsAdded;\n};\n\nmodule.exports.prototype.fetchUserGroups = function(userID, apikey){\n\tvar groups = this;\n\tvar aparams = {\n\t\t'target':'userGroups',\n\t\t'libraryType':'user',\n\t\t'libraryID': userID,\n\t\t'order':'title'\n\t};\n\t\n\tif(apikey){\n\t\taparams['key'] = apikey;\n\t}\n\telse if(groups.owningLibrary) {\n\t\taparams['key'] = groups.owningLibrary._apiKey;\n\t}\n\t\n\treturn Zotero.ajaxRequest(aparams)\n\t.then(function(response){\n\t\tZ.debug('fetchUserGroups proxied callback', 3);\n\t\tvar fetchedGroups = groups.addGroupsFromJson(response.data);\n\t\tresponse.fetchedGroups = fetchedGroups;\n\t\treturn response;\n\t});\n};\n\n","'use strict';\n\nmodule.exports = {};\n\n//Initialize an indexedDB for the specified library user or group + id\n//returns a promise that is resolved with a Zotero.Idb.Library instance when successful\n//and rejected onerror\nmodule.exports.Library = function(libraryString){\n\tZ.debug('Zotero.Idb.Library', 3);\n\tZ.debug('Initializing Zotero IDB', 3);\n\tthis.libraryString = libraryString;\n\tthis.owningLibrary = null;\n\tthis.initialized = false;\n};\n\nmodule.exports.Library.prototype.init = function(){\n\tvar idbLibrary = this;\n\treturn new Promise(function(resolve, reject){\n\t\t//Don't bother with the prefixed names because they should all be irrelevant by now\n\t\tvar indexedDB = window.indexedDB;\n\t\tidbLibrary.indexedDB = indexedDB;\n\t\t\n\t\t// Now we can open our database\n\t\tZ.debug('requesting indexedDb from browser', 3);\n\t\tvar request = indexedDB.open('Zotero_' + idbLibrary.libraryString, 4);\n\t\trequest.onerror = function(e){\n\t\t\tZotero.error('ERROR OPENING INDEXED DB');\n\t\t\treject();\n\t\t};\n\t\t\n\t\tvar upgradeCallback = function(event){\n\t\t\tZ.debug('Zotero.Idb onupgradeneeded or onsuccess', 3);\n\t\t\tvar oldVersion = event.oldVersion;\n\t\t\tZ.debug('oldVersion: ' + event.oldVersion, 3);\n\t\t\tvar db = event.target.result;\n\t\t\tidbLibrary.db = db;\n\t\t\t\n\t\t\tif(oldVersion < 4){\n\t\t\t\t//delete old versions of object stores\n\t\t\t\tZ.debug('Existing object store names:', 3);\n\t\t\t\tZ.debug(JSON.stringify(db.objectStoreNames), 3);\n\t\t\t\tZ.debug('Deleting old object stores', 3);\n\t\t\t\tif(db.objectStoreNames['items']){\n\t\t\t\t\tdb.deleteObjectStore('items');\n\t\t\t\t}\n\t\t\t\tif(db.objectStoreNames['tags']){\n\t\t\t\t\tdb.deleteObjectStore('tags');\n\t\t\t\t}\n\t\t\t\tif(db.objectStoreNames['collections']){\n\t\t\t\t\tdb.deleteObjectStore('collections');\n\t\t\t\t}\n\t\t\t\tif(db.objectStoreNames['files']){\n\t\t\t\t\tdb.deleteObjectStore('files');\n\t\t\t\t}\n\t\t\t\tif(db.objectStoreNames['versions']){\n\t\t\t\t\tdb.deleteObjectStore('versions');\n\t\t\t\t}\n\t\t\t\tZ.debug('Existing object store names:', 3);\n\t\t\t\tZ.debug(JSON.stringify(db.objectStoreNames), 3);\n\t\t\t\t\n\t\t\t\t// Create object stores to hold items, collections, and tags.\n\t\t\t\t// IDB keys are just the zotero object keys\n\t\t\t\tvar itemStore = db.createObjectStore('items', { keyPath: 'key' });\n\t\t\t\tvar collectionStore = db.createObjectStore('collections', { keyPath: 'key' });\n\t\t\t\tvar tagStore = db.createObjectStore('tags', { keyPath: 'tag' });\n\t\t\t\tvar fileStore = db.createObjectStore('files');\n\t\t\t\tvar versionStore = db.createObjectStore('versions');\n\t\t\t\t\n\t\t\t\tZ.debug('itemStore index names:', 3);\n\t\t\t\tZ.debug(JSON.stringify(itemStore.indexNames), 3);\n\t\t\t\tZ.debug('collectionStore index names:', 3);\n\t\t\t\tZ.debug(JSON.stringify(collectionStore.indexNames), 3);\n\t\t\t\tZ.debug('tagStore index names:', 3);\n\t\t\t\tZ.debug(JSON.stringify(tagStore.indexNames), 3);\n\t\t\t\t\n\t\t\t\t// Create index to search/sort items by each attribute\n\t\t\t\tObject.keys(Zotero.Item.prototype.fieldMap).forEach(function(key){\n\t\t\t\t\tZ.debug('Creating index on ' + key, 3);\n\t\t\t\t\titemStore.createIndex(key, 'data.' + key, { unique: false });\n\t\t\t\t});\n\t\t\t\t\n\t\t\t\t//itemKey index was created above with all other item fields\n\t\t\t\t//itemStore.createIndex(\"itemKey\", \"itemKey\", { unique: false });\n\t\t\t\t\n\t\t\t\t//create multiEntry indices on item collectionKeys and tags\n\t\t\t\titemStore.createIndex('collectionKeys', 'data.collections', {unique: false, multiEntry:true});\n\t\t\t\t//index on extra tagstrings array since tags are objects and we can't index them directly\n\t\t\t\titemStore.createIndex('itemTagStrings', '_supplement.tagstrings', {unique: false, multiEntry:true});\n\t\t\t\t//example filter for tag: Zotero.Idb.filterItems(\"itemTagStrings\", \"Unread\");\n\t\t\t\t//example filter collection: Zotero.Idb.filterItems(\"collectionKeys\", \"<collectionKey>\");\n\t\t\t\t\n\t\t\t\t//itemStore.createIndex(\"itemType\", \"itemType\", { unique: false });\n\t\t\t\titemStore.createIndex('parentItemKey', 'data.parentItem', { unique: false });\n\t\t\t\titemStore.createIndex('libraryKey', 'libraryKey', { unique: false });\n\t\t\t\titemStore.createIndex('deleted', 'data.deleted', { unique: false });\n\t\t\t\t\n\t\t\t\tcollectionStore.createIndex('name', 'data.name', { unique: false });\n\t\t\t\tcollectionStore.createIndex('key', 'key', { unique: false });\n\t\t\t\tcollectionStore.createIndex('parentCollection', 'data.parentCollection', { unique: false });\n\t\t\t\t//collectionStore.createIndex(\"libraryKey\", \"libraryKey\", { unique: false });\n\t\t\t\t\n\t\t\t\ttagStore.createIndex('tag', 'tag', { unique: false });\n\t\t\t\t//tagStore.createIndex(\"libraryKey\", \"libraryKey\", { unique: false });\n\t\t\t}\n\t\t};\n\t\t\n\t\trequest.onupgradeneeded = upgradeCallback;\n\t\t\n\t\trequest.onsuccess = function(){\n\t\t\tZ.debug('IDB success', 3);\n\t\t\tidbLibrary.db = request.result;\n\t\t\tidbLibrary.initialized = true;\n\t\t\tresolve(idbLibrary);\n\t\t};\n\t});\n};\n\nmodule.exports.Library.prototype.deleteDB = function(){\n\tvar idbLibrary = this;\n\tidbLibrary.db.close();\n\treturn new Promise(function(resolve, reject){\n\t\tvar deleteRequest = idbLibrary.indexedDB.deleteDatabase('Zotero_' + idbLibrary.libraryString);\n\t\tdeleteRequest.onerror = function(){\n\t\t\tZ.error('Error deleting indexedDB');\n\t\t\treject();\n\t\t};\n\t\tdeleteRequest.onsuccess = function(){\n\t\t\tZ.debug('Successfully deleted indexedDB', 2);\n\t\t\tresolve();\n\t\t};\n\t});\n};\n\n/**\n* @param {string} store_name\n* @param {string} mode either \"readonly\" or \"readwrite\"\n*/\nmodule.exports.Library.prototype.getObjectStore = function (store_name, mode) {\n\tvar idbLibrary = this;\n\tvar tx = idbLibrary.db.transaction(store_name, mode);\n\treturn tx.objectStore(store_name);\n};\n\nmodule.exports.Library.prototype.clearObjectStore = function (store_name) {\n\tvar idbLibrary = this;\n\tvar store = idbLibrary.getObjectStore(store_name, 'readwrite');\n\treturn new Promise(function(resolve, reject){\n\t\tvar req = store.clear();\n\t\treq.onsuccess = function(evt) {\n\t\t\tZ.debug('Store cleared', 3);\n\t\t\tresolve();\n\t\t};\n\t\treq.onerror = function (evt) {\n\t\t\tZ.error('clearObjectStore:', evt.target.errorCode);\n\t\t\treject();\n\t\t};\n\t});\n};\n\n/**\n* Add array of items to indexedDB\n* @param {array} items\n*/\nmodule.exports.Library.prototype.addItems = function(items){\n\treturn this.addObjects(items, 'item');\n};\n\n/**\n* Update/add array of items to indexedDB\n* @param {array} items\n*/\nmodule.exports.Library.prototype.updateItems = function(items){\n\treturn this.updateObjects(items, 'item');\n};\n\n/**\n* Remove array of items to indexedDB. Just references itemKey and does no other checks that items match\n* @param {array} items\n*/\nmodule.exports.Library.prototype.removeItems = function(items){\n\treturn this.removeObjects(items, 'item');\n};\n\n/**\n* Get item from indexedDB that has given itemKey\n* @param {string} itemKey\n*/\nmodule.exports.Library.prototype.getItem = function(itemKey){\n\tvar idbLibrary = this;\n\treturn new Promise(function(resolve, reject){\n\t\tvar success = function(event){\n\t\t\tresolve(event.target.result);\n\t\t};\n\t\tidbLibrary.db.transaction('items').objectStore(['items'], 'readonly').get(itemKey).onsuccess = success;\n\t});\n};\n\n/**\n* Get all the items in this indexedDB\n* @param {array} items\n*/\nmodule.exports.Library.prototype.getAllItems = function(){\n\treturn this.getAllObjects('item');\n};\n\nmodule.exports.Library.prototype.getOrderedItemKeys = function(field, order){\n\tvar idbLibrary = this;\n\tZ.debug('Zotero.Idb.getOrderedItemKeys', 3);\n\tZ.debug('' + field + ' ' + order, 3);\n\treturn new Promise(function(resolve, reject){\n\t\tvar objectStore = idbLibrary.db.transaction(['items'], 'readonly').objectStore('items');\n\t\tvar index = objectStore.index(field);\n\t\tif(!index){\n\t\t\tthrow new Error(\"Index for requested field '\" + field + \"'' not found\");\n\t\t}\n\t\t\n\t\tvar cursorDirection = 'next';\n\t\tif(order == 'desc'){\n\t\t\tcursorDirection = 'prev';\n\t\t}\n\t\t\n\t\tvar cursorRequest = index.openKeyCursor(null, cursorDirection);\n\t\tvar itemKeys = [];\n\t\tcursorRequest.onsuccess = function(event) {\n\t\t\tvar cursor = event.target.result;\n\t\t\tif (cursor) {\n\t\t\t\titemKeys.push(cursor.primaryKey);\n\t\t\t\tcursor.continue();\n\t\t\t}\n\t\t\telse {\n\t\t\t\tZ.debug('No more cursor: done. Resolving deferred.', 3);\n\t\t\t\tresolve(itemKeys);\n\t\t\t}\n\t\t}.bind(this);\n\t\t\n\t\tcursorRequest.onfailure = function(event){\n\t\t\treject();\n\t\t}.bind(this);\n\t});\n};\n\n//filter the items in indexedDB by value in field\nmodule.exports.Library.prototype.filterItems = function(field, value){\n\tvar idbLibrary = this;\n\tZ.debug('Zotero.Idb.filterItems ' + field + ' - ' + value, 3);\n\treturn new Promise(function(resolve, reject){\n\t\tvar itemKeys = [];\n\t\tvar objectStore = idbLibrary.db.transaction(['items'], 'readonly').objectStore('items');\n\t\tvar index = objectStore.index(field);\n\t\tif(!index){\n\t\t\tthrow new Error(\"Index for requested field '\" + field + \"'' not found\");\n\t\t}\n\t\t\n\t\tvar cursorDirection = 'next';\n\t\t/*if(order == \"desc\"){\n\t\t\tcursorDirection = \"prev\";\n\t\t}*/\n\t\t\n\t\tvar range = IDBKeyRange.only(value);\n\t\tvar cursorRequest = index.openKeyCursor(range, cursorDirection);\n\t\tcursorRequest.onsuccess = function(event) {\n\t\t\tvar cursor = event.target.result;\n\t\t\tif (cursor) {\n\t\t\t\titemKeys.push(cursor.primaryKey);\n\t\t\t\tcursor.continue();\n\t\t\t}\n\t\t\telse {\n\t\t\t\tZ.debug('No more cursor: done. Resolving deferred.', 3);\n\t\t\t\tresolve(itemKeys);\n\t\t\t}\n\t\t}.bind(this);\n\t\t\n\t\tcursorRequest.onfailure = function(event){\n\t\t\treject();\n\t\t}.bind(this);\n\t});\n};\n\nmodule.exports.Library.prototype.inferType = function(object){\n\tif(!object){\n\t\treturn false;\n\t}\n\tif(!object.instance){\n\t\treturn false;\n\t}\n\tswitch(object.instance){\n\t\tcase 'Zotero.Item':\n\t\t\treturn 'item';\n\t\tcase 'Zotero.Collection':\n\t\t\treturn 'collection';\n\t\tcase 'Zotero.Tag':\n\t\t\treturn 'tag';\n\t\tdefault:\n\t\t\treturn false;\n\t}\n};\n\nmodule.exports.Library.prototype.getTransactionAndStore = function(type, access){\n\tvar idbLibrary = this;\n\tvar transaction;\n\tvar objectStore;\n\tswitch(type){\n\t\tcase 'item':\n\t\t\ttransaction = idbLibrary.db.transaction(['items'], access);\n\t\t\tobjectStore = transaction.objectStore('items');\n\t\t\tbreak;\n\t\tcase 'collection':\n\t\t\ttransaction = idbLibrary.db.transaction(['collections'], access);\n\t\t\tobjectStore = transaction.objectStore('collections');\n\t\t\tbreak;\n\t\tcase 'tag':\n\t\t\ttransaction = idbLibrary.db.transaction(['tags'], access);\n\t\t\tobjectStore = transaction.objectStore('tags');\n\t\t\tbreak;\n\t\tdefault:\n\t\t\treturn Promise.reject();\n\t}\n\treturn [transaction, objectStore];\n};\n\nmodule.exports.Library.prototype.addObjects = function(objects, type){\n\tZ.debug('Zotero.Idb.Library.addObjects', 3);\n\tvar idbLibrary = this;\n\tif(!type){\n\t\ttype = idbLibrary.inferType(objects[0]);\n\t}\n\tvar TS = idbLibrary.getTransactionAndStore(type, 'readwrite');\n\tvar transaction = TS[0];\n\tvar objectStore = TS[1];\n\t\n\treturn new Promise(function(resolve, reject){\n\t\ttransaction.oncomplete = function(event){\n\t\t\tZotero.debug('Add Objects transaction completed.', 3);\n\t\t\tresolve();\n\t\t};\n\t\t\n\t\ttransaction.onerror = function(event){\n\t\t\tZotero.error('Add Objects transaction failed.');\n\t\t\treject();\n\t\t};\n\t\t\n\t\tvar reqSuccess = function(event){\n\t\t\tZotero.debug('Added Object ' + event.target.result, 4);\n\t\t};\n\t\tfor (var i in objects) {\n\t\t\tvar request = objectStore.add(objects[i].apiObj);\n\t\t\trequest.onsuccess = reqSuccess;\n\t\t}\n\t});\n};\n\nmodule.exports.Library.prototype.updateObjects = function(objects, type){\n\tZ.debug('Zotero.Idb.Library.updateObjects', 3);\n\tvar idbLibrary = this;\n\tif(!type){\n\t\ttype = idbLibrary.inferType(objects[0]);\n\t}\n\tvar TS = idbLibrary.getTransactionAndStore(type, 'readwrite');\n\tvar transaction = TS[0];\n\tvar objectStore = TS[1];\n\t\n\treturn new Promise(function(resolve, reject){\n\t\ttransaction.oncomplete = function(event){\n\t\t\tZotero.debug('Update Objects transaction completed.', 3);\n\t\t\tresolve();\n\t\t};\n\t\t\n\t\ttransaction.onerror = function(event){\n\t\t\tZotero.error('Update Objects transaction failed.');\n\t\t\treject();\n\t\t};\n\t\t\n\t\tvar reqSuccess = function(event){\n\t\t\tZotero.debug('Updated Object ' + event.target.result, 4);\n\t\t};\n\t\tfor (var i in objects) {\n\t\t\tvar request = objectStore.put(objects[i].apiObj);\n\t\t\trequest.onsuccess = reqSuccess;\n\t\t}\n\t});\n};\n\nmodule.exports.Library.prototype.removeObjects = function(objects, type){\n\tvar idbLibrary = this;\n\tif(!type){\n\t\ttype = idbLibrary.inferType(objects[0]);\n\t}\n\tvar TS = idbLibrary.getTransactionAndStore(type, 'readwrite');\n\tvar transaction = TS[0];\n\tvar objectStore = TS[1];\n\t\n\treturn new Promise(function(resolve, reject){\n\t\ttransaction.oncomplete = function(event){\n\t\t\tZotero.debug('Remove Objects transaction completed.', 3);\n\t\t\tresolve();\n\t\t};\n\t\t\n\t\ttransaction.onerror = function(event){\n\t\t\tZotero.error('Remove Objects transaction failed.');\n\t\t\treject();\n\t\t};\n\t\t\n\t\tvar reqSuccess = function(event){\n\t\t\tZotero.debug('Removed Object ' + event.target.result, 4);\n\t\t};\n\t\tfor (var i in objects) {\n\t\t\tvar request = objectStore.delete(objects[i].key);\n\t\t\trequest.onsuccess = reqSuccess;\n\t\t}\n\t});\n};\n\nmodule.exports.Library.prototype.getAllObjects = function(type){\n\tvar idbLibrary = this;\n\treturn new Promise(function(resolve, reject){\n\t\tvar objects = [];\n\t\tvar objectStore = idbLibrary.db.transaction(type + 's').objectStore(type + 's');\n\t\t\n\t\tobjectStore.openCursor().onsuccess = function(event) {\n\t\t\tvar cursor = event.target.result;\n\t\t\tif (cursor) {\n\t\t\t\tobjects.push(cursor.value);\n\t\t\t\tcursor.continue();\n\t\t\t}\n\t\t\telse {\n\t\t\t\tresolve(objects);\n\t\t\t}\n\t\t};\n\t});\n};\n\nmodule.exports.Library.prototype.addCollections = function(collections){\n\treturn this.addObjects(collections, 'collection');\n};\n\nmodule.exports.Library.prototype.updateCollections = function(collections){\n\tZ.debug('Zotero.Idb.Library.updateCollections', 3);\n\treturn this.updateObjects(collections, 'collection');\n};\n\n/**\n* Get collection from indexedDB that has given collectionKey\n* @param {string} collectionKey\n*/\nmodule.exports.Library.prototype.getCollection = function(collectionKey){\n\tvar idbLibrary = this;\n\treturn new Promise(function(resolve, reject){\n\t\tvar success = function(event){\n\t\t\tresolve(event.target.result);\n\t\t};\n\t\tidbLibrary.db.transaction('collections').objectStore(['collections'], 'readonly').get(collectionKey).onsuccess = success;\n\t});\n};\n\nmodule.exports.Library.prototype.removeCollections = function(collections){\n\tZ.debug('Zotero.Idb.Library.removeCollections', 3);\n\treturn this.removeObjects(collections, 'collection');\n};\n\nmodule.exports.Library.prototype.getAllCollections = function(){\n\tZ.debug('Zotero.Idb.Library.getAllCollections', 3);\n\treturn this.getAllObjects('collection');\n};\n\nmodule.exports.Library.prototype.addTags = function(tags){\n\treturn this.addObjects(tags, 'tag');\n};\n\nmodule.exports.Library.prototype.updateTags = function(tags){\n\tZ.debug('Zotero.Idb.Library.updateTags', 3);\n\treturn this.updateObjects(tags, 'tag');\n};\n\nmodule.exports.Library.prototype.getAllTags = function(){\n\tZ.debug('getAllTags', 3);\n\treturn this.getAllObjects('tag');\n};\n\nmodule.exports.Library.prototype.setVersion = function(type, version){\n\tZ.debug('Zotero.Idb.Library.setVersion', 3);\n\tvar idbLibrary = this;\n\treturn new Promise(function(resolve, reject){\n\t\tvar transaction = idbLibrary.db.transaction(['versions'], 'readwrite');\n\t\t\n\t\ttransaction.oncomplete = function(event){\n\t\t\tZotero.debug('set version transaction completed.', 3);\n\t\t\tresolve();\n\t\t};\n\t\t\n\t\ttransaction.onerror = function(event){\n\t\t\tZotero.error('set version transaction failed.');\n\t\t\treject();\n\t\t};\n\t\t\n\t\tvar versionStore = transaction.objectStore('versions');\n\t\tvar reqSuccess = function(event){\n\t\t\tZotero.debug('Set Version' + event.target.result, 3);\n\t\t};\n\t\tvar request = versionStore.put(version, type);\n\t\trequest.onsuccess = reqSuccess;\n\t});\n};\n\n/**\n* Get version data from indexedDB\n* @param {string} type\n*/\nmodule.exports.Library.prototype.getVersion = function(type){\n\tZ.debug('Zotero.Idb.Library.getVersion', 3);\n\tvar idbLibrary = this;\n\treturn new Promise(function(resolve, reject){\n\t\tvar success = function(event){\n\t\t\tZ.debug('done getting version');\n\t\t\tresolve(event.target.result);\n\t\t};\n\t\tidbLibrary.db.transaction(['versions'], 'readonly').objectStore('versions').get(type).onsuccess = success;\n\t});\n};\n\nmodule.exports.Library.prototype.setFile = function(itemKey, fileData){\n\tZ.debug('Zotero.Idb.Library.setFile', 3);\n\tvar idbLibrary = this;\n\treturn new Promise(function(resolve, reject){\n\t\tvar transaction = idbLibrary.db.transaction(['files'], 'readwrite');\n\t\t\n\t\ttransaction.oncomplete = function(event){\n\t\t\tZotero.debug('set file transaction completed.', 3);\n\t\t\tresolve();\n\t\t};\n\t\t\n\t\ttransaction.onerror = function(event){\n\t\t\tZotero.error('set file transaction failed.');\n\t\t\treject();\n\t\t};\n\t\t\n\t\tvar fileStore = transaction.objectStore('files');\n\t\tvar reqSuccess = function(event){\n\t\t\tZotero.debug('Set File' + event.target.result, 3);\n\t\t};\n\t\tvar request = fileStore.put(fileData, itemKey);\n\t\trequest.onsuccess = reqSuccess;\n\t});\n};\n\n/**\n* Get item from indexedDB that has given itemKey\n* @param {string} itemKey\n*/\nmodule.exports.Library.prototype.getFile = function(itemKey){\n\tZ.debug('Zotero.Idb.Library.getFile', 3);\n\tvar idbLibrary = this;\n\treturn new Promise(function(resolve, reject){\n\t\tvar success = function(event){\n\t\t\tZ.debug('done getting file');\n\t\t\tresolve(event.target.result);\n\t\t};\n\t\tidbLibrary.db.transaction(['files'], 'readonly').objectStore('files').get(itemKey).onsuccess = success;\n\t});\n};\n\nmodule.exports.Library.prototype.deleteFile = function(itemKey){\n\tZ.debug('Zotero.Idb.Library.deleteFile', 3);\n\tvar idbLibrary = this;\n\treturn new Promise(function(resolve, reject){\n\t\tvar transaction = idbLibrary.db.transaction(['files'], 'readwrite');\n\t\t\n\t\ttransaction.oncomplete = function(event){\n\t\t\tZotero.debug('delete file transaction completed.', 3);\n\t\t\tresolve();\n\t\t};\n\t\t\n\t\ttransaction.onerror = function(event){\n\t\t\tZotero.error('delete file transaction failed.');\n\t\t\treject();\n\t\t};\n\t\t\n\t\tvar fileStore = transaction.objectStore('files');\n\t\tvar reqSuccess = function(event){\n\t\t\tZotero.debug('Deleted File' + event.target.result, 4);\n\t\t};\n\t\tvar request = fileStore.delete(itemKey);\n\t\trequest.onsuccess = reqSuccess;\n\t});\n};\n\n\n//intersect two arrays of strings as an AND condition on index results\nmodule.exports.Library.prototype.intersect = function(ar1, ar2){\n\tvar idbLibrary = this;\n\tvar result = [];\n\tfor(var i = 0; i < ar1.length; i++){\n\t\tif(ar2.indexOf(ar1[i]) !== -1){\n\t\t\tresult.push(ar1[i]);\n\t\t}\n\t}\n\treturn result;\n};\n\n//intersect an array of arrays of strings as an AND condition on index results\nmodule.exports.Library.prototype.intersectAll = function(arrs) {\n\tvar idbLibrary = this;\n\tvar result = arrs[0];\n\tfor(var i = 0; i < arrs.length - 1; i++){\n\t\tresult = idbLibrary.intersect(result, arrs[i+1]);\n\t}\n\treturn result;\n};\n","'use strict';\n\nvar striptags = require('striptags');\nvar ItemMaps = require('./ItemMaps.js');\n\n/*\n * TODO: several functions should not work unless we build a fresh item with a template\n * or parsed an item from the api with json content (things that depend on apiObj)\n * There should be a flag to note whether this is the case and throwing on attempts to\n * use these functions when it is not.\n */\nvar Item = function(itemObj){\n\tthis.instance = 'Zotero.Item';\n\tthis.version = 0;\n\tthis.key = '';\n\tthis.synced = false;\n\tthis.apiObj = {};\n\tthis.pristineData = null;\n\tthis.childItemKeys = [];\n\tthis.writeErrors = [];\n\tthis.notes = [];\n\tif(itemObj){\n\t\tthis.parseJsonItem(itemObj);\n\t} else {\n\t\tthis.parseJsonItem(this.emptyJsonItem());\n\t}\n\tthis.initSecondaryData();\n};\n\nItem.prototype = new Zotero.ApiObject();\n\nItem.prototype.parseJsonItem = function (apiObj) {\n\tZ.debug('parseJsonItem', 3);\n\tvar item = this;\n\titem.version = apiObj.version;\n\titem.key = apiObj.key;\n\titem.apiObj = Z.extend({}, apiObj);\n\titem.pristineData = Z.extend({}, apiObj.data);\n\tif(!item.apiObj._supplement){\n\t\titem.apiObj._supplement = {};\n\t}\n};\n\nItem.prototype.emptyJsonItem = function(){\n\treturn {\n\t\tkey: '',\n\t\tversion: 0,\n\t\tlibrary:{},\n\t\tlinks:{},\n\t\tdata: {\n\t\t\tkey:'',\n\t\t\tversion:0,\n\t\t\ttitle:'',\n\t\t\tcreators:[],\n\t\t\tcollections:[],\n\t\t\ttags:[],\n\t\t\trelations:{}\n\t\t},\n\t\tmeta: {},\n\t\t_supplement: {}\n\t};\n};\n\n//populate property values derived from json content\nItem.prototype.initSecondaryData = function(){\n\tZ.debug('initSecondaryData', 3);\n\tvar item = this;\n\t\n\titem.version = item.apiObj.version;\n\t\n\tif(item.apiObj.data.itemType == 'attachment'){\n\t\titem.mimeType = item.apiObj.data.contentType;\n\t\titem.translatedMimeType = Zotero.utils.translateMimeType(item.mimeType);\n\t}\n\tif('linkMode' in item.apiObj){\n\t\titem.linkMode = item.apiObj.data.linkMode;\n\t}\n\t\n\titem.attachmentDownloadUrl = Zotero.url.attachmentDownloadUrl(item);\n\t\n\tif(item.apiObj.meta.parsedDate){\n\t\titem.parsedDate = new Date(item.apiObj.meta.parsedDate);\n\t} else {\n\t\titem.parsedDate = false;\n\t}\n\t\n\titem.synced = false;\n\n\titem.updateTagStrings();\n\tZ.debug('done with initSecondaryData', 3);\n};\n\nItem.prototype.updateTagStrings = function(){\n\tvar item = this;\n\tvar tagstrings = [];\n\tfor (var i = 0; i < item.apiObj.data.tags.length; i++) {\n\t\ttagstrings.push(item.apiObj.data.tags[i].tag);\n\t}\n\titem.apiObj._supplement.tagstrings = tagstrings;\n};\n\nItem.prototype.initEmpty = function(itemType, linkMode){\n\tvar item = this;\n\treturn item.getItemTemplate(itemType, linkMode)\n\t.then(function(template){\n\t\titem.initEmptyFromTemplate(template);\n\t\treturn item;\n\t});\n};\n\n//special case note initialization to guarentee synchronous and simplify some uses\nItem.prototype.initEmptyNote = function(){\n\tvar item = this;\n\titem.version = 0;\n\tvar noteTemplate = {'itemType':'note','note':'','tags':[],'collections':[],'relations':{}};\n\t\n\titem.initEmptyFromTemplate(noteTemplate);\n\t\n\treturn item;\n};\n\nItem.prototype.initEmptyFromTemplate = function(template){\n\tvar item = this;\n\titem.version = 0;\n\t\n\titem.key = '';\n\titem.pristineData = Z.extend({}, template);\n\titem.apiObj = {\n\t\tkey: '',\n\t\tversion: 0,\n\t\tlibrary: {},\n\t\tlinks: {},\n\t\tdata: template,\n\t\tmeta: {},\n\t\t_supplement: {}\n\t};\n\t\n\titem.initSecondaryData();\n\treturn item;\n};\n\nItem.prototype.isSupplementaryItem = function(){\n\tvar item = this;\n\tvar itemType = item.get('itemType');\n\tif(itemType == 'attachment' || itemType == 'note'){\n\t\treturn true;\n\t}\n\treturn false;\n};\n\nItem.prototype.isSnapshot = function(){\n\tvar item = this;\n\tif(item.apiObj.links['enclosure']){\n\t\tvar ftype = item.apiObj.links['enclosure'].type;\n\t\tif(!item.apiObj.links['enclosure']['length'] && ftype == 'text/html'){\n\t\t\treturn true;\n\t\t}\n\t}\n\treturn false;\n};\n\nItem.prototype.updateObjectKey = function(objectKey){\n\treturn this.updateItemKey(objectKey);\n};\n\nItem.prototype.updateItemKey = function(itemKey){\n\tvar item = this;\n\titem.key = itemKey;\n\titem.apiObj.key = itemKey;\n\titem.apiObj.data.key = itemKey;\n\titem.pristineData.key = itemKey;\n\treturn item;\n};\n\n/*\n * Write updated information for the item to the api and potentiallyp\n * create new child notes (or attachments?) of this item\n */\nItem.prototype.writeItem = function(){\n\tvar item = this;\n\tif(!item.owningLibrary){\n\t\tthrow new Error('Item must be associated with a library');\n\t}\n\treturn item.owningLibrary.items.writeItems([item]);\n};\n\n//get the JS object to be PUT/POSTed for write\nItem.prototype.writeApiObj = function(){\n\tvar item = this;\n\t\n\t//remove any creators that have no names\n\tif(item.apiObj.data.creators){\n\t\tvar newCreatorsArray = item.apiObj.data.creators.filter(function(c){\n\t\t\tif(c.name || c.firstName || c.lastName){\n\t\t\t\treturn true;\n\t\t\t}\n\t\t\treturn false;\n\t\t});\n\t\titem.apiObj.data.creators = newCreatorsArray;\n\t}\n\t\n\t//copy apiObj, extend with pristine to make sure required fields are present\n\t//and remove unwriteable fields(?)\n\tvar writeApiObj = Z.extend({}, item.pristineData, item.apiObj.data);\n\treturn writeApiObj;\n};\n\nItem.prototype.createChildNotes = function(notes){\n\tvar item = this;\n\tvar childItems = [];\n\tvar childItemPromises = [];\n\t\n\tnotes.forEach(function(note){\n\t\tvar childItem = new Item();\n\t\tvar p = childItem.initEmpty('note')\n\t\t.then(function(noteItem){\n\t\t\tnoteItem.set('note', note.note);\n\t\t\tnoteItem.set('parentItem', item.key);\n\t\t\tchildItems.push(noteItem);\n\t\t});\n\t\tchildItemPromises.push(p);\n\t});\n\t\n\treturn Promise.all(childItemPromises)\n\t.then(function(){\n\t\treturn item.owningLibrary.writeItems(childItems);\n\t});\n};\n\n//TODO: implement\nItem.prototype.writePatch = function(){\n\t\n};\n\nItem.prototype.getChildren = function(library){\n\tZ.debug('Zotero.Item.getChildren');\n\tvar item = this;\n\treturn Promise.resolve()\n\t.then(function(){\n\t\t//short circuit if has item has no children\n\t\tif(!item.apiObj.meta.numChildren){\n\t\t\treturn [];\n\t\t}\n\t\t\n\t\tvar config = {\n\t\t\turl: {\n\t\t\t\t'target':'children',\n\t\t\t\t'libraryType':item.apiObj.library.type,\n\t\t\t\t'libraryID':item.apiObj.library.id,\n\t\t\t\t'itemKey':item.key\n\t\t\t}\n\t\t};\n\t\t\n\t\treturn Zotero.net.queueRequest(config)\n\t\t.then(function(response){\n\t\t\tZ.debug('getChildren proxied callback', 4);\n\t\t\tvar items = library.items;\n\t\t\tvar childItems = items.addItemsFromJson(response.data);\n\t\t\tfor (var i = childItems.length - 1; i >= 0; i--) {\n\t\t\t\tchildItems[i].associateWithLibrary(library);\n\t\t\t}\n\t\t\t\n\t\t\treturn childItems;\n\t\t});\n\t});\n};\n\nItem.prototype.getItemTypes = function (locale) {\n\tZ.debug('Zotero.Item.prototype.getItemTypes', 3);\n\tif(!locale){\n\t\tlocale = 'en-US';\n\t}\n\tlocale = 'en-US';\n\n\tvar itemTypes = Zotero.cache.load({locale:locale, target:'itemTypes'});\n\tif(itemTypes){\n\t\tZ.debug('have itemTypes in localStorage', 3);\n\t\tItem.prototype.itemTypes = itemTypes;//JSON.parse(Zotero.storage.localStorage['itemTypes']);\n\t\treturn;\n\t}\n\t\n\tvar query = Zotero.ajax.apiQueryString({locale:locale});\n\tvar url = Zotero.config.baseApiUrl + '/itemTypes' + query;\n\tZotero.net.ajax({\n\t\turl: Zotero.ajax.proxyWrapper(url, 'GET'),\n\t\ttype: 'GET'\n\t}).then(function(xhr){\n\t\tZ.debug('got itemTypes response', 3);\n\t\tZ.debug(xhr.response, 4);\n\t\tItem.prototype.itemTypes = JSON.parse(xhr.responseText);\n\t\tZotero.cache.save({locale:locale, target:'itemTypes'}, Item.prototype.itemTypes);\n\t});\n};\n\nItem.prototype.getItemFields = function (locale) {\n\tZ.debug('Zotero.Item.prototype.getItemFields', 3);\n\tif(!locale){\n\t\tlocale = 'en-US';\n\t}\n\tlocale = 'en-US';\n\t\n\tvar itemFields = Zotero.cache.load({locale:locale, target:'itemFields'});\n\tif(itemFields){\n\t\tZ.debug('have itemFields in localStorage', 3);\n\t\tItem.prototype.itemFields = itemFields;//JSON.parse(Zotero.storage.localStorage['itemFields']);\n\t\tObject.keys(Item.prototype.itemFields).forEach(function(key){\n\t\t\tvar val = Item.prototype.itemFields[key];\n\t\t\tZotero.localizations.fieldMap[val.field] = val.localized;\n\t\t});\n\t\treturn;\n\t}\n\t\n\tvar query = Zotero.ajax.apiQueryString({locale:locale});\n\tvar requestUrl = Zotero.config.baseApiUrl + '/itemFields' + query;\n\tZotero.net.ajax({\n\t\turl: Zotero.ajax.proxyWrapper(requestUrl),\n\t\ttype: 'GET'\n\t}).then(function(xhr){\n\t\tZ.debug('got itemTypes response', 4);\n\t\tvar data = JSON.parse(xhr.responseText);\n\t\tItem.prototype.itemFields = data;\n\t\tZotero.cache.save({locale:locale, target:'itemFields'}, data);\n\t\t//Zotero.storage.localStorage['itemFields'] = JSON.stringify(data);\n\t\tObject.keys(Item.prototype.itemFields).forEach(function(key){\n\t\t\tvar val = Item.prototype.itemFields[key];\n\t\t\tZotero.localizations.fieldMap[val.field] = val.localized;\n\t\t});\n\t});\n};\n\nItem.prototype.getItemTemplate = function (itemType='document', linkMode='') {\n\tZ.debug('Zotero.Item.prototype.getItemTemplate', 3);\n\tif(itemType == 'attachment' && linkMode == ''){\n\t\tthrow new Error('attachment template requested with no linkMode');\n\t}\n\t\n\tvar query = Zotero.ajax.apiQueryString({itemType:itemType, linkMode:linkMode});\n\tvar requestUrl = Zotero.config.baseApiUrl + '/items/new' + query;\n\t\n\tvar cacheConfig = {itemType:itemType, target:'itemTemplate'};\n\tvar itemTemplate = Zotero.cache.load(cacheConfig);\n\tif(itemTemplate){\n\t\tZ.debug('have itemTemplate in localStorage', 3);\n\t\tvar template = itemTemplate;// JSON.parse(Zotero.storage.localStorage[url]);\n\t\treturn Promise.resolve(template);\n\t}\n\t\n\treturn Zotero.ajaxRequest(requestUrl, 'GET', {dataType:'json'})\n\t.then(function(response){\n\t\tZ.debug('got itemTemplate response', 3);\n\t\tZotero.cache.save(cacheConfig, response.data);\n\t\treturn response.data;\n\t});\n};\n\nItem.prototype.getUploadAuthorization = function(fileinfo){\n\t//fileInfo: md5, filename, filesize, mtime, zip, contentType, charset\n\tZ.debug('Zotero.Item.getUploadAuthorization', 3);\n\tvar item = this;\n\t\n\tvar config = {\n\t\t'target':'item',\n\t\t'targetModifier':'file',\n\t\t'libraryType':item.owningLibrary.type,\n\t\t'libraryID':item.owningLibrary.libraryID,\n\t\t'itemKey':item.key\n\t};\n\tvar headers = {\n\t\t'Content-Type': 'application/x-www-form-urlencoded'\n\t};\n\tvar oldmd5 = item.get('md5');\n\tif(oldmd5){\n\t\theaders['If-Match'] = oldmd5;\n\t}\n\telse{\n\t\theaders['If-None-Match'] = '*';\n\t}\n\t\n\treturn Zotero.ajaxRequest(config, 'POST',\n\t\t{\n\t\t\tprocessData: true,\n\t\t\tdata:fileinfo,\n\t\t\theaders:headers\n\t\t}\n\t);\n};\n\nItem.prototype.registerUpload = function(uploadKey){\n\tZ.debug('Zotero.Item.registerUpload', 3);\n\tvar item = this;\n\tvar config = {\n\t\t'target':'item',\n\t\t'targetModifier':'file',\n\t\t'libraryType':item.owningLibrary.type,\n\t\t'libraryID':item.owningLibrary.libraryID,\n\t\t'itemKey':item.key\n\t};\n\tvar headers = {\n\t\t'Content-Type': 'application/x-www-form-urlencoded'\n\t};\n\tvar oldmd5 = item.get('md5');\n\tif(oldmd5){\n\t\theaders['If-Match'] = oldmd5;\n\t}\n\telse{\n\t\theaders['If-None-Match'] = '*';\n\t}\n\t\n\treturn Zotero.ajaxRequest(config, 'POST',\n\t{\n\t\tprocessData: true,\n\t\tdata:{upload: uploadKey},\n\t\theaders: headers\n\t});\n};\n\nItem.prototype.fullUpload = function(file){\n\n};\n\nItem.prototype.creatorTypes = {};\n\nItem.prototype.getCreatorTypes = function (itemType) {\n\tZ.debug('Zotero.Item.prototype.getCreatorTypes: ' + itemType, 3);\n\tif(!itemType){\n\t\titemType = 'document';\n\t}\n\t\n\t//parse stored creatorTypes object if it exists\n\t//creatorTypes maps itemType to the possible creatorTypes\n\tvar creatorTypes = Zotero.cache.load({target:'creatorTypes'});\n\tif(creatorTypes){\n\t\tZ.debug('have creatorTypes in localStorage', 3);\n\t\tItem.prototype.creatorTypes = creatorTypes;//JSON.parse(Zotero.storage.localStorage['creatorTypes']);\n\t}\n\t\n\tif(Item.prototype.creatorTypes[itemType]){\n\t\tZ.debug('creatorTypes of requested itemType available in localStorage', 3);\n\t\tZ.debug(Item.prototype.creatorTypes, 4);\n\t\treturn Promise.resolve(Item.prototype.creatorTypes[itemType]);\n\t}\n\telse{\n\t\tZ.debug('sending request for creatorTypes', 3);\n\t\tvar query = Zotero.ajax.apiQueryString({itemType:itemType});\n\t\t//TODO: this probably shouldn't be using baseApiUrl directly\n\t\tvar requestUrl = Zotero.config.baseApiUrl + '/itemTypeCreatorTypes' + query;\n\t\t\n\t\treturn Zotero.ajaxRequest(requestUrl, 'GET', {dataType:'json'})\n\t\t.then(function(response){\n\t\t\tZ.debug('got creatorTypes response', 4);\n\t\t\tItem.prototype.creatorTypes[itemType] = response.data;\n\t\t\t//Zotero.storage.localStorage['creatorTypes'] = JSON.stringify(Item.prototype.creatorTypes);\n\t\t\tZotero.cache.save({target:'creatorTypes'}, Item.prototype.creatorTypes);\n\t\t\treturn Item.prototype.creatorTypes[itemType];\n\t\t});\n\t}\n};\n\nItem.prototype.getCreatorFields = function (locale) {\n\tZ.debug('Zotero.Item.prototype.getCreatorFields', 3);\n\tvar creatorFields = Zotero.cache.load({target:'creatorFields'});\n\tif(creatorFields){\n\t\tZ.debug('have creatorFields in localStorage', 3);\n\t\tItem.prototype.creatorFields = creatorFields;// JSON.parse(Zotero.storage.localStorage['creatorFields']);\n\t\treturn Promise.resolve(creatorFields);\n\t}\n\t\n\tvar requestUrl = Zotero.config.baseApiUrl + '/creatorFields';\n\treturn Zotero.ajaxRequest(requestUrl, 'GET', {dataType:'json'})\n\t.then(function(response){\n\t\tZ.debug('got itemTypes response', 4);\n\t\tItem.prototype.creatorFields = response.data;\n\t\tZotero.cache.save({target:'creatorFields'}, response.data);\n\t});\n};\n\n//---Functions to manually add Zotero format data instead of fetching it from the API ---\n//To be used first with cached data for offline, could also maybe be used for custom types\nItem.prototype.addItemTypes = function(itemTypes, locale){\n\t\n};\n\nItem.prototype.addItemFields = function(itemType, itemFields){\n\t\n};\n\nItem.prototype.addCreatorTypes = function(itemType, creatorTypes){\n\t\n};\n\nItem.prototype.addCreatorFields = function(itemType, creatorFields){\n\t\n};\n\nItem.prototype.addItemTemplates = function(templates){\n\t\n};\n\nItem.prototype.itemTypeImageClass = function(){\n\t//linkModes: imported_file,imported_url,linked_file,linked_url\n\tvar item = this;\n\tif(item.apiObj.data.itemType == 'attachment'){\n\t\tswitch(item.apiObj.data.linkMode){\n\t\t\tcase 'imported_file':\n\t\t\t\tif(item.translatedMimeType == 'pdf'){\n\t\t\t\t\treturn item.itemTypeImageSrc['attachmentPdf'];\n\t\t\t\t}\n\t\t\t\treturn item.itemTypeImageSrc['attachmentFile'];\n\t\t\tcase 'imported_url':\n\t\t\t\tif(item.translatedMimeType == 'pdf'){\n\t\t\t\t\treturn item.itemTypeImageSrc['attachmentPdf'];\n\t\t\t\t}\n\t\t\t\treturn item.itemTypeImageSrc['attachmentSnapshot'];\n\t\t\tcase 'linked_file':\n\t\t\t\treturn item.itemTypeImageSrc['attachmentLink'];\n\t\t\tcase 'linked_url':\n\t\t\t\treturn item.itemTypeImageSrc['attachmentWeblink'];\n\t\t\tdefault:\n\t\t\t\treturn item.itemTypeImageSrc['attachment'];\n\t\t}\n\t}\n\telse {\n\t\treturn item.apiObj.data.itemType;\n\t}\n};\n\nItem.prototype.itemTypeIconClass = function(){\n\t//linkModes: imported_file,imported_url,linked_file,linked_url\n\tvar item = this;\n\tvar defaultIcon = 'fa fa-file-text-o';\n\tswitch(item.apiObj.data.itemType){\n\t\tcase 'attachment':\n\t\t\tswitch(item.apiObj.data.linkMode){\n\t\t\t\tcase 'imported_file':\n\t\t\t\t\tif(item.translatedMimeType == 'pdf'){\n\t\t\t\t\t\treturn 'fa fa-file-pdf-o';\n\t\t\t\t\t}\n\t\t\t\t\treturn 'glyphicons glyphicons-file';\n\t\t\t\tcase 'imported_url':\n\t\t\t\t\tif(item.translatedMimeType == 'pdf'){\n\t\t\t\t\t\treturn 'fa fa-file-pdf-o';\n\t\t\t\t\t}\n\t\t\t\t\treturn 'glyphicons glyphicons-file';\n\t\t\t\tcase 'linked_file':\n\t\t\t\t\treturn 'glyphicons glyphicons-link';\n\t\t\t\t\t//return item.itemTypeImageSrc['attachmentLink'];\n\t\t\t\tcase 'linked_url':\n\t\t\t\t\treturn 'glyphicons glyphicons-link';\n\t\t\t\t\t//return item.itemTypeImageSrc['attachmentWeblink'];\n\t\t\t\tdefault:\n\t\t\t\t\treturn 'glyphicons glyphicons-paperclip';\n\t\t\t\t\t//return item.itemTypeImageSrc['attachment'];\n\t\t\t}\n\t\t\treturn 'glyphicons file';\n\t\tcase 'artwork':\n\t\t\treturn 'glyphicons glyphicons-picture';\n\t\tcase 'audioRecording':\n\t\t\treturn 'glyphicons glyphicons-microphone';\n\t\tcase 'bill':\n\t\t\treturn defaultIcon;\n\t\tcase 'blogPost':\n\t\t\treturn 'glyphicons glyphicons-blog';\n\t\tcase 'book':\n\t\t\treturn 'glyphicons glyphicons-book';\n\t\tcase 'bookSection':\n\t\t\treturn 'glyphicons glyphicons-book-open';\n\t\tcase 'case':\n\t\t\treturn defaultIcon;\n\t\tcase 'computerProgram':\n\t\t\treturn 'glyphicons glyphicons-floppy-disk';\n\t\tcase 'conferencePaper':\n\t\t\treturn defaultIcon;\n\t\tcase 'dictionaryEntry':\n\t\t\treturn 'glyphicons glyphicons-translate';\n\t\tcase 'document':\n\t\t\treturn 'glyphicons glyphicons-file';\n\t\tcase 'email':\n\t\t\treturn 'glyphicons glyphicons-envelope';\n\t\tcase 'encyclopediaArticle':\n\t\t\treturn 'glyphicons glyphicons-bookmark';\n\t\tcase 'film':\n\t\t\treturn 'glyphicons glyphicons-film';\n\t\tcase 'forumPost':\n\t\t\treturn 'glyphicons glyphicons-bullhorn';\n\t\tcase 'hearing':\n\t\t\treturn 'fa fa-gavel';\n\t\tcase 'instantMessage':\n\t\t\treturn 'fa fa-comment-o';\n\t\tcase 'interview':\n\t\t\treturn 'fa fa-comments-o';\n\t\tcase 'journalArticle':\n\t\t\treturn 'fa fa-file-text-o';\n\t\tcase 'letter':\n\t\t\treturn 'glyphicons glyphicons-message-full';\n\t\tcase 'magazineArticle':\n\t\t\treturn defaultIcon;\n\t\tcase 'manuscript':\n\t\t\treturn 'glyphicons glyphicons-pen';\n\t\tcase 'map':\n\t\t\treturn 'glyphicons glyphicons-google-maps';\n\t\tcase 'newspaperArticle':\n\t\t\treturn 'fa fa-newspaper-o';\n\t\tcase 'note':\n\t\t\treturn 'glyphicons glyphicons-notes noteyellow';\n\t\tcase 'patent':\n\t\t\treturn 'glyphicons glyphicons-lightbulb';\n\t\tcase 'podcast':\n\t\t\treturn 'glyphicons glyphicons-ipod';\n\t\tcase 'presentation':\n\t\t\treturn 'glyphicons glyphicons-keynote';\n\t\tcase 'radioBroadcast':\n\t\t\treturn 'glyphicons glyphicons-wifi-alt';\n\t\tcase 'report':\n\t\t\treturn 'glyphicons glyphicons-notes-2';\n\t\tcase 'statue':\n\t\t\treturn 'glyphicons glyphicons-bank';\n\t\tcase 'thesis':\n\t\t\treturn 'fa fa-graduation-cap';\n\t\tcase 'tvBroadcast':\n\t\t\treturn 'glyphicons glyphicons-display';\n\t\tcase 'videoRecording':\n\t\t\treturn 'glyphicons glyphicons-facetime-video';\n\t\tcase 'webpage':\n\t\t\treturn 'glyphicons glyphicons-embed-close';\n\t\tdefault:\n\t\t\treturn 'glyphicons file';\n\t}\n};\n\nItem.prototype.get = function(key){\n\tvar item = this;\n\tswitch(key) {\n\t\tcase 'title':\n\t\t\tvar title = '';\n\t\t\tif(item.apiObj.data.itemType == 'note'){\n\t\t\t\treturn item.noteTitle(item.apiObj.data.note);\n\t\t\t} else {\n\t\t\t\treturn item.apiObj.data.title;\n\t\t\t}\n\t\t\tif(title === ''){\n\t\t\t\treturn '[Untitled]';\n\t\t\t}\n\t\t\treturn title;\n\t\tcase 'creatorSummary':\n\t\tcase 'creator':\n\t\t\tif(typeof item.apiObj.meta.creatorSummary !== 'undefined'){\n\t\t\t\treturn item.apiObj.meta.creatorSummary;\n\t\t\t}\n\t\t\telse {\n\t\t\t\treturn '';\n\t\t\t}\n\t\t\tbreak;\n\t\tcase 'year':\n\t\t\tif(item.parsedDate) {\n\t\t\t\treturn item.parsedDate.getFullYear();\n\t\t\t}\n\t\t\telse {\n\t\t\t\treturn '';\n\t\t\t}\n\t}\n\t\n\tif(key in item.apiObj.data){\n\t\treturn item.apiObj.data[key];\n\t}\n\telse if(key in item.apiObj.meta){\n\t\treturn item.apiObj.meta[key];\n\t}\n\telse if(item.hasOwnProperty(key)){\n\t\treturn item[key];\n\t}\n\t\n\treturn null;\n};\n\nItem.prototype.set = function(key, val){\n\tvar item = this;\n\tif(key in item.apiObj){\n\t\titem.apiObj[key] = val;\n\t}\n\tif(key in item.apiObj.data){\n\t\titem.apiObj.data[key] = val;\n\t}\n\tif(key in item.apiObj.meta){\n\t\titem.apiObj.meta[key] = val;\n\t}\n\t\n\tswitch (key) {\n\t\tcase 'itemKey':\n\t\tcase 'key':\n\t\t\titem.key = val;\n\t\t\titem.apiObj.data.key = val;\n\t\t\tbreak;\n\t\tcase 'itemVersion':\n\t\tcase 'version':\n\t\t\titem.version = val;\n\t\t\titem.apiObj.data.version = val;\n\t\t\tbreak;\n\t\tcase 'itemType':\n\t\t\titem.itemType = val;\n\t\t\t//TODO: translate api object to new item type\n\t\t\tbreak;\n\t\tcase 'linkMode':\n\t\t\tbreak;\n\t\tcase 'deleted':\n\t\t\titem.apiObj.data.deleted = val;\n\t\t\tbreak;\n\t\tcase 'parentItem':\n\t\t\tif( val === '' ){ val = false; }\n\t\t\titem.apiObj.data.parentItem = val;\n\t\t\tbreak;\n\t}\n\t\n//    item.synced = false;\n\treturn item;\n};\n\nItem.prototype.noteTitle = function(note){\n\tvar len = 120;\n\tvar notetext = striptags(note);\n\tvar firstNewline = notetext.indexOf('\\n');\n\tif((firstNewline != -1) && firstNewline < len){\n\t\treturn notetext.substr(0, firstNewline);\n\t}\n\telse {\n\t\treturn notetext.substr(0, len);\n\t}\n};\n\nItem.prototype.setParent = function(parentItemKey){\n\tvar item = this;\n\t//pull out itemKey string if we were passed an item object\n\tif(typeof parentItemKey != 'string' &&\n\t\tparentItemKey.hasOwnProperty('instance') &&\n\t\tparentItemKey.instance == 'Zotero.Item'){\n\t\tparentItemKey = parentItemKey.key;\n\t}\n\titem.set('parentItem', parentItemKey);\n\treturn item;\n};\n\nItem.prototype.addToCollection = function(collectionKey){\n\tvar item = this;\n\t//take out the collection key if we're passed a collection object instead\n\tif(typeof collectionKey != 'string'){\n\t\tif(collectionKey.instance == 'Zotero.Collection'){\n\t\t\tcollectionKey = collectionKey.key;\n\t\t}\n\t}\n\tif(item.apiObj.data.collections.indexOf(collectionKey) === -1){\n\t\titem.apiObj.data.collections.push(collectionKey);\n\t}\n\treturn;\n};\n\nItem.prototype.removeFromCollection = function(collectionKey){\n\tvar item = this;\n\t//take out the collection key if we're passed a collection object instead\n\tif(typeof collectionKey != 'string'){\n\t\tif(collectionKey.instance == 'Zotero.Collection'){\n\t\t\tcollectionKey = collectionKey.key;\n\t\t}\n\t}\n\tvar index = item.apiObj.data.collections.indexOf(collectionKey);\n\tif(index != -1){\n\t\titem.apiObj.data.collections.splice(index, 1);\n\t}\n\treturn;\n};\n\nItem.prototype.uploadChildAttachment = function(childItem, fileInfo, progressCallback){\n\t/*\n\t * write child item so that it exists\n\t * get upload authorization for actual file\n\t * perform full upload\n\t */\n\tvar item = this;\n\tZ.debug('uploadChildAttachment', 3);\n\tif(!item.owningLibrary){\n\t\treturn Promise.reject(new Error('Item must be associated with a library'));\n\t}\n\n\t//make sure childItem has parent set\n\tchildItem.set('parentItem', item.key);\n\tchildItem.associateWithLibrary(item.owningLibrary);\n\t\n\treturn childItem.writeItem()\n\t.then(function(response){\n\t\t//successful attachmentItemWrite\n\t\titem.numChildren++;\n\t\treturn childItem.uploadFile(fileInfo, progressCallback);\n\t}, function(response){\n\t\t//failure during attachmentItem write\n\t\tthrow {\n\t\t\t'message':'Failure during attachmentItem write.',\n\t\t\t'code': response.status,\n\t\t\t'serverMessage': response.jqxhr.responseText,\n\t\t\t'response': response\n\t\t};\n\t});\n};\n\nItem.prototype.uploadFile = function(fileInfo, progressCallback){\n\tvar item = this;\n\tZ.debug('Zotero.Item.uploadFile', 3);\n\tvar uploadAuthFileData = {\n\t\tmd5:fileInfo.md5,\n\t\tfilename: item.get('title'),\n\t\tfilesize: fileInfo.filesize,\n\t\tmtime:fileInfo.mtime,\n\t\tcontentType:fileInfo.contentType,\n\t\tparams:1\n\t};\n\tif(fileInfo.contentType === ''){\n\t\tuploadAuthFileData.contentType = 'application/octet-stream';\n\t}\n\treturn item.getUploadAuthorization(uploadAuthFileData)\n\t.then(function(response){\n\t\tZ.debug('uploadAuth callback', 3);\n\t\tvar upAuthOb;\n\t\tif(typeof response.data == 'string'){upAuthOb = JSON.parse(response.data);}\n\t\telse{upAuthOb = response.data;}\n\t\tif(upAuthOb.exists == 1){\n\t\t\treturn {'message':'File Exists'};\n\t\t}\n\t\telse{\n\t\t\t//TODO: add progress\n\t\t\treturn Zotero.file.uploadFile(upAuthOb, fileInfo)\n\t\t\t.then(function(){\n\t\t\t\t//upload was successful: register it\n\t\t\t\treturn item.registerUpload(upAuthOb.uploadKey)\n\t\t\t\t.then(function(response){\n\t\t\t\t\tif(response.isError){\n\t\t\t\t\t\tvar e = {\n\t\t\t\t\t\t\t'message':'Failed to register uploaded file.',\n\t\t\t\t\t\t\t'code': response.status,\n\t\t\t\t\t\t\t'serverMessage': response.jqxhr.responseText,\n\t\t\t\t\t\t\t'response': response\n\t\t\t\t\t\t};\n\t\t\t\t\t\tZ.error(e);\n\t\t\t\t\t\tthrow e;\n\t\t\t\t\t} else {\n\t\t\t\t\t\treturn {'message': 'Upload Successful'};\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t});\n\t\t}\n\t}).catch(function(response){\n\t\tZ.debug('Failure caught during upload', 3);\n\t\tZ.debug(response, 3);\n\t\tthrow {\n\t\t\t'message':'Failure during upload.',\n\t\t\t'code': response.status,\n\t\t\t'serverMessage': response.jqxhr.responseText,\n\t\t\t'response': response\n\t\t};\n\t});\n};\n\nItem.prototype.cslItem = function(){\n\tvar zoteroItem = this;\n\t\n\t// don't return URL or accessed information for journal articles if a\n\t// pages field exists\n\tvar itemType = zoteroItem.get('itemType');//Zotero_ItemTypes::getName($zoteroItem->itemTypeID);\n\tvar cslType = zoteroItem.cslTypeMap.hasOwnProperty(itemType) ? zoteroItem.cslTypeMap[itemType] : false;\n\tif (!cslType) cslType = 'article';\n\tvar ignoreURL = ((zoteroItem.get('accessDate') || zoteroItem.get('url')) &&\n\t\t\titemType in {'journalArticle':1, 'newspaperArticle':1, 'magazineArticle':1} &&\n\t\t\tzoteroItem.get('pages') &&\n\t\t\tzoteroItem.citePaperJournalArticleURL);\n\t\n\tvar cslItem = {'type': cslType};\n\tif(zoteroItem.owningLibrary){\n\t\tcslItem['id'] = zoteroItem.apiObj.library.id + '/' + zoteroItem.get('key');\n\t} else {\n\t\tcslItem['id'] = Zotero.utils.getKey();\n\t}\n\t\n\t// get all text variables (there must be a better way)\n\t// TODO: does citeproc-js permit short forms?\n\tObject.keys(zoteroItem.cslFieldMap).forEach(function(variable){\n\t\tvar fields = zoteroItem.cslFieldMap[variable];\n\t\tif (variable == 'URL' && ignoreURL) return;\n\t\tfields.forEach(function(field){\n\t\t\tvar value = zoteroItem.get(field);\n\t\t\tif(value){\n\t\t\t\t//TODO: strip enclosing quotes? necessary when not pulling from DB?\n\t\t\t\tcslItem[variable] = value;\n\t\t\t}\n\t\t});\n\t});\n\t\n\t// separate name variables\n\tvar creators = zoteroItem.get('creators');\n\tcreators.forEach(function(creator){\n\t\tvar creatorType = creator['creatorType'];// isset(self::$zoteroNameMap[$creatorType]) ? self::$zoteroNameMap[$creatorType] : false;\n\t\tif (!creatorType) return;\n\t\t\n\t\tvar nameObj;\n\t\tif(creator.hasOwnProperty('name')){\n\t\t\tnameObj = {'literal': creator['name']};\n\t\t}\n\t\telse {\n\t\t\tnameObj = {'family': creator['lastName'], 'given': creator['firstName']};\n\t\t}\n\t\t\n\t\tif (cslItem.hasOwnProperty(creatorType)) {\n\t\t\tcslItem[creatorType].push(nameObj);\n\t\t}\n\t\telse {\n\t\t\tcslItem[creatorType] = [nameObj];\n\t\t}\n\t});\n\t\n\t// get date variables\n\tObject.keys(zoteroItem.cslDateMap).forEach(function(key){\n\t\tvar val = zoteroItem.cslDateMap[key];\n\t\tvar date = zoteroItem.get(val);\n\t\tif (date) {\n\t\t\tcslItem[key] = {'raw': date};\n\t\t}\n\t});\n\t\n\treturn cslItem;\n};\n\nObject.keys(ItemMaps).forEach(function(key) {\n\tItem.prototype[key] = ItemMaps[key];\n});\n\nmodule.exports = Item;\n","'use strict';\n\nvar ItemMaps = {};\n\nItemMaps.fieldMap = {\n\t'itemType'\t\t\t\t: 'Item Type',\n\t'title'\t\t\t\t\t: 'Title',\n\t'dateAdded'\t\t\t\t: 'Date Added',\n\t'dateModified'\t\t\t: 'Date Modified',\n\t'source'\t\t\t\t: 'Source',\n\t'notes'\t\t\t\t\t: 'Notes',\n\t'tags'\t\t\t\t\t: 'Tags',\n\t'attachments'\t\t\t: 'Attachments',\n\t'related'\t\t\t\t: 'Related',\n\t'url'\t\t\t\t\t: 'URL',\n\t'rights'\t\t\t\t: 'Rights',\n\t'series'\t\t\t\t: 'Series',\n\t'volume'\t\t\t\t: 'Volume',\n\t'issue'\t\t\t\t\t: 'Issue',\n\t'edition'\t\t\t\t: 'Edition',\n\t'place'\t\t\t\t\t: 'Place',\n\t'publisher'\t\t\t\t: 'Publisher',\n\t'pages'\t\t\t\t\t: 'Pages',\n\t'ISBN'\t\t\t\t\t: 'ISBN',\n\t'publicationTitle'\t\t: 'Publication',\n\t'ISSN'\t\t\t\t\t: 'ISSN',\n\t'date'\t\t\t\t\t: 'Date',\n\t'year'\t\t\t\t\t: 'Year',\n\t'section'\t\t\t\t: 'Section',\n\t'callNumber'\t\t\t: 'Call Number',\n\t'archive'\t\t\t\t: 'Archive',\n\t'archiveLocation'\t\t: 'Loc. in Archive',\n\t'libraryCatalog'\t\t: 'Library Catalog',\n\t'distributor'\t\t\t: 'Distributor',\n\t'extra'\t\t\t\t\t: 'Extra',\n\t'journalAbbreviation'\t: 'Journal Abbr',\n\t'DOI'\t\t\t\t\t: 'DOI',\n\t'accessDate'\t\t\t: 'Accessed',\n\t'seriesTitle'\t\t\t: 'Series Title',\n\t'seriesText'\t\t\t: 'Series Text',\n\t'seriesNumber'\t\t\t: 'Series Number',\n\t'institution'\t\t\t: 'Institution',\n\t'reportType'\t\t\t: 'Report Type',\n\t'code'\t\t\t\t\t: 'Code',\n\t'session'\t\t\t\t: 'Session',\n\t'legislativeBody'\t\t: 'Legislative Body',\n\t'history'\t\t\t\t: 'History',\n\t'reporter'\t\t\t\t: 'Reporter',\n\t'court'\t\t\t\t\t: 'Court',\n\t'numberOfVolumes'\t\t: '# of Volumes',\n\t'committee'\t\t\t\t: 'Committee',\n\t'assignee'\t\t\t\t: 'Assignee',\n\t'patentNumber'\t\t\t: 'Patent Number',\n\t'priorityNumbers'\t\t: 'Priority Numbers',\n\t'issueDate'\t\t\t\t: 'Issue Date',\n\t'references'\t\t\t: 'References',\n\t'legalStatus'\t\t\t: 'Legal Status',\n\t'codeNumber'\t\t\t: 'Code Number',\n\t'artworkMedium'\t\t\t: 'Medium',\n\t'number'\t\t\t\t: 'Number',\n\t'artworkSize'\t\t\t: 'Artwork Size',\n\t'repository'\t\t\t: 'Repository',\n\t'videoRecordingType'\t: 'Recording Type',\n\t'interviewMedium'\t\t: 'Medium',\n\t'letterType'\t\t\t: 'Type',\n\t'manuscriptType'\t\t: 'Type',\n\t'mapType'\t\t\t\t: 'Type',\n\t'scale'\t\t\t\t\t: 'Scale',\n\t'thesisType'\t\t\t: 'Type',\n\t'websiteType'\t\t\t: 'Website Type',\n\t'audioRecordingType'\t: 'Recording Type',\n\t'label'\t\t\t\t\t: 'Label',\n\t'presentationType'\t\t: 'Type',\n\t'meetingName'\t\t\t: 'Meeting Name',\n\t'studio'\t\t\t\t: 'Studio',\n\t'runningTime'\t\t\t: 'Running Time',\n\t'network'\t\t\t\t: 'Network',\n\t'postType'\t\t\t\t: 'Post Type',\n\t'audioFileType'\t\t\t: 'File Type',\n\t'versionNumber'\t\t\t: 'Version Number',\n\t'system'\t\t\t\t: 'System',\n\t'company'\t\t\t\t: 'Company',\n\t'conferenceName'\t\t: 'Conference Name',\n\t'encyclopediaTitle'\t\t: 'Encyclopedia Title',\n\t'dictionaryTitle'\t\t: 'Dictionary Title',\n\t'language'\t\t\t\t: 'Language',\n\t'programmingLanguage'\t: 'Language',\n\t'university'\t\t\t: 'University',\n\t'abstractNote'\t\t\t: 'Abstract',\n\t'websiteTitle'\t\t\t: 'Website Title',\n\t'reportNumber'\t\t\t: 'Report Number',\n\t'billNumber'\t\t\t: 'Bill Number',\n\t'codeVolume'\t\t\t: 'Code Volume',\n\t'codePages'\t\t\t\t: 'Code Pages',\n\t'dateDecided'\t\t\t: 'Date Decided',\n\t'reporterVolume'\t\t: 'Reporter Volume',\n\t'firstPage'\t\t\t\t: 'First Page',\n\t'documentNumber'\t\t: 'Document Number',\n\t'dateEnacted'\t\t\t: 'Date Enacted',\n\t'publicLawNumber'\t\t: 'Public Law Number',\n\t'country'\t\t\t\t: 'Country',\n\t'applicationNumber'\t\t: 'Application Number',\n\t'forumTitle'\t\t\t: 'Forum/Listserv Title',\n\t'episodeNumber'\t\t\t: 'Episode Number',\n\t'blogTitle'\t\t\t\t: 'Blog Title',\n\t'caseName'\t\t\t\t: 'Case Name',\n\t'nameOfAct'\t\t\t\t: 'Name of Act',\n\t'subject'\t\t\t\t: 'Subject',\n\t'proceedingsTitle'\t\t: 'Proceedings Title',\n\t'bookTitle'\t\t\t\t: 'Book Title',\n\t'shortTitle'\t\t\t: 'Short Title',\n\t'docketNumber'\t\t\t: 'Docket Number',\n\t'numPages'\t\t\t\t: '# of Pages',\n\t'note'\t\t\t\t\t: 'Note',\n\t'numChildren'\t\t\t: '# of Children',\n\t'addedBy'\t\t\t\t: 'Added By',\n\t'creator'\t\t\t\t: 'Creator'\n};\n\nItemMaps.typeMap = {\n\t'note'\t\t\t\t\t: 'Note',\n\t'attachment'\t\t\t: 'Attachment',\n\t'book'\t\t\t\t\t: 'Book',\n\t'bookSection'\t\t\t: 'Book Section',\n\t'journalArticle'\t\t: 'Journal Article',\n\t'magazineArticle'\t\t: 'Magazine Article',\n\t'newspaperArticle'\t\t: 'Newspaper Article',\n\t'thesis'\t\t\t\t: 'Thesis',\n\t'letter'\t\t\t\t: 'Letter',\n\t'manuscript'\t\t\t: 'Manuscript',\n\t'interview'\t\t\t\t: 'Interview',\n\t'film'\t\t\t\t\t: 'Film',\n\t'artwork'\t\t\t\t: 'Artwork',\n\t'webpage'\t\t\t\t: 'Web Page',\n\t'report'\t\t\t\t: 'Report',\n\t'bill'\t\t\t\t\t: 'Bill',\n\t'case'\t\t\t\t\t: 'Case',\n\t'hearing'\t\t\t\t: 'Hearing',\n\t'patent'\t\t\t\t: 'Patent',\n\t'statute'\t\t\t\t: 'Statute',\n\t'email'\t\t\t\t\t: 'E-mail',\n\t'map'\t\t\t\t\t: 'Map',\n\t'blogPost'\t\t\t\t: 'Blog Post',\n\t'instantMessage'\t\t: 'Instant Message',\n\t'forumPost'\t\t\t\t: 'Forum Post',\n\t'audioRecording'\t\t: 'Audio Recording',\n\t'presentation'\t\t\t: 'Presentation',\n\t'videoRecording'\t\t: 'Video Recording',\n\t'tvBroadcast'\t\t\t: 'TV Broadcast',\n\t'radioBroadcast'\t\t: 'Radio Broadcast',\n\t'podcast'\t\t\t\t: 'Podcast',\n\t'computerProgram'\t\t: 'Computer Program',\n\t'conferencePaper'\t\t: 'Conference Paper',\n\t'document'\t\t\t\t: 'Document',\n\t'encyclopediaArticle'\t: 'Encyclopedia Article',\n\t'dictionaryEntry'\t\t: 'Dictionary Entry'\n};\n\nItemMaps.creatorMap = {\n\t'author'\t\t\t: 'Author',\n\t'contributor'\t\t: 'Contributor',\n\t'editor'\t\t\t: 'Editor',\n\t'translator'\t\t: 'Translator',\n\t'seriesEditor'\t\t: 'Series Editor',\n\t'interviewee'\t\t: 'Interview With',\n\t'interviewer'\t\t: 'Interviewer',\n\t'director'\t\t\t: 'Director',\n\t'scriptwriter'\t\t: 'Scriptwriter',\n\t'producer'\t\t\t: 'Producer',\n\t'castMember'\t\t: 'Cast Member',\n\t'sponsor'\t\t\t: 'Sponsor',\n\t'counsel'\t\t\t: 'Counsel',\n\t'inventor'\t\t\t: 'Inventor',\n\t'attorneyAgent'\t\t: 'Attorney/Agent',\n\t'recipient'\t\t\t: 'Recipient',\n\t'performer'\t\t\t: 'Performer',\n\t'composer'\t\t\t: 'Composer',\n\t'wordsBy'\t\t\t: 'Words By',\n\t'cartographer'\t\t: 'Cartographer',\n\t'programmer'\t\t: 'Programmer',\n\t'reviewedAuthor'\t: 'Reviewed Author',\n\t'artist'\t\t\t: 'Artist',\n\t'commenter'\t\t\t: 'Commenter',\n\t'presenter'\t\t\t: 'Presenter',\n\t'guest'\t\t\t\t: 'Guest',\n\t'podcaster'\t\t\t: 'Podcaster'\n};\n\nItemMaps.hideFields = [\n\t'mimeType',\n\t'linkMode',\n\t'charset',\n\t'md5',\n\t'mtime',\n\t'version',\n\t'key',\n\t'collections',\n\t'relations',\n\t'parentItem',\n\t'contentType',\n\t'filename',\n\t'tags'\n];\n\nItemMaps.noEditFields = [\n\t'accessDate',\n\t'modified',\n\t'filename',\n\t'dateAdded',\n\t'dateModified'\n];\n\nItemMaps.itemTypeImageSrc = {\n\t'note'\t\t\t\t\t: 'note',\n\t'attachment'\t\t\t: 'attachment-pdf',\n\t'attachmentPdf'\t\t\t: 'attachment-pdf',\n\t'attachmentWeblink'\t\t: 'attachment-web-link',\n\t'attachmentSnapshot'\t: 'attachment-snapshot',\n\t'attachmentFile'\t\t: 'attachment-file',\n\t'attachmentLink'\t\t: 'attachment-link',\n\t'book'\t\t\t\t\t: 'book',\n\t'bookSection'\t\t\t: 'book_open',\n\t'journalArticle'\t\t: 'page_white_text',\n\t'magazineArticle'\t\t: 'layout',\n\t'newspaperArticle'\t\t: 'newspaper',\n\t'thesis'\t\t\t\t: 'report',\n\t'letter'\t\t\t\t: 'email_open',\n\t'manuscript'\t\t\t: 'script',\n\t'interview'\t\t\t\t: 'comments',\n\t'film'\t\t\t\t\t: 'film',\n\t'artwork'\t\t\t\t: 'picture',\n\t'webpage'\t\t\t\t: 'page',\n\t'report'\t\t\t\t: 'report',\n\t'bill'\t\t\t\t\t: 'page_white',\n\t'case'\t\t\t\t\t: 'page_white',\n\t'hearing'\t\t\t\t: 'page_white',\n\t'patent'\t\t\t\t: 'page_white',\n\t'statute'\t\t\t\t: 'page_white',\n\t'email'\t\t\t\t\t: 'email',\n\t'map'\t\t\t\t\t: 'map',\n\t'blogPost'\t\t\t\t: 'layout',\n\t'instantMessage'\t\t: 'page_white',\n\t'forumPost'\t\t\t\t: 'page',\n\t'audioRecording'\t\t: 'ipod',\n\t'presentation'\t\t\t: 'page_white',\n\t'videoRecording'\t\t: 'film',\n\t'tvBroadcast'\t\t\t: 'television',\n\t'radioBroadcast'\t\t: 'transmit',\n\t'podcast'\t\t\t\t: 'ipod_cast',\n\t'computerProgram'\t\t: 'page_white_code',\n\t'conferencePaper'\t\t: 'treeitem-conferencePaper',\n\t'document'\t\t\t\t: 'page_white',\n\t'encyclopediaArticle'\t: 'page_white',\n\t'dictionaryEntry'\t\t: 'page_white'\n};\n\nItemMaps.cslNameMap = {\n\t'author': 'author',\n\t'editor': 'editor',\n\t'bookAuthor': 'container-author',\n\t'composer': 'composer',\n\t'interviewer': 'interviewer',\n\t'recipient': 'recipient',\n\t'seriesEditor': 'collection-editor',\n\t'translator': 'translator'\n};\n\nItemMaps.cslFieldMap = {\n\t'title': ['title'],\n\t'container-title': ['publicationTitle',  'reporter', 'code'], /* reporter and code should move to SQL mapping tables */\n\t'collection-title': ['seriesTitle', 'series'],\n\t'collection-number': ['seriesNumber'],\n\t'publisher': ['publisher', 'distributor'], /* distributor should move to SQL mapping tables */\n\t'publisher-place': ['place'],\n\t'authority': ['court'],\n\t'page': ['pages'],\n\t'volume': ['volume'],\n\t'issue': ['issue'],\n\t'number-of-volumes': ['numberOfVolumes'],\n\t'number-of-pages': ['numPages'],\n\t'edition': ['edition'],\n\t'versionNumber': ['version'],\n\t'section': ['section'],\n\t'genre': ['type', 'artworkSize'], /* artworkSize should move to SQL mapping tables, or added as a CSL variable */\n\t'medium': ['medium', 'system'],\n\t'archive': ['archive'],\n\t'archive_location': ['archiveLocation'],\n\t'event': ['meetingName', 'conferenceName'], /* these should be mapped to the same base field in SQL mapping tables */\n\t'event-place': ['place'],\n\t'abstract': ['abstractNote'],\n\t'URL': ['url'],\n\t'DOI': ['DOI'],\n\t'ISBN': ['ISBN'],\n\t'call-number': ['callNumber'],\n\t'note': ['extra'],\n\t'number': ['number'],\n\t'references': ['history'],\n\t'shortTitle': ['shortTitle'],\n\t'journalAbbreviation': ['journalAbbreviation'],\n\t'language': ['language']\n};\n\nItemMaps.cslDateMap = {\n\t'issued': 'date',\n\t'accessed': 'accessDate'\n};\n\nItemMaps.cslTypeMap = {\n\t'book': 'book',\n\t'bookSection': 'chapter',\n\t'journalArticle': 'article-journal',\n\t'magazineArticle': 'article-magazine',\n\t'newspaperArticle': 'article-newspaper',\n\t'thesis': 'thesis',\n\t'encyclopediaArticle': 'entry-encyclopedia',\n\t'dictionaryEntry': 'entry-dictionary',\n\t'conferencePaper': 'paper-conference',\n\t'letter': 'personal_communication',\n\t'manuscript': 'manuscript',\n\t'interview': 'interview',\n\t'film': 'motion_picture',\n\t'artwork': 'graphic',\n\t'webpage': 'webpage',\n\t'report': 'report',\n\t'bill': 'bill',\n\t'case': 'legal_case',\n\t'hearing': 'bill',                // ??\n\t'patent': 'patent',\n\t'statute': 'bill',                // ??\n\t'email': 'personal_communication',\n\t'map': 'map',\n\t'blogPost': 'webpage',\n\t'instantMessage': 'personal_communication',\n\t'forumPost': 'webpage',\n\t'audioRecording': 'song',     // ??\n\t'presentation': 'speech',\n\t'videoRecording': 'motion_picture',\n\t'tvBroadcast': 'broadcast',\n\t'radioBroadcast': 'broadcast',\n\t'podcast': 'song',            // ??\n\t'computerProgram': 'book'     // ??\n};\n\nItemMaps.citePaperJournalArticleURL = false;\n\nmodule.exports = ItemMaps;","'use strict';\n\nmodule.exports = function(jsonBody){\n\tthis.instance = 'Zotero.Items';\n\t//represent items as array for ordering purposes\n\tthis.itemsVersion = 0;\n\tthis.syncState = {\n\t\tearliestVersion: null,\n\t\tlatestVersion: null\n\t};\n\tthis.itemObjects = {};\n\tthis.objectMap = this.itemObjects;\n\tthis.objectArray = [];\n\tthis.unsyncedItemKeys = [];\n\t\n\tif(jsonBody){\n\t\tthis.addItemsFromJson(jsonBody);\n\t}\n};\n\nmodule.exports.prototype = new Zotero.Container();\n\nmodule.exports.prototype.getItem = function(key){\n\treturn this.getObject(key);\n};\n\nmodule.exports.prototype.getItems = function(keys){\n\treturn this.getObjects(keys);\n};\n\nmodule.exports.prototype.addItem = function(item){\n\tthis.addObject(item);\n\treturn this;\n};\n\nmodule.exports.prototype.addItemsFromJson = function(jsonBody){\n\tZ.debug('addItemsFromJson', 3);\n\tvar items = this;\n\tvar parsedItemJson = jsonBody;\n\tvar itemsAdded = [];\n\tZ.debug('looping');\n\tparsedItemJson.forEach(function(itemObj){\n\t\tZ.debug('creating new Item');\n\t\tvar item = new Zotero.Item(itemObj);\n\t\titems.addItem(item);\n\t\titemsAdded.push(item);\n\t});\n\treturn itemsAdded;\n};\n\n//Remove item from local set if it has been marked as deleted by the server\nmodule.exports.prototype.removeLocalItem = function(key){\n\treturn this.removeObject(key);\n};\n\nmodule.exports.prototype.removeLocalItems = function(keys){\n\treturn this.removeObjects(keys);\n};\n\nmodule.exports.prototype.deleteItem = function(itemKey){\n\tZ.debug('Zotero.Items.deleteItem', 3);\n\tvar items = this;\n\tvar item;\n\t\n\tif(!itemKey) return false;\n\titemKey = items.extractKey(itemKey);\n\titem = items.getItem(itemKey);\n\t\n\tvar urlconfig = {\n\t\t'target':'item',\n\t\t'libraryType':items.owningLibrary.libraryType,\n\t\t'libraryID':items.owningLibrary.libraryID,\n\t\t'itemKey':item.key\n\t};\n\tvar requestConfig = {\n\t\turl: Zotero.ajax.apiRequestString(urlconfig),\n\t\ttype: 'DELETE',\n\t\theaders:{'If-Unmodified-Since-Version':item.get('version')}\n\t};\n\t\n\treturn Zotero.net.ajaxRequest(requestConfig);\n};\n\nmodule.exports.prototype.deleteItems = function(deleteItems, version){\n\t//TODO: split into multiple requests if necessary\n\tZ.debug('Zotero.Items.deleteItems', 3);\n\tvar items = this;\n\tvar deleteKeys = [];\n\tvar i;\n\tif((!version) && (items.itemsVersion !== 0)){\n\t\tversion = items.itemsVersion;\n\t}\n\t\n\t//make sure we're working with item keys, not items\n\tvar key;\n\tfor(i = 0; i < deleteItems.length; i++){\n\t\tif(!deleteItems[i]) continue;\n\t\tkey = items.extractKey(deleteItems[i]);\n\t\tif(key){\n\t\t\tdeleteKeys.push(key);\n\t\t}\n\t}\n\t\n\t//split keys into chunks of 50 per request\n\tvar deleteChunks = items.chunkObjectsArray(deleteKeys);\n\t/*\n\tvar successCallback = function(response){\n\t\tvar deleteProgress = index / deleteChunks.length;\n\t\tZotero.trigger(\"deleteProgress\", {'progress': deleteProgress});\n\t\treturn response;\n\t};\n\t*/\n\tvar requestObjects = [];\n\tfor(i = 0; i < deleteChunks.length; i++){\n\t\tvar deleteKeysString = deleteChunks[i].join(',');\n\t\tvar urlconfig = {\n\t\t\t'target':'items',\n\t\t\t'libraryType':items.owningLibrary.libraryType,\n\t\t\t'libraryID':items.owningLibrary.libraryID,\n\t\t\t'itemKey': deleteKeysString\n\t\t};\n\t\t//headers['If-Unmodified-Since-Version'] = version;\n\t\t\n\t\tvar requestConfig = {\n\t\t\turl: urlconfig,\n\t\t\ttype: 'DELETE'\n\t\t};\n\t\trequestObjects.push(requestConfig);\n\t}\n\t\n\treturn Zotero.net.queueRequest(requestObjects);\n};\n\nmodule.exports.prototype.trashItems = function(itemsArray){\n\tvar items = this;\n\tvar i;\n\tfor(i = 0; i < itemsArray.length; i++){\n\t\tvar item = itemsArray[i];\n\t\titem.set('deleted', 1);\n\t}\n\treturn items.writeItems(itemsArray);\n};\n\nmodule.exports.prototype.untrashItems = function(itemsArray){\n\tvar items = this;\n\tvar i;\n\tfor(i = 0; i < itemsArray.length; i++){\n\t\tvar item = itemsArray[i];\n\t\titem.set('deleted', 0);\n\t}\n\treturn items.writeItems(itemsArray);\n};\n\nmodule.exports.prototype.findItems = function(config){\n\tvar items = this;\n\tvar matchingItems = [];\n\tObject.keys(items.itemObjects).forEach(function(key){\n\t\tvar item = item.itemObjects[key];\n\t\tif(config.collectionKey && (item.apiObj.collections.indexOf(config.collectionKey) === -1) ){\n\t\t\treturn;\n\t\t}\n\t\tmatchingItems.push(items.itemObjects[key]);\n\t});\n\treturn matchingItems;\n};\n\n//take an array of items and extract children into their own items\n//for writing\nmodule.exports.prototype.atomizeItems = function(itemsArray){\n\t//process the array of items, pulling out child notes/attachments to write\n\t//separately with correct parentItem set and assign generated itemKeys to\n\t//new items\n\tvar writeItems = [];\n\tvar item;\n\tfor(var i = 0; i < itemsArray.length; i++){\n\t\titem = itemsArray[i];\n\t\t//generate an itemKey if the item does not already have one\n\t\tvar itemKey = item.get('key');\n\t\tif(itemKey === '' || itemKey === null) {\n\t\t\tvar newItemKey = Zotero.utils.getKey();\n\t\t\titem.set('key', newItemKey);\n\t\t\titem.set('version', 0);\n\t\t}\n\t\t//items that already have item key always in first pass, as are their children\n\t\twriteItems.push(item);\n\t\tif(item.hasOwnProperty('notes') && item.notes.length > 0){\n\t\t\tfor(var j = 0; j < item.notes.length; j++){\n\t\t\t\titem.notes[j].set('parentItem', item.get('key'));\n\t\t\t}\n\t\t\twriteItems = writeItems.concat(item.notes);\n\t\t}\n\t\tif(item.hasOwnProperty('attachments') && item.attachments.length > 0){\n\t\t\tfor(var k = 0; k < item.attachments.length; k++){\n\t\t\t\titem.attachments[k].set('parentItem', item.get('key'));\n\t\t\t}\n\t\t\twriteItems = writeItems.concat(item.attachments);\n\t\t}\n\t}\n\treturn writeItems;\n};\n\n//accept an array of 'Zotero.Item's\nmodule.exports.prototype.writeItems = function(itemsArray){\n\tvar items = this;\n\tvar library = items.owningLibrary;\n\tvar i;\n\tvar writeItems = items.atomizeItems(itemsArray);\n\t\n\tvar config = {\n\t\t'target':'items',\n\t\t'libraryType':items.owningLibrary.libraryType,\n\t\t'libraryID':items.owningLibrary.libraryID\n\t};\n\tvar requestUrl = Zotero.ajax.apiRequestString(config);\n\t\n\tvar writeChunks = items.chunkObjectsArray(writeItems);\n\tvar rawChunkObjects = items.rawChunks(writeChunks);\n\t\n\t//update item with server response if successful\n\tvar writeItemsSuccessCallback = function(response){\n\t\tZ.debug('writeItem successCallback', 3);\n\t\titems.updateObjectsFromWriteResponse(this.writeChunk, response);\n\t\t//save updated items to IDB\n\t\tif(Zotero.config.useIndexedDB){\n\t\t\tthis.library.idbLibrary.updateItems(this.writeChunk);\n\t\t}\n\t\t\n\t\tZotero.trigger('itemsChanged', {library:this.library});\n\t\tresponse.returnItems = this.writeChunk;\n\t\treturn response;\n\t};\n\t\n\tZ.debug('items.itemsVersion: ' + items.itemsVersion, 3);\n\tZ.debug('items.libraryVersion: ' + items.libraryVersion, 3);\n\t\n\tvar requestObjects = [];\n\tfor(i = 0; i < writeChunks.length; i++){\n\t\tvar successContext = {\n\t\t\twriteChunk: writeChunks[i],\n\t\t\tlibrary: library\n\t\t};\n\t\t\n\t\tvar requestData = JSON.stringify(rawChunkObjects[i]);\n\t\trequestObjects.push({\n\t\t\turl: requestUrl,\n\t\t\ttype: 'POST',\n\t\t\tdata: requestData,\n\t\t\tprocessData: false,\n\t\t\tsuccess: writeItemsSuccessCallback.bind(successContext)\n\t\t});\n\t}\n\t\n\treturn library.sequentialRequests(requestObjects)\n\t.then(function(responses){\n\t\tZ.debug('Done with writeItems sequentialRequests promise', 3);\n\t\treturn responses;\n\t});\n};\n","'use strict';\n\n/**\n * A user or group Zotero library. This is generally the top level object\n * through which interactions should happen. It houses containers for\n * Zotero API objects (collections, items, etc) and handles making requests\n * with particular API credentials, as well as storing data locally.\n * @param {string} type                 type of library, 'user' or 'group'\n * @param {int} libraryID            ID of the library\n * @param {string} libraryUrlIdentifier identifier used in urls, could be library id or user/group slug\n * @param {string} apiKey               key to use for API requests\n */\nvar Library = function(type, libraryID, libraryUrlIdentifier, apiKey){\n\tZ.debug('Zotero.Library constructor', 3);\n\tZ.debug('Library Constructor: ' + type + ' ' + libraryID + ' ', 3);\n\tvar library = this;\n\tZ.debug(libraryUrlIdentifier, 4);\n\tlibrary.instance = 'Zotero.Library';\n\tlibrary.libraryVersion = 0;\n\tlibrary.syncState = {\n\t\tearliestVersion: null,\n\t\tlatestVersion: null\n\t};\n\tlibrary._apiKey = apiKey || '';\n\t\n\tif(Zotero.config.librarySettings){\n\t\tlibrary.libraryBaseWebsiteUrl = Zotero.config.librarySettings.libraryPathString;\n\t}\n\telse{\n\t\tlibrary.libraryBaseWebsiteUrl = Zotero.config.baseWebsiteUrl;\n\t\tif(type == 'group'){\n\t\t\tlibrary.libraryBaseWebsiteUrl += 'groups/';\n\t\t}\n\t\tif(libraryUrlIdentifier){\n\t\t\tthis.libraryBaseWebsiteUrl += libraryUrlIdentifier + '/items';\n\t\t} else {\n\t\t\tZ.warn('no libraryUrlIdentifier specified');\n\t\t}\n\t}\n\t//object holders within this library, whether tied to a specific library or not\n\tlibrary.items = new Zotero.Items();\n\tlibrary.items.owningLibrary = library;\n\tlibrary.itemKeys = [];\n\tlibrary.collections = new Zotero.Collections();\n\tlibrary.collections.libraryUrlIdentifier = library.libraryUrlIdentifier;\n\tlibrary.collections.owningLibrary = library;\n\tlibrary.tags = new Zotero.Tags();\n\tlibrary.searches = new Zotero.Searches();\n\tlibrary.searches.owningLibrary = library;\n\tlibrary.groups = new Zotero.Groups();\n\tlibrary.groups.owningLibrary = library;\n\tlibrary.deleted = new Zotero.Deleted();\n\tlibrary.deleted.owningLibrary = library;\n\t\n\tif(!type){\n\t\t//return early if library not specified\n\t\tZ.warn('No type specified for library');\n\t\treturn;\n\t}\n\t//attributes tying instance to a specific Zotero library\n\tlibrary.type = type;\n\tlibrary.libraryType = type;\n\tlibrary.libraryID = libraryID;\n\tlibrary.libraryString = Zotero.utils.libraryString(library.libraryType, library.libraryID);\n\tlibrary.libraryUrlIdentifier = libraryUrlIdentifier;\n\t\n\t//initialize preferences object\n\tlibrary.preferences = new Zotero.Preferences(Zotero.store, library.libraryString);\n\t\n\tif(typeof window === 'undefined') {\n\t\tZotero.config.useIndexedDB = false;\n\t\tZotero.warn('Node detected; disabling indexedDB');\n\t} else {\n\t\t//initialize indexedDB if we're supposed to use it\n\t\t//detect safari until they fix their shit\n\t\tvar is_chrome = navigator.userAgent.indexOf('Chrome') > -1;\n\t\tvar is_explorer = navigator.userAgent.indexOf('MSIE') > -1;\n\t\tvar is_firefox = navigator.userAgent.indexOf('Firefox') > -1;\n\t\tvar is_safari = navigator.userAgent.indexOf('Safari') > -1;\n\t\tvar is_opera = navigator.userAgent.toLowerCase().indexOf('op') > -1;\n\t\tif ((is_chrome)&&(is_safari)) {is_safari=false;}\n\t\tif ((is_chrome)&&(is_opera)) {is_chrome=false;}\n\t\tif(is_safari) {\n\t\t\tZotero.config.useIndexedDB = false;\n\t\t\tZotero.warn('Safari detected; disabling indexedDB');\n\t\t}\n\t}\n\n\tif(Zotero.config.useIndexedDB === true) {\n\t\tZ.debug('Library Constructor: indexedDB init', 3);\n\t\tvar idbLibrary = new Zotero.Idb.Library(library.libraryString);\n\t\tidbLibrary.owningLibrary = this;\n\t\tlibrary.idbLibrary = idbLibrary;\n\t\tidbLibrary.init()\n\t\t.then(function(){\n\t\t\tZ.debug('Library Constructor: idbInitD Done', 3);\n\t\t\tif(Zotero.config.preloadCachedLibrary === true){\n\t\t\t\tZ.debug('Library Constructor: preloading cached library', 3);\n\t\t\t\tvar cacheLoadD = library.loadIndexedDBCache();\n\t\t\t\tcacheLoadD.then(function(){\n\t\t\t\t\t//TODO: any stuff that needs to execute only after cache is loaded\n\t\t\t\t\t//possibly fire new events to cause display to refresh after load\n\t\t\t\t\tZ.debug('Library Constructor: Library.items.itemsVersion: ' + library.items.itemsVersion, 3);\n\t\t\t\t\tZ.debug('Library Constructor: Library.collections.collectionsVersion: ' + library.collections.collectionsVersion, 3);\n\t\t\t\t\tZ.debug('Library Constructor: Library.tags.tagsVersion: ' + library.tags.tagsVersion, 3);\n\t\t\t\t\tZ.debug('Library Constructor: Triggering cachedDataLoaded', 3);\n\t\t\t\t\tlibrary.trigger('cachedDataLoaded');\n\t\t\t\t},\n\t\t\t\tfunction(err){\n\t\t\t\t\tZ.error('Error loading cached library');\n\t\t\t\t\tZ.error(err);\n\t\t\t\t\tthrow new Error('Error loading cached library');\n\t\t\t\t});\n\t\t\t}\n\t\t\telse {\n\t\t\t\t//trigger cachedDataLoaded since we are done with that step\n\t\t\t\tlibrary.trigger('cachedDataLoaded');\n\t\t\t}\n\t\t},\n\t\tfunction(){\n\t\t\t//can't use indexedDB. Set to false in config and trigger error to notify user\n\t\t\tZotero.config.useIndexedDB = false;\n\t\t\tlibrary.trigger('indexedDBError');\n\t\t\tlibrary.trigger('cachedDataLoaded');\n\t\t\tZ.error('Error initializing indexedDB. Promise rejected.');\n\t\t\t//don't re-throw error, since we can still load data from the API\n\t\t});\n\t}\n\t\n\tlibrary.dirty = false;\n\t\n\t//set noop data-change callbacks\n\tlibrary.tagsChanged = function(){};\n\tlibrary.collectionsChanged = function(){};\n\tlibrary.itemsChanged = function(){};\n};\n/**\n * Items columns for which sorting is supported\n * @type {Array}\n */\nLibrary.prototype.sortableColumns = ['title',\n\t\t\t\t\t\t\t\t\t\t\t'creator',\n\t\t\t\t\t\t\t\t\t\t\t'itemType',\n\t\t\t\t\t\t\t\t\t\t\t'date',\n\t\t\t\t\t\t\t\t\t\t\t'year',\n\t\t\t\t\t\t\t\t\t\t\t'publisher',\n\t\t\t\t\t\t\t\t\t\t\t'publicationTitle',\n\t\t\t\t\t\t\t\t\t\t\t'journalAbbreviation',\n\t\t\t\t\t\t\t\t\t\t\t'language',\n\t\t\t\t\t\t\t\t\t\t\t'accessDate',\n\t\t\t\t\t\t\t\t\t\t\t'libraryCatalog',\n\t\t\t\t\t\t\t\t\t\t\t'callNumber',\n\t\t\t\t\t\t\t\t\t\t\t'rights',\n\t\t\t\t\t\t\t\t\t\t\t'dateAdded',\n\t\t\t\t\t\t\t\t\t\t\t'dateModified',\n\t\t\t\t\t\t\t\t\t\t\t/*'numChildren',*/\n\t\t\t\t\t\t\t\t\t\t\t'addedBy'\n\t\t\t\t\t\t\t\t\t\t\t/*'modifiedBy'*/];\n/**\n * Columns that can be displayed in an items table UI\n * @type {Array}\n */\nLibrary.prototype.displayableColumns = ['title',\n\t\t\t\t\t\t\t\t\t\t\t'creator',\n\t\t\t\t\t\t\t\t\t\t\t'itemType',\n\t\t\t\t\t\t\t\t\t\t\t'date',\n\t\t\t\t\t\t\t\t\t\t\t'year',\n\t\t\t\t\t\t\t\t\t\t\t'publisher',\n\t\t\t\t\t\t\t\t\t\t\t'publicationTitle',\n\t\t\t\t\t\t\t\t\t\t\t'journalAbbreviation',\n\t\t\t\t\t\t\t\t\t\t\t'language',\n\t\t\t\t\t\t\t\t\t\t\t'accessDate',\n\t\t\t\t\t\t\t\t\t\t\t'libraryCatalog',\n\t\t\t\t\t\t\t\t\t\t\t'callNumber',\n\t\t\t\t\t\t\t\t\t\t\t'rights',\n\t\t\t\t\t\t\t\t\t\t\t'dateAdded',\n\t\t\t\t\t\t\t\t\t\t\t'dateModified',\n\t\t\t\t\t\t\t\t\t\t\t'numChildren',\n\t\t\t\t\t\t\t\t\t\t\t'addedBy'\n\t\t\t\t\t\t\t\t\t\t\t/*'modifiedBy'*/];\n/**\n * Items columns that only apply to group libraries\n * @type {Array}\n */\nLibrary.prototype.groupOnlyColumns = ['addedBy'\n\t\t\t\t\t\t\t\t\t\t\t/*'modifiedBy'*/];\n\n/**\n * Sort function that converts strings to locale lower case before comparing,\n * however this is still not particularly effective at getting correct localized\n * sorting in modern browsers due to browser implementations being poor. What we\n * really want here is to strip diacritics first.\n * @param  {string} a [description]\n * @param  {string} b [description]\n * @return {int}   [description]\n */\nLibrary.prototype.comparer = function(){\n\tif(Intl){\n\t\treturn new Intl.Collator().compare;\n\t} else {\n\t\treturn function(a, b){\n\t\t\tif(a.toLocaleLowerCase() == b.toLocaleLowerCase()){\n\t\t\t\treturn 0;\n\t\t\t}\n\t\t\tif(a.toLocaleLowerCase() < b.toLocaleLowerCase()){\n\t\t\t\treturn -1;\n\t\t\t}\n\t\t\treturn 1;\n\t\t};\n\t}\n};\n\n//Zotero library wrapper around jQuery ajax that returns a jQuery promise\n//@url String url to request or object for input to apiRequestUrl and query string\n//@type request method\n//@options jquery options that are not the default for Zotero requests\nLibrary.prototype.ajaxRequest = function(url, type, options){\n\tZ.debug('Library.ajaxRequest', 3);\n\tif(!type){\n\t\ttype = 'GET';\n\t}\n\tif(!options){\n\t\toptions = {};\n\t}\n\tvar requestObject = {\n\t\turl: url,\n\t\ttype: type\n\t};\n\trequestObject = Z.extend({}, requestObject, options);\n\tZ.debug(requestObject, 3);\n\treturn Zotero.net.queueRequest(requestObject);\n};\n\n//Take an array of objects that specify Zotero API requests and perform them\n//in sequence.\n//return deferred that gets resolved when all requests have gone through.\n//Update versions after each request, otherwise subsequent writes won't go through.\n//or do we depend on specified callbacks to update versions if necessary?\n//fail on error?\n//request object must specify: url, method, body, headers, success callback, fail callback(?)\n\n/**\n * Take an array of objects that specify Zotero API requests and perform them\n * in sequence. Return a promise that gets resolved when all requests have\n * gone through.\n * @param  {[] Objects} requests Array of objects specifying requests to be made\n * @return {Promise}          Promise that resolves/rejects along with requests\n */\nLibrary.prototype.sequentialRequests = function(requests){\n\tZ.debug('Zotero.Library.sequentialRequests', 3);\n\tvar library = this;\n\treturn Zotero.net.queueRequest(requests);\n};\n\n/**\n * Generate a website url based on a dictionary of variables and the configured\n * libraryBaseWebsiteUrl\n * @param  {Object} urlvars Dictionary of key/value variables\n * @return {string}         website url\n */\nLibrary.prototype.websiteUrl = function(urlvars){\n\tZ.debug('Zotero.library.websiteUrl', 3);\n\tZ.debug(urlvars, 4);\n\tvar library = this;\n\t\n\tvar urlVarsArray = [];\n\tObject.keys(urlvars).forEach(function(key){\n\t\tvar value = urlvars[key];\n\t\tif(value === '') return;\n\t\turlVarsArray.push(key + '/' + value);\n\t});\n\turlVarsArray.sort();\n\tZ.debug(urlVarsArray, 4);\n\tvar pathVarsString = urlVarsArray.join('/');\n\t\n\treturn library.libraryBaseWebsiteUrl + '/' + pathVarsString;\n};\n\n\nLibrary.prototype.synchronize = function(){\n\t//get updated group metadata if applicable\n\t//  (this is an individual library method, so only necessary if this is\n\t//  a group library and we want to keep info about it)\n\t//sync library data\n\t//  get updated collections versions newer than current library version\n\t//  get updated searches versions newer than current library version\n\t//  get updated item versions newer than current library version\n\t//\n};\n\n/**\n * Make and process API requests to update the local library items based on the\n * versions we have locally. When the promise is resolved, we should have up to\n * date items in this library's items container, as well as saved to indexedDB\n * if configured to use it.\n * @return {Promise} Promise\n */\nLibrary.prototype.loadUpdatedItems = function(){\n\tZ.debug('Zotero.Library.loadUpdatedItems', 3);\n\tvar library = this;\n\t//sync from the libraryVersion if it exists, otherwise use the itemsVersion, which is likely\n\t//derived from the most recent version of any individual item we have.\n\tvar syncFromVersion = library.libraryVersion ? library.libraryVersion : library.items.itemsVersion;\n\treturn Promise.resolve(library.updatedVersions('items', syncFromVersion))\n\t.then(function(response){\n\t\tZ.debug('itemVersions resolved', 3);\n\t\tZ.debug('items Last-Modified-Version: ' + response.lastModifiedVersion, 3);\n\t\tlibrary.items.updateSyncState(response.lastModifiedVersion);\n\t\t\n\t\tvar itemVersions = response.data;\n\t\tlibrary.itemVersions = itemVersions;\n\t\tvar itemKeys = [];\n\t\tObject.keys(itemVersions).forEach(function(key){\n\t\t\tvar val = itemVersions[key];\n\t\t\tvar item = library.items.getItem(key);\n\t\t\tif((!item) || (item.apiObj.key != val)){\n\t\t\t\titemKeys.push(key);\n\t\t\t}\n\t\t});\n\t\treturn library.loadItemsFromKeys(itemKeys);\n\t}).then(function(responses){\n\t\tZ.debug('loadItemsFromKeys resolved', 3);\n\t\tlibrary.items.updateSyncedVersion();\n\t\t\n\t\t//TODO: library needs its own state\n\t\tvar displayParams = Zotero.state.getUrlVars();\n\t\tlibrary.buildItemDisplayView(displayParams);\n\t\t//save updated items to IDB\n\t\tif(Zotero.config.useIndexedDB){\n\t\t\tvar saveItemsD = library.idbLibrary.updateItems(library.items.objectArray);\n\t\t}\n\t});\n};\n\nLibrary.prototype.loadUpdatedCollections = function(){\n\tZ.debug('Zotero.Library.loadUpdatedCollections', 3);\n\tvar library = this;\n\t//sync from the libraryVersion if it exists, otherwise use the collectionsVersion, which is likely\n\t//derived from the most recent version of any individual collection we have.\n\tZ.debug('library.collections.collectionsVersion:' + library.collections.collectionsVersion);\n\tvar syncFromVersion = library.libraryVersion ? library.libraryVersion : library.collections.collectionsVersion;\n\t//we need modified collectionKeys regardless, so load them\n\treturn library.updatedVersions('collections', syncFromVersion)\n\t.then(function(response){\n\t\tZ.debug('collectionVersions finished', 3);\n\t\tZ.debug('Collections Last-Modified-Version: ' + response.lastModifiedVersion, 3);\n\t\t//start the syncState version tracking. This should be the earliest version throughout\n\t\tlibrary.collections.updateSyncState(response.lastModifiedVersion);\n\t\t\n\t\tvar collectionVersions = response.data;\n\t\tlibrary.collectionVersions = collectionVersions;\n\t\tvar collectionKeys = [];\n\t\tObject.keys(collectionVersions).forEach(function(key){\n\t\t\tvar val = collectionVersions[key];\n\t\t\tvar c = library.collections.getCollection(key);\n\t\t\tif((!c) || (c.apiObj.version != val)){\n\t\t\t\tcollectionKeys.push(key);\n\t\t\t}\n\t\t});\n\t\tif(collectionKeys.length === 0){\n\t\t\tZ.debug('No collectionKeys need updating. resolving', 3);\n\t\t\treturn response;\n\t\t}\n\t\telse {\n\t\t\tZ.debug('fetching collections by key', 3);\n\t\t\treturn library.loadCollectionsFromKeys(collectionKeys)\n\t\t\t.then(function(){\n\t\t\t\tvar collections = library.collections;\n\t\t\t\tcollections.initSecondaryData();\n\t\t\t\t\n\t\t\t\tZ.debug('All updated collections loaded', 3);\n\t\t\t\tlibrary.collections.updateSyncedVersion();\n\t\t\t\t//TODO: library needs its own state\n\t\t\t\tvar displayParams = Zotero.state.getUrlVars();\n\t\t\t\t//save updated collections to cache\n\t\t\t\tZ.debug('loadUpdatedCollections complete - saving collections to cache before resolving', 3);\n\t\t\t\tZ.debug('collectionsVersion: ' + library.collections.collectionsVersion, 3);\n\t\t\t\t//library.saveCachedCollections();\n\t\t\t\t//save updated collections to IDB\n\t\t\t\tif(Zotero.config.useIndexedDB){\n\t\t\t\t\treturn library.idbLibrary.updateCollections(collections.collectionsArray);\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t})\n\t.then(function(){\n\t\tZ.debug('done getting collection data. requesting deleted data', 3);\n\t\treturn library.getDeleted(library.libraryVersion);\n\t})\n\t.then(function(response){\n\t\tZ.debug('got deleted collections data: removing local copies', 3);\n\t\tZ.debug(library.deleted);\n\t\tif(library.deleted.deletedData.collections && library.deleted.deletedData.collections.length > 0 ){\n\t\t\tlibrary.collections.removeLocalCollections(library.deleted.deletedData.collections);\n\t\t}\n\t});\n};\n\nLibrary.prototype.loadUpdatedTags = function(){\n\tZ.debug('Zotero.Library.loadUpdatedTags', 3);\n\tvar library = this;\n\tZ.debug('tagsVersion: ' + library.tags.tagsVersion, 3);\n\treturn Promise.resolve(library.loadAllTags({since:library.tags.tagsVersion}))\n\t.then(function(){\n\t\tZ.debug('done getting tags, request deleted tags data', 3);\n\t\treturn library.getDeleted(library.libraryVersion);\n\t})\n\t.then(function(response){\n\t\tZ.debug('got deleted tags data');\n\t\tif(library.deleted.deletedData.tags && library.deleted.deletedData.tags.length > 0 ){\n\t\t\tlibrary.tags.removeTags(library.deleted.deletedData.tags);\n\t\t}\n\t\t//save updated tags to IDB\n\t\tif(Zotero.config.useIndexedDB){\n\t\t\tZ.debug('saving updated tags to IDB', 3);\n\t\t\tvar saveTagsD = library.idbLibrary.updateTags(library.tags.tagsArray);\n\t\t}\n\t});\n};\n\nLibrary.prototype.getDeleted = function(version) {\n\tZ.debug('Zotero.Library.getDeleted', 3);\n\tvar library = this;\n\tvar urlconf = {\n\t\ttarget:'deleted',\n\t\tlibraryType:library.libraryType,\n\t\tlibraryID:library.libraryID,\n\t\tsince:version\n\t};\n\t\n\t//if there is already a request working, create a new promise to resolve\n\t//when the actual request finishes\n\tif(library.deleted.pending){\n\t\tZ.debug('getDeleted resolving with previously pending promise');\n\t\treturn Promise.resolve(library.deleted.pendingPromise);\n\t}\n\t\n\t//don't fetch again if version we'd be requesting is between\n\t//deleted.newer and delete.deleted versions, just use that one\n\tZ.debug('version:' + version);\n\tZ.debug('sinceVersion:' + library.deleted.sinceVersion);\n\tZ.debug('untilVersion:' + library.deleted.untilVersion);\n\t\n\tif(library.deleted.untilVersion &&\n\t\tversion >= library.deleted.sinceVersion /*&&\n\t\tversion < library.deleted.untilVersion*/){\n\t\tZ.debug('deletedVersion matches requested: immediately resolving');\n\t\treturn Promise.resolve(library.deleted.deletedData);\n\t}\n\t\n\tlibrary.deleted.pending = true;\n\tlibrary.deleted.pendingPromise = library.ajaxRequest(urlconf)\n\t.then(function(response){\n\t\tZ.debug('got deleted response');\n\t\tlibrary.deleted.deletedData = response.data;\n\t\tZ.debug('Deleted Last-Modified-Version:' + response.lastModifiedVersion, 3);\n\t\tlibrary.deleted.untilVersion = response.lastModifiedVersion;\n\t\tlibrary.deleted.sinceVersion = version;\n\t}).then(function(response){\n\t\tZ.debug('cleaning up deleted pending');\n\t\tlibrary.deleted.pending = false;\n\t\tlibrary.deleted.pendingPromise = false;\n\t});\n\t\n\treturn library.deleted.pendingPromise;\n};\n\nLibrary.prototype.processDeletions = function(deletions){\n\tvar library = this;\n\t//process deleted collections\n\tlibrary.collections.processDeletions(deletions.collections);\n\t//process deleted items\n\tlibrary.items.processDeletions(deletions.items);\n};\n\n//Get a full bibliography from the API for web based citating\nLibrary.prototype.loadFullBib = function(itemKeys, style){\n\tvar library = this;\n\tvar itemKeyString = itemKeys.join(',');\n\tvar urlconfig = {\n\t\t'target':'items',\n\t\t'libraryType':library.libraryType,\n\t\t'libraryID':library.libraryID,\n\t\t'itemKey':itemKeyString,\n\t\t'format':'bib',\n\t\t'linkwrap':'1'\n\t};\n\tif(itemKeys.length == 1){\n\t\turlconfig.target = 'item';\n\t}\n\tif(style){\n\t\turlconfig['style'] = style;\n\t}\n\t\n\tvar loadBibPromise = library.ajaxRequest(urlconfig)\n\t.then(function(response){\n\t\treturn response.data;\n\t});\n\t\n\treturn loadBibPromise;\n};\n\n//load bib for a single item from the API\nLibrary.prototype.loadItemBib = function(itemKey, style) {\n\tZ.debug('Zotero.Library.loadItemBib', 3);\n\tvar library = this;\n\tvar urlconfig = {\n\t\t'target':'item',\n\t\t'libraryType':library.libraryType,\n\t\t'libraryID':library.libraryID,\n\t\t'itemKey':itemKey,\n\t\t'content':'bib'\n\t};\n\tif(style){\n\t\turlconfig['style'] = style;\n\t}\n\t\n\tvar itemBibPromise = library.ajaxRequest(urlconfig)\n\t.then(function(response){\n\t\tvar item = new Zotero.Item(response.data);\n\t\tvar bibContent = item.apiObj.bib;\n\t\treturn bibContent;\n\t});\n\t\n\treturn itemBibPromise;\n};\n\n//load library settings from Zotero API and return a promise that gets resolved with\n//the Zotero.Preferences object for this library\nLibrary.prototype.loadSettings = function() {\n\tZ.debug('Zotero.Library.loadSettings', 3);\n\tvar library = this;\n\tvar urlconfig = {\n\t\t'target':'settings',\n\t\t'libraryType':library.libraryType,\n\t\t'libraryID':library.libraryID\n\t};\n\t\n\treturn library.ajaxRequest(urlconfig)\n\t.then(function(response){\n\t\tvar resultObject;\n\t\tif(typeof response.data == 'string'){\n\t\t\tresultObject = JSON.parse(response.data);\n\t\t}\n\t\telse {\n\t\t\tresultObject = response.data;\n\t\t}\n\t\t//save the full settings object so we have it available if we need to write,\n\t\t//even if it has settings we don't use or know about\n\t\tlibrary.preferences.setPref('settings', resultObject);\n\t\t\n\t\t//pull out the settings we know we care about so we can query them directly\n\t\tif(resultObject.tagColors){\n\t\t\tvar tagColors = resultObject.tagColors.value;\n\t\t\tlibrary.preferences.setPref('tagColors', tagColors);\n\t\t\t/*\n\t\t\tfor(var i = 0; i < tagColors.length; i++){\n\t\t\t\tvar t = library.tags.getTag(tagColors[i].name);\n\t\t\t\tif(t){\n\t\t\t\t\tt.color = tagColors[i].color;\n\t\t\t\t}\n\t\t\t}\n\t\t\t*/\n\t\t}\n\t\t\n\t\tlibrary.trigger('settingsLoaded');\n\t\treturn library.preferences;\n\t});\n};\n\n//take an array of tags and return subset of tags that should be colored, along with\n//the colors they should be\nLibrary.prototype.matchColoredTags = function(tags) {\n\tvar library = this;\n\tvar i;\n\tvar tagColorsSettings = library.preferences.getPref('tagColors');\n\tif(!tagColorsSettings) return [];\n\t\n\tvar tagColorsMap = {};\n\tfor(i = 0; i < tagColorsSettings.length; i++){\n\t\ttagColorsMap[tagColorsSettings[i].name.toLowerCase()] = tagColorsSettings[i].color;\n\t}\n\tvar resultTags = [];\n\t\n\tfor(i = 0; i < tags.length; i++){\n\t\tif(tagColorsMap.hasOwnProperty(tags[i]) ) {\n\t\t\tresultTags.push(tagColorsMap[tags[i]]);\n\t\t}\n\t}\n\treturn resultTags;\n};\n\n/**\n * Duplicate existing Items from this library and save to foreignLibrary\n * with relationships indicating the ties. At time of writing, Zotero client\n * saves the relationship with either the destination group of two group\n * libraries or the personal library.\n * @param  {Zotero.Item[]} items\n * @param  {Zotero.Library} foreignLibrary\n * @return {Promise.Zotero.Item[]} - newly created items\n */\nLibrary.prototype.sendToLibrary = function(items, foreignLibrary){\n\tvar foreignItems = [];\n\tfor(var i = 0; i < items.length; i++){\n\t\tvar item = items[i];\n\t\tvar transferData = item.emptyJsonItem();\n\t\ttransferData.data = Z.extend({}, items[i].apiObj.data);\n\t\t//clear data that shouldn't be transferred:itemKey, collections\n\t\ttransferData.data.key = '';\n\t\ttransferData.data.version = 0;\n\t\ttransferData.data.collections = [];\n\t\tdelete transferData.data.dateModified;\n\t\tdelete transferData.data.dateAdded;\n\t\t\n\t\tvar newForeignItem = new Zotero.Item(transferData);\n\t\t\n\t\tnewForeignItem.pristine = Z.extend({}, newForeignItem.apiObj);\n\t\tnewForeignItem.initSecondaryData();\n\t\t\n\t\t//set relationship to tie to old item\n\t\tif(!newForeignItem.apiObj.data.relations){\n\t\t\tnewForeignItem.apiObj.data.relations = {};\n\t\t}\n\t\tnewForeignItem.apiObj.data.relations['owl:sameAs'] = Zotero.url.relationUrl(item.owningLibrary.libraryType, item.owningLibrary.libraryID, item.key);\n\t\tforeignItems.push(newForeignItem);\n\t}\n\treturn foreignLibrary.items.writeItems(foreignItems);\n};\n\n/*METHODS FOR WORKING WITH THE ENTIRE LIBRARY -- NOT FOR GENERAL USE */\n\n//sync pull:\n//upload changed data\n// get updatedVersions for collections\n// get updatedVersions for searches\n// get upatedVersions for items\n// (sanity check versions we have for individual objects?)\n// loadCollectionsFromKeys\n// loadSearchesFromKeys\n// loadItemsFromKeys\n// process updated objects:\n//      ...\n// getDeletedData\n// process deleted\n// checkConcurrentUpdates (compare Last-Modified-Version from collections?newer request to one from /deleted request)\n\nLibrary.prototype.updatedVersions = function(target='items', version=this.libraryVersion){\n\tZ.debug('Library.updatedVersions', 3);\n\tvar library = this;\n\tvar urlconf = {\n\t\ttarget: target,\n\t\tformat: 'versions',\n\t\tlibraryType: library.libraryType,\n\t\tlibraryID: library.libraryID,\n\t\tsince: version\n\t};\n\treturn library.ajaxRequest(urlconf);\n};\n\n//Download and save information about every item in the library\n//keys is an array of itemKeys from this library that we need to download\nLibrary.prototype.loadItemsFromKeys = function(keys){\n\tZotero.debug('Zotero.Library.loadItemsFromKeys', 3);\n\tvar library = this;\n\treturn library.loadFromKeys(keys, 'items');\n};\n\n//keys is an array of collectionKeys from this library that we need to download\nLibrary.prototype.loadCollectionsFromKeys = function(keys){\n\tZotero.debug('Zotero.Library.loadCollectionsFromKeys', 3);\n\tvar library = this;\n\treturn library.loadFromKeys(keys, 'collections');\n};\n\n//keys is an array of searchKeys from this library that we need to download\nLibrary.prototype.loadSeachesFromKeys = function(keys){\n\tZotero.debug('Zotero.Library.loadSearchesFromKeys', 3);\n\tvar library = this;\n\treturn library.loadFromKeys(keys, 'searches');\n};\n\nLibrary.prototype.loadFromKeys = function(keys, objectType){\n\tZotero.debug('Zotero.Library.loadFromKeys', 3);\n\tif(!objectType) objectType = 'items';\n\tvar library = this;\n\tvar keyslices = [];\n\twhile(keys.length > 0){\n\t\tkeyslices.push(keys.splice(0, 50));\n\t}\n\t\n\tvar requestObjects = [];\n\tkeyslices.forEach(function(keyslice){\n\t\tvar keystring = keyslice.join(',');\n\t\tswitch (objectType) {\n\t\t\tcase 'items':\n\t\t\t\trequestObjects.push({\n\t\t\t\t\turl: {\n\t\t\t\t\t\t'target':'items',\n\t\t\t\t\t\t'targetModifier':null,\n\t\t\t\t\t\t'itemKey':keystring,\n\t\t\t\t\t\t'limit':50,\n\t\t\t\t\t\t'libraryType':library.libraryType,\n\t\t\t\t\t\t'libraryID':library.libraryID\n\t\t\t\t\t},\n\t\t\t\t\ttype: 'GET',\n\t\t\t\t\tsuccess: library.processLoadedItems.bind(library)\n\t\t\t\t});\n\t\t\t\tbreak;\n\t\t\tcase 'collections':\n\t\t\t\trequestObjects.push({\n\t\t\t\t\turl: {\n\t\t\t\t\t\t'target':'collections',\n\t\t\t\t\t\t'targetModifier':null,\n\t\t\t\t\t\t'collectionKey':keystring,\n\t\t\t\t\t\t'limit':50,\n\t\t\t\t\t\t'libraryType':library.libraryType,\n\t\t\t\t\t\t'libraryID':library.libraryID\n\t\t\t\t\t},\n\t\t\t\t\ttype: 'GET',\n\t\t\t\t\tsuccess: library.processLoadedCollections.bind(library)\n\t\t\t\t});\n\t\t\t\tbreak;\n\t\t\tcase 'searches':\n\t\t\t\trequestObjects.push({\n\t\t\t\t\turl: {\n\t\t\t\t\t\t'target':'searches',\n\t\t\t\t\t\t'targetModifier':null,\n\t\t\t\t\t\t'searchKey':keystring,\n\t\t\t\t\t\t'limit':50,\n\t\t\t\t\t\t'libraryType':library.libraryType,\n\t\t\t\t\t\t'libraryID':library.libraryID\n\t\t\t\t\t},\n\t\t\t\t\ttype: 'GET'\n\t\t\t\t\t//success: library.processLoadedSearches.bind(library)\n\t\t\t\t});\n\t\t\t\tbreak;\n\t\t}\n\t});\n\t\n\tvar promises = [];\n\tfor(var i = 0; i < requestObjects.length; i++){\n\t\tpromises.push(Zotero.net.queueRequest(requestObjects[i]));\n\t}\n\treturn Promise.all(promises);\n\t/*\n\treturn Zotero.net.queueRequest(requestObjects);\n\t*/\n};\n\n//publishes: displayedItemsUpdated\n//assume we have up to date information about items in indexeddb.\n//build a list of indexedDB filter requests to then intersect to get final result\nLibrary.prototype.buildItemDisplayView = function(params) {\n\tZ.debug('Zotero.Library.buildItemDisplayView', 3);\n\tZ.debug(params, 4);\n\t//start with list of all items if we don't have collectionKey\n\t//otherwise get the list of items in that collection\n\tvar library = this;\n\t//short-circuit if we don't have an initialized IDB yet\n\tif(!library.idbLibrary.db){\n\t\treturn Promise.resolve([]);\n\t}\n\t\n\tvar filterPromises = [];\n\tif(params.collectionKey){\n\t\tif(params.collectionKey == 'trash'){\n\t\t\tfilterPromises.push(library.idbLibrary.filterItems('deleted', 1));\n\t\t}\n\t\telse{\n\t\t\tfilterPromises.push(library.idbLibrary.filterItems('collectionKeys', params.collectionKey));\n\t\t}\n\t}\n\telse {\n\t\tfilterPromises.push(library.idbLibrary.getOrderedItemKeys('title'));\n\t}\n\t\n\t//filter by selected tags\n\tvar selectedTags = params.tag || [];\n\tif(typeof selectedTags == 'string') selectedTags = [selectedTags];\n\tfor(var i = 0; i < selectedTags.length; i++){\n\t\tZ.debug('adding selected tag filter', 3);\n\t\tfilterPromises.push(library.idbLibrary.filterItems('itemTagStrings', selectedTags[i]));\n\t}\n\t\n\t//TODO: filter by search term. \n\t//(need full text array or to decide what we're actually searching on to implement this locally)\n\t\n\t//when all the filters have been applied, combine and sort\n\treturn Promise.all(filterPromises)\n\t.then(function(results){\n\t\tvar i;\n\t\tfor(i = 0; i < results.length; i++){\n\t\t\tZ.debug('result from filterPromise: ' + results[i].length, 3);\n\t\t\tZ.debug(results[i], 3);\n\t\t}\n\t\tvar finalItemKeys = library.idbLibrary.intersectAll(results);\n\t\tvar itemsArray = library.items.getItems(finalItemKeys);\n\t\t\n\t\tZ.debug('All filters applied - Down to ' + itemsArray.length + ' items displayed', 3);\n\t\t\n\t\tZ.debug('remove child items and, if not viewing trash, deleted items', 3);\n\t\tvar displayItemsArray = [];\n\t\tfor(i = 0; i < itemsArray.length; i++){\n\t\t\tif(itemsArray[i].apiObj.data.parentItem){\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\t\n\t\t\tif(params.collectionKey != 'trash' && itemsArray[i].apiObj.deleted){\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\t\n\t\t\tdisplayItemsArray.push(itemsArray[i]);\n\t\t}\n\t\t\n\t\t//sort displayedItemsArray by given or configured column\n\t\tvar orderCol = params['order'] || 'title';\n\t\tvar sort = params['sort'] || 'asc';\n\t\tZ.debug('Sorting by ' + orderCol + ' - ' + sort, 3);\n\t\t\n\t\tvar comparer = Zotero.Library.prototype.comparer();\n\t\t\n\t\tdisplayItemsArray.sort(function(a, b){\n\t\t\tvar aval = a.get(orderCol);\n\t\t\tvar bval = b.get(orderCol);\n\t\t\t\n\t\t\treturn comparer(aval, bval);\n\t\t});\n\t\t\n\t\tif(sort == 'desc'){\n\t\t\tZ.debug('sort is desc - reversing array', 4);\n\t\t\tdisplayItemsArray.reverse();\n\t\t}\n\t\t\n\t\t//publish event signalling we're done\n\t\tZ.debug('triggering publishing displayedItemsUpdated', 3);\n\t\tlibrary.trigger('displayedItemsUpdated');\n\t\treturn displayItemsArray;\n\t});\n};\n\nLibrary.prototype.trigger = function(eventType, data){\n\tvar library = this;\n\tZotero.trigger(eventType, data, library.libraryString);\n};\n\nLibrary.prototype.listen = function(events, handler, data){\n\tvar library = this;\n\tvar filter = library.libraryString;\n\tZotero.listen(events, handler, data, filter);\n};\n\n//CollectionFunctions\nLibrary.prototype.processLoadedCollections = function(response){\n\tZ.debug('processLoadedCollections', 3);\n\tvar library = this;\n\t\n\t//clear out display items\n\tZ.debug('adding collections to library.collections');\n\tvar collectionsAdded = library.collections.addCollectionsFromJson(response.data);\n\tfor (var i = 0; i < collectionsAdded.length; i++) {\n\t\tcollectionsAdded[i].associateWithLibrary(library);\n\t}\n\t//update sync state\n\tlibrary.collections.updateSyncState(response.lastModifiedVersion);\n\t\n\tZotero.trigger('loadedCollectionsProcessed', {library:library, collectionsAdded:collectionsAdded});\n\treturn response;\n};\n\n//create+write a collection given a name and optional parentCollectionKey\nLibrary.prototype.addCollection = function(name, parentCollection){\n\tZ.debug('Zotero.Library.addCollection', 3);\n\tvar library = this;\n\t\n\tvar collection = new Zotero.Collection();\n\tcollection.associateWithLibrary(library);\n\tcollection.set('name', name);\n\tcollection.set('parentCollection', parentCollection);\n\t\n\treturn library.collections.writeCollections([collection]);\n};\n\n//ItemFunctions\n//make request for item keys and return jquery ajax promise\nLibrary.prototype.fetchItemKeys = function(config={}){\n\tZ.debug('Zotero.Library.fetchItemKeys', 3);\n\tvar library = this;\n\tvar urlconfig = Z.extend(true, {\n\t\t'target':'items',\n\t\t'libraryType':this.libraryType,\n\t\t'libraryID':this.libraryID,\n\t\t'format':'keys'\n\t}, config);\n\t\n\treturn library.ajaxRequest(urlconfig);\n};\n\n//get keys of all items marked for deletion\nLibrary.prototype.getTrashKeys = function(){\n\tZ.debug('Zotero.Library.getTrashKeys', 3);\n\tvar library = this;\n\tvar urlconfig = {\n\t\t'target': 'items',\n\t\t'libraryType': library.libraryType,\n\t\t'libraryID': library.libraryID,\n\t\t'format': 'keys',\n\t\t'collectionKey': 'trash'\n\t};\n\t\n\treturn library.ajaxRequest(urlconfig);\n};\n\nLibrary.prototype.emptyTrash = function(){\n\tZ.debug('Zotero.Library.emptyTrash', 3);\n\tvar library = this;\n\treturn library.getTrashKeys()\n\t.then(function(response){\n\t\tvar trashedItemKeys = response.data.split('\\n');\n\t\treturn library.items.deleteItems(trashedItemKeys, response.lastModifiedVersion);\n\t});\n};\n\nLibrary.prototype.loadItemKeys = function(config){\n\tZ.debug('Zotero.Library.loadItemKeys', 3);\n\tvar library = this;\n\treturn this.fetchItemKeys(config)\n\t.then(function(response){\n\t\tZ.debug('loadItemKeys proxied callback', 3);\n\t\tvar keys = response.data.split(/[\\s]+/);\n\t\tlibrary.itemKeys = keys;\n\t});\n};\n\nLibrary.prototype.loadItems = function(config){\n\tZ.debug('Zotero.Library.loadItems', 3);\n\tvar library = this;\n\tif(!config){\n\t\tconfig = {};\n\t}\n\t\n\tvar defaultConfig = {\n\t\ttarget:'items',\n\t\ttargetModifier: 'top',\n\t\tstart: 0,\n\t\tlimit: 25,\n\t\torder: Zotero.config.defaultSortColumn,\n\t\tsort: Zotero.config.defaultSortOrder\n\t};\n\t\n\t//Build config object that should be displayed next and compare to currently displayed\n\tvar newConfig = Z.extend({}, defaultConfig, config);\n\t//newConfig.start = parseInt(newConfig.limit, 10) * (parseInt(newConfig.itemPage, 10) - 1);\n\t\n\tvar urlconfig = Z.extend({\n\t\t'target':'items',\n\t\t'libraryType':library.libraryType,\n\t\t'libraryID':library.libraryID\n\t}, newConfig);\n\tvar requestUrl = Zotero.ajax.apiRequestString(urlconfig);\n\t\n\treturn library.ajaxRequest(requestUrl)\n\t.then(function(response){\n\t\tZ.debug('loadItems proxied callback', 3);\n\t\t//var library = this;\n\t\tvar items = library.items;\n\t\t//clear out display items\n\t\tvar loadedItemsArray = items.addItemsFromJson(response.data);\n\t\tZ.debug('Looping over loadedItemsArray');\n\t\tfor (let i = 0; i < loadedItemsArray.length; i++) {\n\t\t\tloadedItemsArray[i].associateWithLibrary(library);\n\t\t}\n\t\t\n\t\tresponse.loadedItems = loadedItemsArray;\n\t\tZotero.trigger('itemsChanged', {library:library});\n\t\treturn response;\n\t});\n};\n\nLibrary.prototype.loadPublications = function(config){\n\tZ.debug('Zotero.Library.loadPublications', 3);\n\tvar library = this;\n\tif(!config){\n\t\tconfig = {};\n\t}\n\t\n\tvar defaultConfig = {\n\t\ttarget:'publications',\n\t\tstart: 0,\n\t\tlimit: 50,\n\t\torder: Zotero.config.defaultSortColumn,\n\t\tsort: Zotero.config.defaultSortOrder,\n\t\tinclude: 'bib'\n\t};\n\t\n\t//Build config object that should be displayed next and compare to currently displayed\n\tvar newConfig = Z.extend({}, defaultConfig, config);\n\t\n\tvar urlconfig = Z.extend({\n\t\t'target':'publications',\n\t\t'libraryType':library.libraryType,\n\t\t'libraryID':library.libraryID\n\t}, newConfig);\n\tvar requestUrl = Zotero.ajax.apiRequestString(urlconfig);\n\t\n\treturn library.ajaxRequest(requestUrl)\n\t.then(function(response){\n\t\tZ.debug('loadPublications proxied callback', 3);\n\t\tvar publicationItems = [];\n\t\tvar parsedItemJson = response.data;\n\t\tparsedItemJson.forEach(function(itemObj){\n\t\t\tvar item = new Zotero.Item(itemObj);\n\t\t\tpublicationItems.push(item);\n\t\t});\n\t\t\n\t\tresponse.publicationItems = publicationItems;\n\t\treturn response;\n\t});\n};\n\nLibrary.prototype.processLoadedItems = function(response){\n\tZ.debug('processLoadedItems', 3);\n\tvar library = this;\n\tvar items = library.items;\n\t//clear out display items\n\tvar loadedItemsArray = items.addItemsFromJson(response.data);\n\tfor (var i = 0; i < loadedItemsArray.length; i++) {\n\t\tloadedItemsArray[i].associateWithLibrary(library);\n\t}\n\t\n\t//update sync state\n\tlibrary.items.updateSyncState(response.lastModifiedVersion);\n\t\n\tZotero.trigger('itemsChanged', {library:library, loadedItems:loadedItemsArray});\n\treturn response;\n};\n\nLibrary.prototype.loadItem = function(itemKey) {\n\tZ.debug('Zotero.Library.loadItem', 3);\n\tvar library = this;\n\tif(!config){\n\t\tvar config = {};\n\t}\n\t\n\tvar urlconfig = {\n\t\t'target':'item',\n\t\t'libraryType':library.libraryType,\n\t\t'libraryID':library.libraryID,\n\t\t'itemKey':itemKey\n\t};\n\t\n\treturn library.ajaxRequest(urlconfig)\n\t.then(function(response){\n\t\tZ.debug('Got loadItem response');\n\t\tvar item = new Zotero.Item(response.data);\n\t\titem.owningLibrary = library;\n\t\tlibrary.items.itemObjects[item.key] = item;\n\t\tZotero.trigger('itemsChanged', {library:library});\n\t\treturn(item);\n\t},\n\tfunction(response){\n\t\tZ.debug('Error loading Item');\n\t});\n};\n\nLibrary.prototype.trashItem = function(itemKey){\n\tvar library = this;\n\treturn library.items.trashItems([library.items.getItem(itemKey)]);\n};\n\nLibrary.prototype.untrashItem = function(itemKey){\n\tZ.debug('Zotero.Library.untrashItem', 3);\n\tif(!itemKey) return false;\n\t\n\tvar item = this.items.getItem(itemKey);\n\titem.apiObj.deleted = 0;\n\treturn item.writeItem();\n};\n\nLibrary.prototype.deleteItem = function(itemKey){\n\tZ.debug('Zotero.Library.deleteItem', 3);\n\tvar library = this;\n\treturn library.items.deleteItem(itemKey);\n};\n\nLibrary.prototype.deleteItems = function(itemKeys){\n\tZ.debug('Zotero.Library.deleteItems', 3);\n\tvar library = this;\n\treturn library.items.deleteItems(itemKeys);\n};\n\nLibrary.prototype.addNote = function(itemKey, note){\n\tZ.debug('Zotero.Library.prototype.addNote', 3);\n\tvar library = this;\n\tvar config = {\n\t\t'target':'children',\n\t\t'libraryType':library.libraryType,\n\t\t'libraryID':library.libraryID,\n\t\t'itemKey':itemKey\n\t};\n\t\n\tvar requestUrl = Zotero.ajax.apiRequestString(config);\n\tvar item = this.items.getItem(itemKey);\n\t\n\treturn library.ajaxRequest(requestUrl, 'POST', {processData: false});\n};\n\nLibrary.prototype.fetchGlobalItems = function(config){\n\tZ.debug('Zotero.Library.fetchGlobalItems', 3);\n\tvar library = this;\n\tif(!config){\n\t\tconfig = {};\n\t}\n\t\n\tvar defaultConfig = {\n\t\ttarget:'items',\n\t\tstart: 0,\n\t\tlimit: 25\n\t};\n\t\n\t//Build config object that should be displayed next and compare to currently displayed\n\tvar newConfig = Z.extend({}, defaultConfig, config);\n\t//newConfig.start = parseInt(newConfig.limit, 10) * (parseInt(newConfig.itemPage, 10) - 1);\n\t\n\tvar urlconfig = Z.extend({'target':'items', 'libraryType': ''}, newConfig);\n\tvar requestUrl = Zotero.ajax.apiRequestString(urlconfig);\n\t\n\treturn library.ajaxRequest(requestUrl, 'GET', {dataType:'json'})\n\t.then(function(response){\n\t\tZ.debug('globalItems callback', 3);\n\t\treturn(response.data);\n\t});\n};\n\nLibrary.prototype.fetchGlobalItem = function(globalKey){\n\tZ.debug('Zotero.Library.fetchGlobalItem', 3);\n\tZ.debug(globalKey);\n\tvar library = this;\n\t\n\tvar defaultConfig = {target:'item'};\n\t\n\t//Build config object that should be displayed next and compare to currently displayed\n\tvar newConfig = Z.extend({}, defaultConfig);\n\tvar urlconfig = Z.extend({\n\t\t'target':'item',\n\t\t'libraryType': '',\n\t\t'itemKey': globalKey\n\t}, newConfig);\n\tvar requestUrl = Zotero.ajax.apiRequestString(urlconfig);\n\t\n\treturn library.ajaxRequest(requestUrl, 'GET', {dataType:'json'})\n\t.then(function(response){\n\t\tZ.debug('globalItem callback', 3);\n\t\treturn(response.data);\n\t});\n};\n\n//TagFunctions\nLibrary.prototype.fetchTags = function(config){\n\tZ.debug('Zotero.Library.fetchTags', 3);\n\tvar library = this;\n\tvar defaultConfig = {\n\t\ttarget:'tags',\n\t\torder:'title',\n\t\tsort:'asc',\n\t\tlimit: 100\n\t};\n\tvar newConfig = Z.extend({}, defaultConfig, config);\n\tvar urlconfig = Z.extend({\n\t\t'target':'tags',\n\t\t'libraryType':this.libraryType,\n\t\t'libraryID':this.libraryID\n\t}, newConfig);\n\t\n\treturn Zotero.ajaxRequest(urlconfig);\n};\n\nLibrary.prototype.loadTags = function(config={}){\n\tZ.debug('Zotero.Library.loadTags', 3);\n\tvar library = this;\n\t\n\tif(config.showAutomaticTags && config.collectionKey){\n\t\tdelete config.collectionKey;\n\t}\n\t\n\tlibrary.tags.displayTagsArray = [];\n\treturn library.fetchTags(config)\n\t.then(function(response){\n\t\tZ.debug('loadTags proxied callback', 3);\n\t\tvar updatedVersion = response.lastModifiedVersion;\n\t\tlibrary.tags.updateSyncState(updatedVersion);\n\t\tvar addedTags = library.tags.addTagsFromJson(response.data);\n\t\tlibrary.tags.updateTagsVersion(updatedVersion);\n\t\tlibrary.tags.rebuildTagsArray();\n\t\t\n\t\tif(response.parsedLinks.hasOwnProperty('next')){\n\t\t\tlibrary.tags.hasNextLink = true;\n\t\t\tlibrary.tags.nextLink = response.parsedLinks['next'];\n\t\t}\n\t\telse{\n\t\t\tlibrary.tags.hasNextLink = false;\n\t\t\tlibrary.tags.nextLink = null;\n\t\t}\n\t\tlibrary.trigger('tagsChanged', {library:library});\n\t\treturn library.tags;\n\t});\n};\n\n\nLibrary.prototype.loadAllTags = function(config={}){\n\tZ.debug('Zotero.Library.loadAllTags', 3);\n\tvar library = this;\n\tvar defaultConfig = {\n\t\ttarget:'tags',\n\t\torder:'title',\n\t\tsort:'asc',\n\t\tlimit: 100,\n\t\tlibraryType:library.libraryType,\n\t\tlibraryID:library.libraryID\n\t};\n\t\n\t//Build config object that should be displayed next and compare to currently displayed\n\tvar newConfig = Z.extend({}, defaultConfig, config);\n\tvar urlconfig = Z.extend({}, newConfig);\n\tvar requestUrl = Zotero.ajax.apiRequestString(urlconfig);\n\tvar tags = library.tags;\n\t\n\t//check if already loaded tags are okay to use\n\tvar loadedConfig = Z.extend({}, defaultConfig, tags.loadedConfig);\n\tvar loadedConfigRequestUrl = tags.loadedRequestUrl;\n\tZ.debug('requestUrl: ' + requestUrl, 4);\n\tZ.debug('loadedConfigRequestUrl: ' + loadedConfigRequestUrl, 4);\n\treturn new Promise(function(resolve, reject){\n\t\tvar continueLoadingCallback = function(tags){\n\t\t\tZ.debug('loadAllTags continueLoadingCallback', 3);\n\t\t\tvar plainList = Zotero.Tags.prototype.plainTagsList(tags.tagsArray);\n\t\t\tplainList.sort(Library.prototype.comparer());\n\t\t\ttags.plainList = plainList;\n\t\t\t\n\t\t\tif(tags.hasNextLink){\n\t\t\t\tZ.debug('still has next link.', 3);\n\t\t\t\ttags.tagsArray.sort(Zotero.Tag.prototype.tagComparer());\n\t\t\t\tplainList = Zotero.Tags.prototype.plainTagsList(tags.tagsArray);\n\t\t\t\tplainList.sort(Library.prototype.comparer());\n\t\t\t\ttags.plainList = plainList;\n\t\t\t\t\n\t\t\t\tvar nextLink = tags.nextLink;\n\t\t\t\tvar nextLinkConfig = Zotero.utils.parseQuery(Zotero.utils.querystring(nextLink));\n\t\t\t\tvar newConfig = Z.extend({}, config);\n\t\t\t\tnewConfig.start = nextLinkConfig.start;\n\t\t\t\tnewConfig.limit = nextLinkConfig.limit;\n\t\t\t\treturn library.loadTags(newConfig).then(continueLoadingCallback);\n\t\t\t}\n\t\t\telse{\n\t\t\t\tZ.debug('no next in tags link', 3);\n\t\t\t\ttags.updateSyncedVersion();\n\t\t\t\ttags.tagsArray.sort(Zotero.Tag.prototype.tagComparer());\n\t\t\t\tplainList = Zotero.Tags.prototype.plainTagsList(tags.tagsArray);\n\t\t\t\tplainList.sort(Library.prototype.comparer());\n\t\t\t\ttags.plainList = plainList;\n\t\t\t\tZ.debug('resolving loadTags deferred', 3);\n\t\t\t\tlibrary.tagsLoaded = true;\n\t\t\t\tlibrary.tags.loaded = true;\n\t\t\t\ttags.loadedConfig = config;\n\t\t\t\ttags.loadedRequestUrl = requestUrl;\n\t\t\t\t\n\t\t\t\t//update all tags with tagsVersion\n\t\t\t\tfor (var i = 0; i < library.tags.tagsArray.length; i++) {\n\t\t\t\t\ttags.tagsArray[i].apiObj.version = tags.tagsVersion;\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\tlibrary.trigger('tagsChanged', {library:library});\n\t\t\t\treturn tags;\n\t\t\t}\n\t\t};\n\t\t\n\t\tresolve( library.loadTags(urlconfig)\n\t\t.then(continueLoadingCallback));\n\t});\n};\n\n//LibraryCache\n//load objects from indexedDB\nLibrary.prototype.loadIndexedDBCache = function(){\n\tZotero.debug('Zotero.Library.loadIndexedDBCache', 3);\n\t\n\tvar library = this;\n\t\n\tvar itemsPromise = library.idbLibrary.getAllItems();\n\tvar collectionsPromise = library.idbLibrary.getAllCollections();\n\tvar tagsPromise = library.idbLibrary.getAllTags();\n\t\n\titemsPromise.then(function(itemsArray){\n\t\tZ.debug('loadIndexedDBCache itemsD done', 3);\n\t\t//create itemsDump from array of item objects\n\t\tvar latestItemVersion = 0;\n\t\tfor(var i = 0; i < itemsArray.length; i++){\n\t\t\tvar item = new Zotero.Item(itemsArray[i]);\n\t\t\tlibrary.items.addItem(item);\n\t\t\tif(item.version > latestItemVersion){\n\t\t\t\tlatestItemVersion = item.version;\n\t\t\t}\n\t\t}\n\t\tlibrary.items.itemsVersion = latestItemVersion;\n\t\t\n\t\t//TODO: add itemsVersion as last version in any of these items?\n\t\t//or store it somewhere else for indexedDB cache purposes\n\t\tlibrary.items.loaded = true;\n\t\tZ.debug('Done loading indexedDB items promise into library', 3);\n\t});\n\t\n\tcollectionsPromise.then(function(collectionsArray){\n\t\tZ.debug('loadIndexedDBCache collectionsD done', 3);\n\t\t//create collectionsDump from array of collection objects\n\t\tvar latestCollectionVersion = 0;\n\t\tfor(var i = 0; i < collectionsArray.length; i++){\n\t\t\tvar collection = new Zotero.Collection(collectionsArray[i]);\n\t\t\tlibrary.collections.addCollection(collection);\n\t\t\tif(collection.version > latestCollectionVersion){\n\t\t\t\tlatestCollectionVersion = collection.version;\n\t\t\t}\n\t\t}\n\t\tlibrary.collections.collectionsVersion = latestCollectionVersion;\n\t\t\n\t\t//TODO: add collectionsVersion as last version in any of these items?\n\t\t//or store it somewhere else for indexedDB cache purposes\n\t\tlibrary.collections.initSecondaryData();\n\t\tlibrary.collections.loaded = true;\n\t});\n\t\n\ttagsPromise.then(function(tagsArray){\n\t\tZ.debug('loadIndexedDBCache tagsD done', 3);\n\t\tZ.debug(tagsArray);\n\t\t//create tagsDump from array of tag objects\n\t\tvar latestVersion = 0;\n\t\tvar tagsVersion = 0;\n\t\tfor(var i = 0; i < tagsArray.length; i++){\n\t\t\tvar tag = new Zotero.Tag(tagsArray[i]);\n\t\t\tlibrary.tags.addTag(tag);\n\t\t\tif(tagsArray[i].version > latestVersion){\n\t\t\t\tlatestVersion = tagsArray[i].version;\n\t\t\t}\n\t\t}\n\t\ttagsVersion = latestVersion;\n\t\tlibrary.tags.tagsVersion = tagsVersion;\n\n\t\t//TODO: add tagsVersion as last version in any of these items?\n\t\t//or store it somewhere else for indexedDB cache purposes\n\t\tlibrary.tags.loaded = true;\n\t});\n\t\n\t\n\t//resolve the overall deferred when all the child deferreds are finished\n\treturn Promise.all([itemsPromise, collectionsPromise, tagsPromise]);\n};\n\nLibrary.prototype.saveIndexedDB = function(){\n\tvar library = this;\n\t\n\tvar saveItemsPromise = library.idbLibrary.updateItems(library.items.itemsArray);\n\tvar saveCollectionsPromise = library.idbLibrary.updateCollections(library.collections.collectionsArray);\n\tvar saveTagsPromise = library.idbLibrary.updateTags(library.tags.tagsArray);\n\t\n\t//resolve the overall deferred when all the child deferreds are finished\n\treturn Promise.all([saveItemsPromise, saveCollectionsPromise, saveTagsPromise]);\n};\n\nmodule.exports = Library;\n\n","'use strict';\n\nvar ItemMaps = require('./ItemMaps.js');\n\nmodule.exports.fieldMap = ItemMaps.fieldMap;\nmodule.exports.typeMap = ItemMaps.typeMap;\nmodule.exports.creatorMap = ItemMaps.creatorMap;","'use strict';\n\nvar Deferred = require('deferred');\n/*\n * Make concurrent and sequential network requests, respecting backoff/retry-after\n * headers, and keeping concurrent requests below a certain limit.\n * \n * Push onto the queue individual or arrays of requestConfig objects\n * If there is room for requests and we are not currently backing off:\n *   start a sequential series, or individual request\n * When any request or set of requests finishes, we preprocess the response,\n * looking for backoff/retry-after to obey, and putting sequential responses\n * into an array. We then trigger the next waiting request.\n * \n */\n\nvar Net = function() {\n\tthis.deferredQueue = [];\n\tthis.numRunning = 0;\n\tthis.numConcurrent = 3;\n\tthis.backingOff = false;\n};\n\nNet.prototype.queueDeferred = function(){\n\tvar net = this;\n\tvar d = new Deferred();\n\tnet.deferredQueue.push(d);\n\treturn Promise.resolve(d);\n};\n\nNet.prototype.queueRequest = function(requestObject){\n\tZ.debug('Zotero.Net.queueRequest', 3);\n\tvar net = this;\n\tvar resultPromise;\n\t\n\tif(Array.isArray(requestObject)){\n\t\tresultPromise = net.queueDeferred().then(function(){\n\t\t\tZ.debug('running sequential after queued deferred resolved', 4);\n\t\t\treturn net.runSequential(requestObject);\n\t\t}).then(function(response){\n\t\t\tZ.debug('runSequential done', 3);\n\t\t\tnet.queuedRequestDone();\n\t\t\treturn response;\n\t\t});\n\t}\n\telse {\n\t\tresultPromise = net.queueDeferred().then(function(){\n\t\t\tZ.debug('running concurrent after queued deferred resolved', 4);\n\t\t\treturn net.runConcurrent(requestObject);\n\t\t}).then(function(response){\n\t\t\tZ.debug('done with queuedRequest');\n\t\t\tnet.queuedRequestDone();\n\t\t\treturn response;\n\t\t});\n\t}\n\t\n\tnet.runNext();\n\treturn resultPromise.catch(function(error){\n\t\tZ.error('Error before leaving Zotero.Net');\n\t\tZ.error(error);\n\t});\n};\n\nNet.prototype.runConcurrent = function(requestObject){\n\tZ.debug('Zotero.Net.runConcurrent', 3);\n\treturn this.ajaxRequest(requestObject).then(function(response){\n\t\tZ.debug('done with runConcurrent request');\n\t\treturn response;\n\t});\n};\n\n//run the set of requests serially\n//chaining each request onto the .then of the previous one, after\n//adding the previous response to a responses array that will be\n//returned via promise to the caller when all requests are complete\nNet.prototype.runSequential = function(requestObjects){\n\tZ.debug('Zotero.Net.runSequential', 3);\n\tvar net = this;\n\tvar responses = [];\n\tvar seqPromise = Promise.resolve();\n\t\n\tfor(var i = 0; i < requestObjects.length; i++){\n\t\tvar requestObject = requestObjects[i];\n\t\tseqPromise = seqPromise.then(function(){\n\t\t\tvar p = net.ajaxRequest(requestObject)\n\t\t\t.then(function(response){\n\t\t\t\tZ.debug('pushing sequential response into result array');\n\t\t\t\tresponses.push(response);\n\t\t\t});\n\t\t\treturn p;\n\t\t});\n\t}\n\t\n\treturn seqPromise.then(function(){\n\t\tZ.debug('done with sequential aggregator promise - returning responses');\n\t\treturn responses;\n\t});\n};\n\n//when one concurrent call, or a sequential series finishes, subtract it from the running\n//count and run the next if there is something waiting to be run\nNet.prototype.individualRequestDone = function(response){\n\tZ.debug('Zotero.Net.individualRequestDone', 3);\n\tvar net = this;\n\t\n\t//check if we need to back off before making more requests\n\tvar wait = net.checkDelay(response);\n\tif(wait > 0){\n\t\tvar waitms = wait * 1000;\n\t\tnet.backingOff = true;\n\t\tvar waitExpiration = Date.now() + waitms;\n\t\tif(waitExpiration > net.waitingExpires){\n\t\t\tnet.waitingExpires = waitExpiration;\n\t\t}\n\t\tsetTimeout(net.runNext, waitms);\n\t}\n\t\n\treturn response;\n};\n\nNet.prototype.queuedRequestDone = function(response){\n\tZ.debug('queuedRequestDone', 3);\n\tvar net = this;\n\tnet.numRunning--;\n\tnet.runNext();\n\treturn response;\n};\n\nNet.prototype.runNext = function(){\n\tZ.debug('Zotero.Net.runNext', 3);\n\tvar net = this;\n\tvar nowms = Date.now();\n\t\n\t//check if we're backing off and need to remain backing off,\n\t//or if we should now continue\n\tif(net.backingOff && (net.waitingExpires > (nowms - 100)) ){\n\t\tZ.debug('currently backing off', 3);\n\t\tvar waitms = net.waitingExpires - nowms;\n\t\tsetTimeout(net.runNext, waitms);\n\t\treturn;\n\t}\n\telse if(net.backingOff && (net.waitingExpires <= (nowms - 100))){\n\t\tnet.backingOff = false;\n\t}\n\t\n\t//continue making requests up to the concurrent limit\n\tZ.debug(net.numRunning + '/' + net.numConcurrent + ' Running. ' + net.deferredQueue.length + ' queued.', 3);\n\twhile((net.deferredQueue.length > 0) && (net.numRunning < net.numConcurrent)){\n\t\tnet.numRunning++;\n\t\tvar nextD = net.deferredQueue.shift();\n\t\tnextD.resolve();\n\t\tZ.debug(net.numRunning + '/' + net.numConcurrent + ' Running. ' + net.deferredQueue.length + ' queued.', 3);\n\t}\n};\n\nNet.prototype.checkDelay = function(response){\n\tZ.debug('Zotero.Net.checkDelay');\n\tZ.debug(response);\n\tvar net = this;\n\tvar wait = 0;\n\tif(Array.isArray(response)){\n\t\tfor(var i = 0; i < response.length; i++){\n\t\t\tvar iwait = net.checkDelay(response[i]);\n\t\t\tif(iwait > wait){\n\t\t\t\twait = iwait;\n\t\t\t}\n\t\t}\n\t}\n\telse {\n\t\tif(response.status == 429){\n\t\t\twait = response.retryAfter;\n\t\t}\n\t\telse if(response.backoff){\n\t\t\twait = response.backoff;\n\t\t}\n\t}\n\treturn wait;\n};\n\nNet.prototype.ajaxRequest = function(requestConfig){\n\tZ.debug('Zotero.Net.ajaxRequest', 3);\n\tvar net = this;\n\tvar defaultConfig = {\n\t\ttype:'GET',\n\t\theaders:{\n\t\t\t'Zotero-API-Version': Zotero.config.apiVersion,\n\t\t\t'Content-Type': 'application/json'\n\t\t},\n\t\tsuccess: function(response){\n\t\t\treturn response;\n\t\t},\n\t\terror: function(response){\n\t\t\tZ.error('ajaxRequest rejected:' + response.jqxhr.status + ' - ' + response.jqxhr.responseText);\n\t\t\treturn response;\n\t\t}\n\t\t//cache:false\n\t};\n\tvar headers = Z.extend({}, defaultConfig.headers, requestConfig.headers);\n\tvar config = Z.extend({}, defaultConfig, requestConfig);\n\tconfig.headers = headers;\n\tif(typeof config.url == 'object'){\n\t\tconfig.url = Zotero.ajax.apiRequestString(config.url);\n\t}\n\tconfig.url = Zotero.ajax.proxyWrapper(config.url, config.type);\n\t\n\tif(!config.url){\n\t\tthrow 'No url specified in Zotero.Net.ajaxRequest';\n\t}\n\t//rename success/error callbacks so J.ajax does not actually use them\n\t//and we can use them as es6 promise result functions with expected\n\t//single value arguments\n\tconfig.zsuccess = config.success;\n\tconfig.zerror = config.error;\n\tdelete config.success;\n\tdelete config.error;\n\t\n\tZ.debug('AJAX config');\n\tZ.debug(config);\n\tvar ajaxpromise = new Promise(function(resolve, reject){\n\t\tnet.ajax(config)\n\t\t.then(function(request){\n\t\t\tvar data;\n\n\t\t\tif(request.responseType == 'json'\n\t\t\t\t|| (request.responseType === '' && request.getResponseHeader('content-type') === 'application/json')\n\t\t\t) {\n\t\t\t\ttry{\n\t\t\t\t\t\tdata = JSON.parse(request.response);\n\t\t\t\t\t} catch(err) {\n\t\t\t\t\t\tdata = request.response;\n\t\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tdata = request.response;\n\t\t\t}\n\t\t\t\n\t\t\tvar r = new Zotero.ApiResponse({\n\t\t\t\tjqxhr: request,\n\t\t\t\tdata: data,\n\t\t\t\ttextStatus: request.responseText\n\t\t\t});\n\t\t\tresolve(r);\n\t\t}, function(request){\n\t\t\tvar r = new Zotero.ApiResponse({\n\t\t\t\tjqxhr: request,\n\t\t\t\ttextStatus: request.responseText,\n\t\t\t\tisError: true\n\t\t\t});\n\t\t\treject(r);\n\t\t});\n\t})\n\t.then(net.individualRequestDone.bind(net))\n\t.then(function(response){\n\t\t//now that we're done handling, reject\n\t\tif(response.isError){\n\t\t\tZ.error('re-throwing ApiResponse that was a rejection');\n\t\t\tthrow response;\n\t\t}\n\t\treturn response;\n\t})\n\t.then(config.zsuccess, config.zerror);\n\t\n\treturn ajaxpromise;\n};\n\nNet.prototype.ajax = function(config){\n\tconfig = Zotero.extend({type:'GET'}, config);\n\tvar promise = new Promise(function(resolve, reject){\n\t\tvar req = new XMLHttpRequest();\n\t\tvar uri = config.url;\n\t\treq.open(config.type, uri);\n\t\t\n\t\tif(config.headers){\n\t\t\tObject.keys(config.headers).forEach(function(key){\n\t\t\t\tvar val = config.headers[key];\n\t\t\t\treq.setRequestHeader(key, val);\n\t\t\t});\n\t\t}\n\n\t\treq.send(config.data);\n\n\t\treq.onload = function(){\n\t\t\tZ.debug('XMLHttpRequest done');\n\t\t\tZ.debug(req);\n\t\t\tif (req.status >= 200 && req.status < 300) {\n\t\t\t\tZ.debug('200-300 response: resolving Net.ajax promise');\n\t\t\t\t// Performs the function \"resolve\" when this.status is equal to 2xx\n\t\t\t\tresolve(req);\n\t\t\t} else {\n\t\t\t\tZ.debug('not 200-300 response: rejecting Net.ajax promise');\n\t\t\t\t// Performs the function \"reject\" when this.status is different than 2xx\n\t\t\t\treject(req);\n\t\t\t}\n\t\t};\n\t\treq.onerror = function() {\n\t\t\treject(req);\n\t\t};\n\t});\n\n\treturn promise;\n};\n\nmodule.exports = new Net();\n","'use strict';\n\nmodule.exports = function(store, idString) {\n\tthis.store = store;\n\tthis.idString = idString;\n\tthis.preferencesObject = {};\n\tthis.defaults = {\n\t\tdebug_level: 3, //lower level is higher priority\n\t\tdebug_log: true,\n\t\tdebug_mock: false,\n\t\tlistDisplayedFields: ['title', 'creator', 'dateModified'],\n\t\tshowAutomaticTags: false,//tagType:1 is automatic, tagType:0 was added by user\n\t\titemsPerPage: 25,\n\t\torder: 'title',\n\t\ttitle: 'asc'\n\t};\n\tthis.load();\n};\n\nmodule.exports.prototype.setPref = function(key, value) {\n\tvar preferences = this;\n\tpreferences.preferencesObject[key] = value;\n\tpreferences.persist();\n};\n\nmodule.exports.prototype.setPrefs = function(newPrefs) {\n\tvar preferences = this;\n\tif(typeof(newPrefs) != 'object') {\n\t\tthrow new Error('Preferences must be an object');\n\t}\n\tpreferences.preferencesObject = newPrefs;\n\tpreferences.persist();\n};\n\nmodule.exports.prototype.getPref = function(key){\n\tvar preferences = this;\n\tif(preferences.preferencesObject[key]){\n\t\treturn preferences.preferencesObject[key];\n\t}\n\telse if(preferences.defaults[key]){\n\t\treturn preferences.defaults[key];\n\t}\n\telse {\n\t\treturn null;\n\t}\n};\n\nmodule.exports.prototype.getPrefs = function(){\n\tvar preferences = this;\n\treturn preferences.preferencesObject;\n};\n\nmodule.exports.prototype.persist = function(){\n\tvar preferences = this;\n\tvar storageString = 'preferences_' + preferences.idString;\n\tpreferences.store[storageString] = JSON.stringify(preferences.preferencesObject);\n};\n\nmodule.exports.prototype.load = function(){\n\tvar preferences = this;\n\tvar storageString = 'preferences_' + preferences.idString;\n\tvar storageObjectString = preferences.store[storageString];\n\tif(!storageObjectString){\n\t\tpreferences.preferencesObject = {};\n\t}\n\telse {\n\t\tpreferences.preferencesObject = JSON.parse(storageObjectString);\n\t}\n};\n","'use strict';\n\nmodule.exports = function(){\n\tthis.instance = 'Zotero.Search';\n\tthis.searchObject = {};\n};\n","'use strict';\n\nmodule.exports = function(){\n\tthis.instance = 'Zotero.Searches';\n\tthis.searchObjects = {};\n\tthis.syncState = {\n\t\tearliestVersion: null,\n\t\tlatestVersion: null\n\t};\n};\n","'use strict';\n\nmodule.exports = function (tagObj) {\n\tthis.instance = 'Zotero.Tag';\n\tthis.color = null;\n\tthis.version = 0;\n\tif( typeof tagObj == 'object'){\n\t\tthis.parseJsonTag(tagObj);\n\t} else if(typeof tagObj == 'string') {\n\t\tthis.parseJsonTag(this.templateApiObj(tagObj));\n\t} else {\n\t\tthis.parseJsonTag(this.tamplateApiObj(''));\n\t}\n};\n\nmodule.exports.prototype = new Zotero.ApiObject();\n\nmodule.exports.prototype.parseJsonTag = function(tagObj) {\n\tvar tag = this;\n\ttag.apiObj = Z.extend({}, tagObj);\n\ttag.urlencodedtag = encodeURIComponent(tag.apiObj.tag);\n\ttag.version = tag.apiObj.version;\n};\n\nmodule.exports.prototype.templateApiObj = function(tagString) {\n\treturn {\n\t\ttag: tagString,\n\t\tlinks: {},\n\t\tmeta: {\n\t\t\ttype:0,\n\t\t\tnumItems:1\n\t\t}\n\t};\n};\n\nmodule.exports.prototype.tagComparer = function(){\n\tif(Intl){\n\t\tvar collator = new Intl.Collator();\n\t\treturn function(a, b){\n\t\t\treturn collator.compare(a.apiObj.tag, b.apiObj.tag);\n\t\t};\n\t} else {\n\t\treturn function(a, b) {\n\t\t\tif(a.apiObj.tag.toLocaleLowerCase() == b.apiObj.tag.toLocaleLowerCase()){\n\t\t\t\treturn 0;\n\t\t\t}\n\t\t\tif(a.apiObj.tag.toLocaleLowerCase() < b.apiObj.tag.toLocaleLowerCase()){\n\t\t\t\treturn -1;\n\t\t\t}\n\t\t\treturn 1;\n\t\t};\n\t}\n};\n\nmodule.exports.prototype.set = function(key, val){\n\tvar tag = this;\n\t\n\tif(key in tag.apiObj){\n\t\ttag.apiObj[key] = val;\n\t}\n\tif(key in tag.apiObj.meta){\n\t\ttag.apiObj.meta[key] = val;\n\t}\n\t\n\tswitch (key) {\n\t\tcase 'tagVersion':\n\t\tcase 'version':\n\t\t\ttag.version = val;\n\t\t\ttag.apiObj.version = val;\n\t\t\tbreak;\n\t}\n\t\n\treturn tag;\n};\n\n","'use strict';\n\nmodule.exports = function(jsonBody){\n\tthis.instance = 'Zotero.Tags';\n\t//represent collections as array for ordering purposes\n\tthis.tagsVersion = 0;\n\tthis.syncState = {\n\t\tearliestVersion: null,\n\t\tlatestVersion: null\n\t};\n\tthis.displayTagsArray = [];\n\tthis.displayTagsUrl = '';\n\tthis.tagObjects = {};\n\tthis.tagsArray = [];\n\tthis.loaded = false;\n\tif(jsonBody){\n\t\tthis.addTagsFromJson(jsonBody);\n\t}\n};\n\nmodule.exports.prototype = new Zotero.Container();\n\nmodule.exports.prototype.addTag = function(tag){\n\tvar tags = this;\n\ttags.tagObjects[tag.apiObj.tag] = tag;\n\ttags.tagsArray.push(tag);\n\tif(tags.owningLibrary){\n\t\ttag.associateWithLibrary(tags.owningLibrary);\n\t}\n};\n\nmodule.exports.prototype.getTag = function(tagname){\n\tvar tags = this;\n\tif(tags.tagObjects.hasOwnProperty(tagname)){\n\t\treturn this.tagObjects[tagname];\n\t}\n\treturn null;\n};\n\nmodule.exports.prototype.removeTag = function(tagname){\n\tvar tags = this;\n\tdelete tags.tagObjects[tagname];\n\ttags.updateSecondaryData();\n};\n\nmodule.exports.prototype.removeTags = function(tagnames){\n\tvar tags = this;\n\ttagnames.forEach(function(tagname){\n\t\tdelete tags.tagObjects[tagname];\n\t});\n\ttags.updateSecondaryData();\n};\n\nmodule.exports.prototype.plainTagsList = function(tagsArray){\n\tZ.debug('Zotero.Tags.plainTagsList', 3);\n\tvar plainList = [];\n\ttagsArray.forEach(function(tag){\n\t\tplainList.push(tag.apiObj.tag);\n\t});\n\treturn plainList;\n};\n\nmodule.exports.prototype.clear = function(){\n\tZ.debug('Zotero.Tags.clear', 3);\n\tthis.tagsVersion = 0;\n\tthis.syncState.earliestVersion = null;\n\tthis.syncState.latestVersion = null;\n\tthis.displayTagsArray = [];\n\tthis.displayTagsUrl = '';\n\tthis.tagObjects = {};\n\tthis.tagsArray = [];\n};\n\nmodule.exports.prototype.updateSecondaryData = function(){\n\tZ.debug('Zotero.Tags.updateSecondaryData', 3);\n\tvar tags = this;\n\ttags.tagsArray = [];\n\tObject.keys(tags.tagObjects).forEach(function(key){\n\t\tvar val = tags.tagObjects[key];\n\t\ttags.tagsArray.push(val);\n\t});\n\ttags.tagsArray.sort(Zotero.Tag.prototype.tagComparer());\n\tvar plainList = tags.plainTagsList(tags.tagsArray);\n\tplainList.sort(Zotero.Library.prototype.comparer());\n\ttags.plainList = plainList;\n};\n\nmodule.exports.prototype.updateTagsVersion = function(tagsVersion) {\n\tvar tags = this;\n\tObject.keys(tags.tagObjects).forEach(function(key){\n\t\tvar tag = tags.tagObjects[key];\n\t\ttag.set('version', tagsVersion);\n\t});\n};\n\nmodule.exports.prototype.rebuildTagsArray = function() {\n\tvar tags = this;\n\ttags.tagsArray = [];\n\tObject.keys(tags.tagObjects).forEach(function(key){\n\t\tvar tag = tags.tagObjects[key];\n\t\ttags.tagsArray.push(tag);\n\t});\n};\n\nmodule.exports.prototype.addTagsFromJson = function(jsonBody){\n\tZ.debug('Zotero.Tags.addTagsFromJson', 3);\n\tvar tags = this;\n\tvar tagsAdded = [];\n\tjsonBody.forEach(function(tagObj){\n\t\tvar tag = new Zotero.Tag(tagObj);\n\t\ttags.addTag(tag);\n\t\ttagsAdded.push(tag);\n\t});\n\treturn tagsAdded;\n};\n","'use strict';\n\n// Url.js - construct certain urls and links locally that may depend on the\n// current website's routing scheme etc. Not necessarily pointing to zotero.org\n// - href for a particular item's local representation\n// - link with appropriate text, to download file or view framed snapshot\n// - href for file download/view, depending on whether config says to download\n// directly from the api, or to proxy it\n// - displayable string describing the attachment file (attachmentFileDetails)\n// - list of urls for supported export formats\n// \n\nvar Url = {};\n\n//locally construct a url for the item on the current website\nUrl.itemHref = function(item){\n\tvar href = '';\n\thref += Zotero.config.librarySettings.libraryPathString + '/itemKey/' + item.get('key');\n\treturn href;\n};\n\n//construct a download link for an item's enclosure file that takes into\n//account size and whether the file is a snapshot\nUrl.attachmentDownloadLink = function(item){\n\tvar retString = '';\n\tvar downloadUrl = item.attachmentDownloadUrl;\n\tvar contentType = item.get('contentType');\n\t\n\tif(item.apiObj.links && item.apiObj.links['enclosure']){\n\t\tif(!item.apiObj.links['enclosure']['length'] && item.isSnapshot()){\n\t\t\t//snapshot: redirect to view\n\t\t\tretString += '<a href=\"' + downloadUrl + '\">' + 'View Snapshot</a>';\n\t\t}\n\t\telse{\n\t\t\t//file: offer download\n\t\t\tvar enctype = Zotero.utils.translateMimeType(item.apiObj.links['enclosure'].type);\n\t\t\tvar enc = item.apiObj.links['enclosure'];\n\t\t\tvar filesize = parseInt(enc['length'], 10);\n\t\t\tvar filesizeString = '' + filesize + ' B';\n\t\t\tif(filesize > 1073741824){\n\t\t\t\tfilesizeString = '' + (filesize / 1073741824).toFixed(1) + ' GB';\n\t\t\t}\n\t\t\telse if(filesize > 1048576){\n\t\t\t\tfilesizeString = '' + (filesize / 1048576).toFixed(1) + ' MB';\n\t\t\t}\n\t\t\telse if(filesize > 1024){\n\t\t\t\tfilesizeString = '' + (filesize / 1024).toFixed(1) + ' KB';\n\t\t\t}\n\t\t\tZ.debug(enctype, 3);\n\t\t\tretString += '<a href=\"' + downloadUrl + '\">';\n\t\t\tif(enctype == 'undefined' || enctype === '' || typeof enctype == 'undefined'){\n\t\t\t\tretString += filesizeString + '</a>';\n\t\t\t}\n\t\t\telse{\n\t\t\t\tretString += enctype + ', ' + filesizeString + '</a>';\n\t\t\t}\n\t\t\treturn retString;\n\t\t}\n\t}\n\treturn retString;\n};\n\nUrl.attachmentDownloadUrl = function(item){\n\tif(item.apiObj.links && item.apiObj.links['enclosure']){\n\t\tif(Zotero.config.proxyDownloads){\n\t\t\t//we have a proxy for downloads at baseDownloadUrl so just pass an itemkey to that\n\t\t\treturn Url.wwwDownloadUrl(item);\n\t\t}\n\t\telse {\n\t\t\treturn Url.apiDownloadUrl(item);\n\t\t}\n\t}\n\treturn false;\n};\n\nUrl.apiDownloadUrl = function(item){\n\tif(item.apiObj.links['enclosure']){\n\t\treturn item.apiObj.links['enclosure']['href'];\n\t}\n\treturn false;\n};\n\nUrl.proxyDownloadUrl = function(item){\n\tif(item.apiObj.links['enclosure']){\n\t\tif(Zotero.config.proxyDownloads){\n\t\t\treturn Zotero.config.baseDownloadUrl + '?itemkey=' + item.get('key');\n\t\t}\n\t\telse{\n\t\t\treturn Url.apiDownloadUrl(item);\n\t\t}\n\t}\n\telse {\n\t\treturn false;\n\t}\n};\n\nUrl.wwwDownloadUrl = function(item){\n\tif(item.apiObj.links['enclosure']){\n\t\treturn Zotero.config.baseZoteroWebsiteUrl + Zotero.config.librarySettings.libraryPathString + '/' + item.get('key') + '/file/view';\n\t}\n\telse {\n\t\treturn false;\n\t}\n};\n\nUrl.publicationsDownloadUrl = function(item){\n\tif(item.apiObj.links['enclosure']){\n\t\treturn item.apiObj.links['enclosure']['href'];\n\t}\n\treturn false;\n};\n\nUrl.attachmentFileDetails = function(item){\n\t//file: offer download\n\tif(!item.apiObj.links['enclosure']) return '';\n\tvar enctype = Zotero.utils.translateMimeType(item.apiObj.links['enclosure'].type);\n\tvar enc = item.apiObj.links['enclosure'];\n\tvar filesizeString = '';\n\tif(enc['length']){\n\t\tvar filesize = parseInt(enc['length'], 10);\n\t\tfilesizeString = '' + filesize + ' B';\n\t\tif(filesize > 1073741824){\n\t\t\tfilesizeString = '' + (filesize / 1073741824).toFixed(1) + ' GB';\n\t\t}\n\t\telse if(filesize > 1048576){\n\t\t\tfilesizeString = '' + (filesize / 1048576).toFixed(1) + ' MB';\n\t\t}\n\t\telse if(filesize > 1024){\n\t\t\tfilesizeString = '' + (filesize / 1024).toFixed(1) + ' KB';\n\t\t}\n\t\treturn '(' + enctype + ', ' + filesizeString + ')';\n\t}\n\telse {\n\t\treturn '(' + enctype + ')';\n\t}\n};\n\nUrl.userWebLibrary = function(slug) {\n\treturn [Zotero.config.baseWebsiteUrl, slug, 'items'].join('/');\n};\n\nUrl.groupWebLibrary = function(group) {\n\tif(group.type == 'Private'){\n\t\treturn [Zotero.config.baseWebsiteUrl, 'groups', group.get('id'), 'items'].join('/');\n\t}\n\telse {\n\t\treturn [Zotero.config.baseWebsiteUrl, 'groups', Zotero.utils.slugify(group.get('name')), 'items'].join('/');\n\t}\n};\n\nUrl.exportUrls = function(config){\n\tZ.debug('Zotero.url.exportUrls', 3);\n\tvar exportUrls = {};\n\tvar exportConfig = {};\n\tZotero.config.exportFormats.forEach(function(format){\n\t\texportConfig = Z.extend(config, {'format':format});\n\t\texportUrls[format] = Zotero.ajax.apiRequestUrl(exportConfig) + Zotero.ajax.apiQueryString({format:format, limit:'25'});\n\t});\n\treturn exportUrls;\n};\n\nUrl.relationUrl = function(libraryType, libraryID, itemKey){\n\treturn 'http://zotero.org/' + libraryType + 's/' + libraryID + '/items/' + itemKey;\n};\n\nmodule.exports = Url;","'use strict';\n\nmodule.exports = function () {this.instance = 'Zotero.User';};\nmodule.exports.prototype = new Zotero.ApiObject();\nmodule.exports.prototype.loadObject = function(ob){\n\tthis.title = ob.title;\n\tthis.author = ob.author;\n\tthis.tagID = ob.tagID;\n\tthis.published = ob.published;\n\tthis.updated = ob.updated;\n\tthis.links = ob.links;\n\tthis.numItems = ob.numItems;\n\tthis.items = ob.items;\n\tthis.tagType = ob.tagType;\n\tthis.modified = ob.modified;\n\tthis.added = ob.added;\n\tthis.key = ob.key;\n};\n\nmodule.exports.prototype.parseXmlUser = function (tel) {\n\tthis.parseXmlEntry(tel);\n\t\n\tvar tagEl = tel.find('content>tag');\n\tif(tagEl.length !== 0){\n\t\tthis.tagKey = tagEl.attr('key');// find(\"zapi\\\\:itemID\").text();\n\t\tthis.libraryID = tagEl.attr('libraryID');\n\t\tthis.tagName = tagEl.attr('name');\n\t\tthis.dateAdded = tagEl.attr('dateAdded');\n\t\tthis.dateModified = tagEl.attr('dateModified');\n\t}\n\t\n};\n","'use strict';\n\nvar Utils = {\n\trandomString:function(len, chars) {\n\t\tif (!chars) {\n\t\t\tchars = '0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz';\n\t\t}\n\t\tif (!len) {\n\t\t\tlen = 8;\n\t\t}\n\t\tvar randomstring = '';\n\t\tfor (var i=0; i<len; i++) {\n\t\t\tvar rnum = Math.floor(Math.random() * chars.length);\n\t\t\trandomstring += chars.substring(rnum,rnum+1);\n\t\t}\n\t\treturn randomstring;\n\t},\n\t\n\tgetKey: function() {\n\t\tvar baseString = '23456789ABCDEFGHIJKMNPQRSTUVWXZ';\n\t\treturn Utils.randomString(8, baseString);\n\t},\n\t\n\tslugify: function(name){\n\t\tvar slug = name.trim();\n\t\tslug = slug.toLowerCase();\n\t\tslug = slug.replace( /[^a-z0-9 ._-]/g , '');\n\t\tslug = slug.replace(/\\s/g, '_');\n\t\t\n\t\treturn slug;\n\t},\n\t\n\tprependAutocomplete: function(pre, source){\n\t\tZ.debug('Zotero.utils.prependAutocomplete', 3);\n\t\tZ.debug('prepend match: ' + pre);\n\t\tvar satisfy;\n\t\tif(!source){\n\t\t\tZ.debug('source is not defined');\n\t\t}\n\t\tif(pre === ''){\n\t\t\tsatisfy = source.slice(0);\n\t\t\treturn satisfy;\n\t\t}\n\t\tvar plen = pre.length;\n\t\tvar plower = pre.toLowerCase();\n\t\tsatisfy = source.map(function(n){\n\t\t\tif(n.substr(0, plen).toLowerCase() == plower){\n\t\t\t\treturn n;\n\t\t\t}\n\t\t\telse{\n\t\t\t\treturn null;\n\t\t\t}\n\t\t});\n\t\treturn satisfy;\n\t},\n\t\n\tmatchAnyAutocomplete: function(pre, source){\n\t\tZ.debug('Zotero.utils.matchAnyAutocomplete', 3);\n\t\tZ.debug('matchAny match: ' + pre);\n\t\tvar satisfy;\n\t\tif(!source){\n\t\t\tZ.debug('source is not defined');\n\t\t}\n\t\tif(pre === ''){\n\t\t\tsatisfy = source.slice(0);\n\t\t\treturn satisfy;\n\t\t}\n\t\tvar plen = pre.length;\n\t\tvar plower = pre.toLowerCase();\n\t\tsatisfy = source.map(function(n){\n\t\t\tif(n.toLowerCase().indexOf(plower) != -1){\n\t\t\t\treturn n;\n\t\t\t}\n\t\t\telse{\n\t\t\t\treturn null;\n\t\t\t}\n\t\t});\n\t\treturn satisfy;\n\t},\n\t\n\tlibraryString: function(type, libraryID){\n\t\tvar lstring = '';\n\t\tif(type == 'user') lstring = 'u';\n\t\telse if(type == 'group') lstring = 'g';\n\t\tlstring += libraryID;\n\t\treturn lstring;\n\t},\n\t\n\tparseLibString: function(libraryString){\n\t\tvar type;\n\t\tvar libraryID;\n\t\tif(libraryString.charAt(0) == 'u'){\n\t\t\ttype = 'user';\n\t\t}\n\t\telse if(libraryString.charAt(0) == 'g'){\n\t\t\ttype = 'group';\n\t\t}\n\t\telse{\n\t\t\tthrow new Error('unexpected type character in libraryString');\n\t\t}\n\t\tlibraryID = parseInt(libraryString.substring(1));\n\t\treturn {libraryType:type, libraryID: libraryID};\n\t},\n\t\n\t//return true if retrieved more than lifetime minutes ago\n\tstale: function(retrievedDate, lifetime){\n\t\tvar now = Date.now(); //current local time\n\t\tvar elapsed = now.getTime() - retrievedDate.getTime();\n\t\tif((elapsed / 60000) > lifetime){\n\t\t\treturn true;\n\t\t}\n\t\treturn false;\n\t},\n\t\n\tentityify: function(str){\n\t\tvar character = {\n\t\t\t'<' : '&lt;',\n\t\t\t'>' : '&gt;',\n\t\t\t'&' : '&amp;',\n\t\t\t'\"' : '&quot;'\n\t\t};\n\t\treturn str.replace(/[<>&\"]/g, function(c) {\n\t\t\treturn character[c];\n\t\t});\n\t},\n\t\n\tparseApiDate: function(datestr, date){\n\t\t//var parsems = Date.parse(datestr);\n\t\t\n\t\tvar re = /([0-9]+)-([0-9]+)-([0-9]+)T([0-9]+):([0-9]+):([0-9]+)Z/;\n\t\tvar matches = re.exec(datestr);\n\t\tif(matches === null){\n\t\t\tZ.error('error parsing api date: ' + datestr);\n\t\t\treturn null;\n\t\t}\n\t\telse{\n\t\t\tdate = new Date(Date.UTC(matches[1], matches[2]-1, matches[3], matches[4], matches[5], matches[6]));\n\t\t\treturn date;\n\t\t}\n\t\t\n\t\treturn date;\n\t},\n\t\n\treadCookie: function(name) {\n\t\tvar nameEQ = name + '=';\n\t\tvar ca = document.cookie.split(';');\n\t\tfor(var i=0;i < ca.length;i++) {\n\t\t\tvar c = ca[i];\n\t\t\twhile (c.charAt(0)==' ') c = c.substring(1,c.length);\n\t\t\tif (c.indexOf(nameEQ) === 0) return c.substring(nameEQ.length,c.length);\n\t\t}\n\t\treturn null;\n\t},\n\t\n\t/**\n\t * Translate common mimetypes to user friendly versions\n\t *\n\t * @param string $mimeType\n\t * @return string\n\t */\n\ttranslateMimeType: function(mimeType)\n\t{\n\t\tswitch (mimeType) {\n\t\t\tcase 'text/html':\n\t\t\t\treturn 'html';\n\t\t\t\n\t\t\tcase 'application/pdf':\n\t\t\tcase 'application/x-pdf':\n\t\t\tcase 'application/acrobat':\n\t\t\tcase 'applications/vnd.pdf':\n\t\t\tcase 'text/pdf':\n\t\t\tcase 'text/x-pdf':\n\t\t\t\treturn 'pdf';\n\t\t\t\n\t\t\tcase 'image/jpg':\n\t\t\tcase 'image/jpeg':\n\t\t\t\treturn 'jpg';\n\t\t\t\n\t\t\tcase 'image/gif':\n\t\t\t\treturn 'gif';\n\t\t\t\n\t\t\tcase 'application/msword':\n\t\t\tcase 'application/doc':\n\t\t\tcase 'application/vnd.msword':\n\t\t\tcase 'application/vnd.ms-word':\n\t\t\tcase 'application/winword':\n\t\t\tcase 'application/word':\n\t\t\tcase 'application/x-msw6':\n\t\t\tcase 'application/x-msword':\n\t\t\t\treturn 'doc';\n\t\t\t\n\t\t\tcase 'application/vnd.oasis.opendocument.text':\n\t\t\tcase 'application/x-vnd.oasis.opendocument.text':\n\t\t\t\treturn 'odt';\n\t\t\t\n\t\t\tcase 'video/flv':\n\t\t\tcase 'video/x-flv':\n\t\t\t\treturn 'flv';\n\t\t\t\n\t\t\tcase 'image/tif':\n\t\t\tcase 'image/tiff':\n\t\t\tcase 'image/x-tif':\n\t\t\tcase 'image/x-tiff':\n\t\t\tcase 'application/tif':\n\t\t\tcase 'application/x-tif':\n\t\t\tcase 'application/tiff':\n\t\t\tcase 'application/x-tiff':\n\t\t\t\treturn 'tiff';\n\t\t\t\n\t\t\tcase 'application/zip':\n\t\t\tcase 'application/x-zip':\n\t\t\tcase 'application/x-zip-compressed':\n\t\t\tcase 'application/x-compress':\n\t\t\tcase 'application/x-compressed':\n\t\t\tcase 'multipart/x-zip':\n\t\t\t\treturn 'zip';\n\t\t\t\t\n\t\t\tcase 'video/quicktime':\n\t\t\tcase 'video/x-quicktime':\n\t\t\t\treturn 'mov';\n\t\t\t\t\n\t\t\tcase 'video/avi':\n\t\t\tcase 'video/msvideo':\n\t\t\tcase 'video/x-msvideo':\n\t\t\t\treturn 'avi';\n\t\t\t\t\n\t\t\tcase 'audio/wav':\n\t\t\tcase 'audio/x-wav':\n\t\t\tcase 'audio/wave':\n\t\t\t\treturn 'wav';\n\t\t\t\t\n\t\t\tcase 'audio/aiff':\n\t\t\tcase 'audio/x-aiff':\n\t\t\tcase 'sound/aiff':\n\t\t\t\treturn 'aiff';\n\t\t\t\n\t\t\tcase 'text/plain':\n\t\t\t\treturn 'plain text';\n\t\t\tcase 'application/rtf':\n\t\t\t\treturn 'rtf';\n\t\t\t\t\n\t\t\tdefault:\n\t\t\t\treturn mimeType;\n\t\t}\n\t},\n\n\t/**\n\t * Get the permissions a key has for a library\n\t * if no key is passed use the currently set key for the library\n\t *\n\t * @param int|string $userID\n\t * @param string $key\n\t * @return array $keyPermissions\n\t */\n\tgetKeyPermissions: function(userID, key) {\n\t\tif(!userID){\n\t\t\treturn false;\n\t\t}\n\t\t\n\t\tif(!key){\n\t\t\treturn false;\n\t\t}\n\t\t\n\t\tvar urlconfig = {'target':'key', 'libraryType':'user', 'libraryID':userID, 'apiKey':key};\n\t\tvar requestUrl = Zotero.ajax.apiRequestString(urlconfig);\n\t\t\n\t\treturn Zotero.ajaxRequest(requestUrl)\n\t\t.then(function(response){\n\t\t\tvar keyObject = JSON.parse(response.data);\n\t\t\treturn keyObject;\n\t\t});\n\t},\n\n\tparseQuery: function(query) {\n\t\tvar params = {};\n\t\tvar match;\n\t\tvar pl = /\\+/g;  // Regex for replacing addition symbol with a space\n\t\tvar search = /([^&=]+)=?([^&]*)/g;\n\t\tvar decode = function (s) {\n\t\t\treturn decodeURIComponent(s.replace(pl, ' '));\n\t\t};\n\n\t\twhile(match = search.exec(query)) {\n\t\t\tparams[decode(match[1])] = decode(match[2]);\n\t\t}\n\t\treturn params;\n\t},\n\n\tquerystring: function(href) {\n\t\tvar hashindex = (href.indexOf('#') != -1) ? href.indexOf('#') : undefined;\n\t\tvar q = href.substring(href.indexOf('?') + 1, hashindex);\n\t\treturn q;\n\t}\n};\n\nmodule.exports = Utils;"]}